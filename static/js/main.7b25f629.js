/*! For license information please see main.7b25f629.js.LICENSE.txt */
(()=>{var e={526:(e,t,r)=>{"use strict";var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},4210:e=>{var t=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}()},4463:(e,t,r)=>{"use strict";var n=r(2791),a=r(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,r,n,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,r,n){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,a,n)&&(r=null),n||null===a?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,n=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var T=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),A=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),x=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var D,F=Object.assign;function U(e){if(void 0===D)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var H=!1;function B(e,t){if(!e||H)return"";H=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&"string"===typeof l.stack){for(var a=l.stack.split("\n"),i=n.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var c="\n"+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=o&&0<=s);break}}}finally{H=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?U(e):""}function j(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case _:return"Portal";case k:return"Profiler";case C:return"StrictMode";case R:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return z(e(t))}catch(r){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function K(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=G(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var r=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Q(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=K(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){J(e,t);var r=K(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,K(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&Y(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+K(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(i(92));if(te(r)){if(1<r.length)throw Error(i(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:K(r)}}function ie(e,t){var r=K(t.value),n=K(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),a=ge(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Te=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Ee=null,Ce=null;function ke(e){if(e=ba(e)){if("function"!==typeof _e)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),_e(e.stateNode,e.type,t))}}function Se(e){Ee?Ce?Ce.push(e):Ce=[e]:Ee=e}function Ae(){if(Ee){var e=Ee,t=Ce;if(Ce=Ee=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ie(e,t){return e(t)}function Re(){}var Oe=!1;function Ne(e,t,r){if(Oe)return e(t,r);Oe=!0;try{return Ie(e,t,r)}finally{Oe=!1,(null!==Ee||null!==Ce)&&(Re(),Ae())}}function xe(e,t){var r=e.stateNode;if(null===r)return null;var n=wa(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var Pe=!1;if(u)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(ue){Pe=!1}function Le(e,t,r,n,a,i,o,s,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var De=!1,Fe=null,Ue=!1,He=null,Be={onError:function(e){De=!0,Fe=e}};function je(e,t,r,n,a,i,o,s,c){De=!1,Fe=null,Le.apply(Be,arguments)}function ze(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ke(e){if(ze(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(n=a.return)){r=n;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===r)return Ke(a),e;if(o===n)return Ke(a),t;o=o.sibling}throw Error(i(188))}if(r.return!==n.return)r=a,n=o;else{for(var s=!1,c=a.child;c;){if(c===r){s=!0,r=a,n=o;break}if(c===n){s=!0,n=a,r=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===r){s=!0,r=o,n=a;break}if(c===n){s=!0,n=o,r=a;break}c=c.sibling}if(!s)throw Error(i(189))}}if(r.alternate!==n)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var We=a.unstable_scheduleCallback,Ye=a.unstable_cancelCallback,$e=a.unstable_shouldYield,Qe=a.unstable_requestPaint,Je=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,rt=a.unstable_LowPriority,nt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ct|0)|0},st=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&r;if(0!==o){var s=o&~a;0!==s?n=ht(s):0!==(i&=o)&&(n=ht(i))}else 0!==(o=r&~a)?n=ht(o):0!==i&&(n=ht(i));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(r=31-ot(t)),n|=e[r],t&=~a;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function vt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=r}function yt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ot(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var bt=0;function Tt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,Et,Ct,kt,St=!1,At=[],It=null,Rt=null,Ot=null,Nt=new Map,xt=new Map,Pt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":Nt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xt.delete(t.pointerId)}}function Dt(e,t,r,n,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&_t(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ft(e){var t=ya(e.target);if(null!==t){var r=ze(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=qe(r)))return e.blockedOn=t,void kt(e.priority,(function(){Et(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=ba(r))&&_t(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);Te=n,r.target.dispatchEvent(n),Te=null,t.shift()}return!0}function Ht(e,t,r){Ut(e)&&r.delete(t)}function Bt(){St=!1,null!==It&&Ut(It)&&(It=null),null!==Rt&&Ut(Rt)&&(Rt=null),null!==Ot&&Ut(Ot)&&(Ot=null),Nt.forEach(Ht),xt.forEach(Ht)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Bt)))}function zt(e){function t(t){return jt(t,e)}if(0<At.length){jt(At[0],e);for(var r=1;r<At.length;r++){var n=At[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==It&&jt(It,e),null!==Rt&&jt(Rt,e),null!==Ot&&jt(Ot,e),Nt.forEach(t),xt.forEach(t),r=0;r<Pt.length;r++)(n=Pt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Pt.length&&null===(r=Pt[0]).blockedOn;)Ft(r),null===r.blockedOn&&Pt.shift()}var qt=T.ReactCurrentBatchConfig,Kt=!0;function Gt(e,t,r,n){var a=bt,i=qt.transition;qt.transition=null;try{bt=1,Wt(e,t,r,n)}finally{bt=a,qt.transition=i}}function Vt(e,t,r,n){var a=bt,i=qt.transition;qt.transition=null;try{bt=4,Wt(e,t,r,n)}finally{bt=a,qt.transition=i}}function Wt(e,t,r,n){if(Kt){var a=$t(e,t,r,n);if(null===a)Kn(e,t,n,Yt,r),Lt(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return It=Dt(It,e,t,r,n,a),!0;case"dragenter":return Rt=Dt(Rt,e,t,r,n,a),!0;case"mouseover":return Ot=Dt(Ot,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Nt.set(i,Dt(Nt.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,xt.set(i,Dt(xt.get(i)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Lt(e,n),4&t&&-1<Mt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&wt(i),null===(i=$t(e,t,r,n))&&Kn(e,t,n,Yt,r),i===a)break;a=i}null!==a&&n.stopPropagation()}else Kn(e,t,n,null,r)}}var Yt=null;function $t(e,t,r,n){if(Yt=null,null!==(e=ya(e=we(n))))if(null===(t=ze(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Xt,n=r.length,a="value"in Jt?Jt.value:Jt.textContent,i=a.length;for(e=0;e<n&&r[e]===a[e];e++);var o=n-e;for(t=1;t<=o&&r[n-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ar(e){function t(t,r,n,a,i){for(var o in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ir,or,sr,cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lr=ar(cr),ur=F({},cr,{view:0,detail:0}),hr=ar(ur),dr=F({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(ir=e.screenX-sr.screenX,or=e.screenY-sr.screenY):or=ir=0,sr=e),ir)},movementY:function(e){return"movementY"in e?e.movementY:or}}),fr=ar(dr),pr=ar(F({},dr,{dataTransfer:0})),gr=ar(F({},ur,{relatedTarget:0})),mr=ar(F({},cr,{animationName:0,elapsedTime:0,pseudoElement:0})),vr=F({},cr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=ar(vr),br=ar(F({},cr,{data:0})),Tr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_r={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Er(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_r[e])&&!!t[e]}function Cr(){return Er}var kr=F({},ur,{key:function(e){if(e.key){var t=Tr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sr=ar(kr),Ar=ar(F({},dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ir=ar(F({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cr})),Rr=ar(F({},cr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Or=F({},dr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nr=ar(Or),xr=[9,13,27,32],Pr=u&&"CompositionEvent"in window,Mr=null;u&&"documentMode"in document&&(Mr=document.documentMode);var Lr=u&&"TextEvent"in window&&!Mr,Dr=u&&(!Pr||Mr&&8<Mr&&11>=Mr),Fr=String.fromCharCode(32),Ur=!1;function Hr(e,t){switch(e){case"keyup":return-1!==xr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Br(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jr=!1;var zr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zr[e.type]:"textarea"===t}function Kr(e,t,r,n){Se(n),0<(t=Vn(t,"onChange")).length&&(r=new lr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gr=null,Vr=null;function Wr(e){Un(e,0)}function Yr(e){if(W(Ta(e)))return e}function $r(e,t){if("change"===e)return t}var Qr=!1;if(u){var Jr;if(u){var Xr="oninput"in document;if(!Xr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Xr="function"===typeof Zr.oninput}Jr=Xr}else Jr=!1;Qr=Jr&&(!document.documentMode||9<document.documentMode)}function en(){Gr&&(Gr.detachEvent("onpropertychange",tn),Vr=Gr=null)}function tn(e){if("value"===e.propertyName&&Yr(Vr)){var t=[];Kr(t,Vr,e,we(e)),Ne(Wr,t)}}function rn(e,t,r){"focusin"===e?(en(),Vr=r,(Gr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yr(Vr)}function an(e,t){if("click"===e)return Yr(t)}function on(e,t){if("input"===e||"change"===e)return Yr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!h.call(t,a)||!sn(e[a],t[a]))return!1}return!0}function ln(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=ln(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ln(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=Y((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pn(e){var t=dn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=void 0===n.end?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=un(r,i);var o=un(r,n);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gn=u&&"documentMode"in document&&11>=document.documentMode,mn=null,vn=null,yn=null,bn=!1;function Tn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bn||null==mn||mn!==Y(n)||("selectionStart"in(n=mn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&cn(yn,n)||(yn=n,0<(n=Vn(vn,"onSelect")).length&&(t=new lr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=mn)))}function wn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var _n={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},En={},Cn={};function kn(e){if(En[e])return En[e];if(!_n[e])return e;var t,r=_n[e];for(t in r)if(r.hasOwnProperty(t)&&t in Cn)return En[e]=r[t];return e}u&&(Cn=document.createElement("div").style,"AnimationEvent"in window||(delete _n.animationend.animation,delete _n.animationiteration.animation,delete _n.animationstart.animation),"TransitionEvent"in window||delete _n.transitionend.transition);var Sn=kn("animationend"),An=kn("animationiteration"),In=kn("animationstart"),Rn=kn("transitionend"),On=new Map,Nn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xn(e,t){On.set(e,t),c(t,[e])}for(var Pn=0;Pn<Nn.length;Pn++){var Mn=Nn[Pn];xn(Mn.toLowerCase(),"on"+(Mn[0].toUpperCase()+Mn.slice(1)))}xn(Sn,"onAnimationEnd"),xn(An,"onAnimationIteration"),xn(In,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(Rn,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ln="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ln));function Fn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,a,o,s,c,l){if(je.apply(this,arguments),De){if(!De)throw Error(i(198));var u=Fe;De=!1,Fe=null,Ue||(Ue=!0,He=u)}}(n,t,void 0,e),e.currentTarget=null}function Un(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==i&&a.isPropagationStopped())break e;Fn(a,s,l),i=c}else for(o=0;o<n.length;o++){if(c=(s=n[o]).instance,l=s.currentTarget,s=s.listener,c!==i&&a.isPropagationStopped())break e;Fn(a,s,l),i=c}}}if(Ue)throw e=He,Ue=!1,He=null,e}function Hn(e,t){var r=t[ga];void 0===r&&(r=t[ga]=new Set);var n=e+"__bubble";r.has(n)||(qn(t,e,2,!1),r.add(n))}function Bn(e,t,r){var n=0;t&&(n|=4),qn(r,e,n,t)}var jn="_reactListening"+Math.random().toString(36).slice(2);function zn(e){if(!e[jn]){e[jn]=!0,o.forEach((function(t){"selectionchange"!==t&&(Dn.has(t)||Bn(t,!1,e),Bn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jn]||(t[jn]=!0,Bn("selectionchange",!1,t))}}function qn(e,t,r,n){switch(Qt(t)){case 1:var a=Gt;break;case 4:a=Vt;break;default:a=Wt}r=a.bind(null,t,r,e),a=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Kn(e,t,r,n,a){var i=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var s=n.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=n.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(c=o.tag)||6===c){n=i=o;continue e}s=s.parentNode}}n=n.return}Ne((function(){var n=i,a=we(r),o=[];e:{var s=On.get(e);if(void 0!==s){var c=lr,l=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":c=Sr;break;case"focusin":l="focus",c=gr;break;case"focusout":l="blur",c=gr;break;case"beforeblur":case"afterblur":c=gr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=pr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Ir;break;case Sn:case An:case In:c=mr;break;case Rn:c=Rr;break;case"scroll":c=hr;break;case"wheel":c=Nr;break;case"copy":case"cut":case"paste":c=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Ar}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var f,p=n;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=xe(p,d))&&u.push(Gn(p,g,f)))),h)break;p=p.return}0<u.length&&(s=new c(s,l,null,r,a),o.push({event:s,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===Te||!(l=r.relatedTarget||r.fromElement)||!ya(l)&&!l[pa])&&(c||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=n,null!==(l=(l=r.relatedTarget||r.toElement)?ya(l):null)&&(l!==(h=ze(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=n),c!==l)){if(u=fr,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ar,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==c?s:Ta(c),f=null==l?s:Ta(l),(s=new u(g,p+"leave",c,r,a)).target=h,s.relatedTarget=f,g=null,ya(a)===n&&((u=new u(d,p+"enter",l,r,a)).target=f,u.relatedTarget=h,g=u),h=g,c&&l)e:{for(d=l,p=0,f=u=c;f;f=Wn(f))p++;for(f=0,g=d;g;g=Wn(g))f++;for(;0<p-f;)u=Wn(u),p--;for(;0<f-p;)d=Wn(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Wn(u),d=Wn(d)}u=null}else u=null;null!==c&&Yn(o,s,c,u,!1),null!==l&&null!==h&&Yn(o,h,l,u,!0)}if("select"===(c=(s=n?Ta(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var m=$r;else if(qr(s))if(Qr)m=on;else{m=nn;var v=rn}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=an);switch(m&&(m=m(e,n))?Kr(o,m,r,a):(v&&v(e,s,n),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=n?Ta(n):window,e){case"focusin":(qr(v)||"true"===v.contentEditable)&&(mn=v,vn=n,yn=null);break;case"focusout":yn=vn=mn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,Tn(o,r,a);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":Tn(o,r,a)}var y;if(Pr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else jr?Hr(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Dr&&"ko"!==r.locale&&(jr||"onCompositionStart"!==b?"onCompositionEnd"===b&&jr&&(y=er()):(Xt="value"in(Jt=a)?Jt.value:Jt.textContent,jr=!0)),0<(v=Vn(n,b)).length&&(b=new br(b,e,null,r,a),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Br(r))&&(b.data=y))),(y=Lr?function(e,t){switch(e){case"compositionend":return Br(t);case"keypress":return 32!==t.which?null:(Ur=!0,Fr);case"textInput":return(e=t.data)===Fr&&Ur?null:e;default:return null}}(e,r):function(e,t){if(jr)return"compositionend"===e||!Pr&&Hr(e,t)?(e=er(),Zt=Xt=Jt=null,jr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Vn(n,"onBeforeInput")).length&&(a=new br("onBeforeInput","beforeinput",null,r,a),o.push({event:a,listeners:n}),a.data=y))}Un(o,t)}))}function Gn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Vn(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=xe(e,r))&&n.unshift(Gn(e,i,a)),null!=(i=xe(e,t))&&n.push(Gn(e,i,a))),e=e.return}return n}function Wn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yn(e,t,r,n,a){for(var i=t._reactName,o=[];null!==r&&r!==n;){var s=r,c=s.alternate,l=s.stateNode;if(null!==c&&c===n)break;5===s.tag&&null!==l&&(s=l,a?null!=(c=xe(r,i))&&o.unshift(Gn(r,c,s)):a||null!=(c=xe(r,i))&&o.push(Gn(r,c,s))),r=r.return}0!==o.length&&e.push({event:t,listeners:o})}var $n=/\r\n?/g,Qn=/\u0000|\uFFFD/g;function Jn(e){return("string"===typeof e?e:""+e).replace($n,"\n").replace(Qn,"")}function Xn(e,t,r){if(t=Jn(t),Jn(e)!==t&&r)throw Error(i(425))}function Zn(){}var ea=null,ta=null;function ra(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var na="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:na;function sa(e){setTimeout((function(){throw e}))}function ca(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===n)return e.removeChild(a),void zt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=a}while(r);zt(t)}function la(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),da="__reactFiber$"+ha,fa="__reactProps$"+ha,pa="__reactContainer$"+ha,ga="__reactEvents$"+ha,ma="__reactListeners$"+ha,va="__reactHandles$"+ha;function ya(e){var t=e[da];if(t)return t;for(var r=e.parentNode;r;){if(t=r[pa]||r[da]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=ua(e);null!==e;){if(r=e[da])return r;e=ua(e)}return t}r=(e=r).parentNode}return null}function ba(e){return!(e=e[da]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ta(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[fa]||null}var _a=[],Ea=-1;function Ca(e){return{current:e}}function ka(e){0>Ea||(e.current=_a[Ea],_a[Ea]=null,Ea--)}function Sa(e,t){Ea++,_a[Ea]=e.current,e.current=t}var Aa={},Ia=Ca(Aa),Ra=Ca(!1),Oa=Aa;function Na(e,t){var r=e.type.contextTypes;if(!r)return Aa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in r)i[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function xa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pa(){ka(Ra),ka(Ia)}function Ma(e,t,r){if(Ia.current!==Aa)throw Error(i(168));Sa(Ia,t),Sa(Ra,r)}function La(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in t))throw Error(i(108,q(e)||"Unknown",a));return F({},r,n)}function Da(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Aa,Oa=Ia.current,Sa(Ia,e),Sa(Ra,Ra.current),!0}function Fa(e,t,r){var n=e.stateNode;if(!n)throw Error(i(169));r?(e=La(e,t,Oa),n.__reactInternalMemoizedMergedChildContext=e,ka(Ra),ka(Ia),Sa(Ia,e)):ka(Ra),Sa(Ra,r)}var Ua=null,Ha=!1,Ba=!1;function ja(e){null===Ua?Ua=[e]:Ua.push(e)}function za(){if(!Ba&&null!==Ua){Ba=!0;var e=0,t=bt;try{var r=Ua;for(bt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Ua=null,Ha=!1}catch(a){throw null!==Ua&&(Ua=Ua.slice(e+1)),We(Ze,za),a}finally{bt=t,Ba=!1}}return null}var qa=[],Ka=0,Ga=null,Va=0,Wa=[],Ya=0,$a=null,Qa=1,Ja="";function Xa(e,t){qa[Ka++]=Va,qa[Ka++]=Ga,Ga=e,Va=t}function Za(e,t,r){Wa[Ya++]=Qa,Wa[Ya++]=Ja,Wa[Ya++]=$a,$a=e;var n=Qa;e=Ja;var a=32-ot(n)-1;n&=~(1<<a),r+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Qa=1<<32-ot(t)+a|r<<a|n,Ja=i+e}else Qa=1<<i|r<<a|n,Ja=e}function ei(e){null!==e.return&&(Xa(e,1),Za(e,1,0))}function ti(e){for(;e===Ga;)Ga=qa[--Ka],qa[Ka]=null,Va=qa[--Ka],qa[Ka]=null;for(;e===$a;)$a=Wa[--Ya],Wa[Ya]=null,Ja=Wa[--Ya],Wa[Ya]=null,Qa=Wa[--Ya],Wa[Ya]=null}var ri=null,ni=null,ai=!1,ii=null;function oi(e,t){var r=xl(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function si(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ri=e,ni=la(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ri=e,ni=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==$a?{id:Qa,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=xl(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ri=e,ni=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function li(e){if(ai){var t=ni;if(t){var r=t;if(!si(e,t)){if(ci(e))throw Error(i(418));t=la(r.nextSibling);var n=ri;t&&si(e,t)?oi(n,r):(e.flags=-4097&e.flags|2,ai=!1,ri=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ri=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ri=e}function hi(e){if(e!==ri)return!1;if(!ai)return ui(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ra(e.type,e.memoizedProps)),t&&(t=ni)){if(ci(e))throw di(),Error(i(418));for(;t;)oi(e,t),t=la(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){ni=la(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}ni=null}}else ni=ri?la(e.stateNode.nextSibling):null;return!0}function di(){for(var e=ni;e;)e=la(e.nextSibling)}function fi(){ni=ri=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var gi=T.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var r in t=F({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var vi=Ca(null),yi=null,bi=null,Ti=null;function wi(){Ti=bi=yi=null}function _i(e){var t=vi.current;ka(vi),e._currentValue=t}function Ei(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ci(e,t){yi=e,Ti=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Ts=!0),e.firstContext=null)}function ki(e){var t=e._currentValue;if(Ti!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===yi)throw Error(i(308));bi=e,yi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var Si=null;function Ai(e){null===Si?Si=[e]:Si.push(e)}function Ii(e,t,r,n){var a=t.interleaved;return null===a?(r.next=r,Ai(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ri(e,n)}function Ri(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Oi=!1;function Ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Mi(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Rc)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ri(e,r)}return null===(a=n.interleaved)?(t.next=t,Ai(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ri(e,r)}function Li(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}function Di(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===i?a=i=o:i=i.next=o,r=r.next}while(null!==r);null===i?a=i=t:i=i.next=t}else a=i=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Fi(e,t,r,n){var a=e.updateQueue;Oi=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var c=s,l=c.next;c.next=null,null===o?i=l:o.next=l,o=c;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==i){var h=a.baseState;for(o=0,u=l=c=null,s=i;;){var d=s.lane,f=s.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,g=s;switch(d=t,f=r,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:Oi=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=a.effects)?a.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=f,c=h):u=u.next=f,o|=d;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(d=s).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===u&&(c=h),a.baseState=c,a.firstBaseUpdate=l,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Fc|=o,e.lanes=o,e.memoizedState=h}}function Ui(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=r,"function"!==typeof a)throw Error(i(191,a));a.call(n)}}}var Hi=(new n.Component).refs;function Bi(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:F({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var ji={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=tl(),a=rl(e),i=Pi(n,a);i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=Mi(e,i,a))&&(nl(t,e,a,n),Li(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=tl(),a=rl(e),i=Pi(n,a);i.tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=Mi(e,i,a))&&(nl(t,e,a,n),Li(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=tl(),n=rl(e),a=Pi(r,n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Mi(e,a,n))&&(nl(t,e,n,r),Li(t,e,n))}};function zi(e,t,r,n,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!cn(r,n)||!cn(a,i))}function qi(e,t,r){var n=!1,a=Aa,i=t.contextType;return"object"===typeof i&&null!==i?i=ki(i):(a=xa(t)?Oa:Ia.current,i=(n=null!==(n=t.contextTypes)&&void 0!==n)?Na(e,a):Aa),t=new t(r,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ji,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ki(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ji.enqueueReplaceState(t,t.state,null)}function Gi(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs=Hi,Ni(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=ki(i):(i=xa(t)?Oa:Ia.current,a.context=Na(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Bi(e,t,i,r),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ji.enqueueReplaceState(a,a.state,null),Fi(e,r,a,n),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Vi(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(i(309));var n=r.stateNode}if(!n)throw Error(i(147,e));var a=n,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===Hi&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!r._owner)throw Error(i(290,e))}return e}function Wi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yi(e){return(0,e._init)(e._payload)}function $i(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Ml(e,t)).index=0,e.sibling=null,e}function o(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,r,n){return null===t||6!==t.tag?((t=Ul(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function l(e,t,r,n){var i=r.type;return i===E?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===x&&Yi(i)===t.type)?((n=a(t,r.props)).ref=Vi(e,t,r),n.return=e,n):((n=Ll(r.type,r.key,r.props,null,e.mode,n)).ref=Vi(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Hl(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function h(e,t,r,n,i){return null===t||7!==t.tag?((t=Dl(r,e.mode,n,i)).return=e,t):((t=a(t,r)).return=e,t)}function d(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ul(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Ll(t.type,t.key,t.props,null,e.mode,r)).ref=Vi(e,null,t),r.return=e,r;case _:return(t=Hl(t,e.mode,r)).return=e,t;case x:return d(e,(0,t._init)(t._payload),r)}if(te(t)||L(t))return(t=Dl(t,e.mode,r,null)).return=e,t;Wi(e,t)}return null}function f(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==a?null:c(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===a?l(e,t,r,n):null;case _:return r.key===a?u(e,t,r,n):null;case x:return f(e,t,(a=r._init)(r._payload),n)}if(te(r)||L(r))return null!==a?null:h(e,t,r,n,null);Wi(e,r)}return null}function p(e,t,r,n,a){if("string"===typeof n&&""!==n||"number"===typeof n)return c(t,e=e.get(r)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return l(t,e=e.get(null===n.key?r:n.key)||null,n,a);case _:return u(t,e=e.get(null===n.key?r:n.key)||null,n,a);case x:return p(e,t,r,(0,n._init)(n._payload),a)}if(te(n)||L(n))return h(t,e=e.get(r)||null,n,a,null);Wi(t,n)}return null}function g(a,i,s,c){for(var l=null,u=null,h=i,g=i=0,m=null;null!==h&&g<s.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(a,h,s[g],c);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(a,h),i=o(v,i,g),null===u?l=v:u.sibling=v,u=v,h=m}if(g===s.length)return r(a,h),ai&&Xa(a,g),l;if(null===h){for(;g<s.length;g++)null!==(h=d(a,s[g],c))&&(i=o(h,i,g),null===u?l=h:u.sibling=h,u=h);return ai&&Xa(a,g),l}for(h=n(a,h);g<s.length;g++)null!==(m=p(h,a,g,s[g],c))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),i=o(m,i,g),null===u?l=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(a,e)})),ai&&Xa(a,g),l}function m(a,s,c,l){var u=L(c);if("function"!==typeof u)throw Error(i(150));if(null==(c=u.call(c)))throw Error(i(151));for(var h=u=null,g=s,m=s=0,v=null,y=c.next();null!==g&&!y.done;m++,y=c.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=f(a,g,y.value,l);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(a,g),s=o(b,s,m),null===h?u=b:h.sibling=b,h=b,g=v}if(y.done)return r(a,g),ai&&Xa(a,m),u;if(null===g){for(;!y.done;m++,y=c.next())null!==(y=d(a,y.value,l))&&(s=o(y,s,m),null===h?u=y:h.sibling=y,h=y);return ai&&Xa(a,m),u}for(g=n(a,g);!y.done;m++,y=c.next())null!==(y=p(g,a,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),s=o(y,s,m),null===h?u=y:h.sibling=y,h=y);return e&&g.forEach((function(e){return t(a,e)})),ai&&Xa(a,m),u}return function e(n,i,o,c){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var l=o.key,u=i;null!==u;){if(u.key===l){if((l=o.type)===E){if(7===u.tag){r(n,u.sibling),(i=a(u,o.props.children)).return=n,n=i;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===x&&Yi(l)===u.type){r(n,u.sibling),(i=a(u,o.props)).ref=Vi(n,u,o),i.return=n,n=i;break e}r(n,u);break}t(n,u),u=u.sibling}o.type===E?((i=Dl(o.props.children,n.mode,c,o.key)).return=n,n=i):((c=Ll(o.type,o.key,o.props,null,n.mode,c)).ref=Vi(n,i,o),c.return=n,n=c)}return s(n);case _:e:{for(u=o.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){r(n,i.sibling),(i=a(i,o.children||[])).return=n,n=i;break e}r(n,i);break}t(n,i),i=i.sibling}(i=Hl(o,n.mode,c)).return=n,n=i}return s(n);case x:return e(n,i,(u=o._init)(o._payload),c)}if(te(o))return g(n,i,o,c);if(L(o))return m(n,i,o,c);Wi(n,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(r(n,i.sibling),(i=a(i,o)).return=n,n=i):(r(n,i),(i=Ul(o,n.mode,c)).return=n,n=i),s(n)):r(n,i)}}var Qi=$i(!0),Ji=$i(!1),Xi={},Zi=Ca(Xi),eo=Ca(Xi),to=Ca(Xi);function ro(e){if(e===Xi)throw Error(i(174));return e}function no(e,t){switch(Sa(to,t),Sa(eo,e),Sa(Zi,Xi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ka(Zi),Sa(Zi,t)}function ao(){ka(Zi),ka(eo),ka(to)}function io(e){ro(to.current);var t=ro(Zi.current),r=ce(t,e.type);t!==r&&(Sa(eo,e),Sa(Zi,r))}function oo(e){eo.current===e&&(ka(Zi),ka(eo))}var so=Ca(0);function co(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var lo=[];function uo(){for(var e=0;e<lo.length;e++)lo[e]._workInProgressVersionPrimary=null;lo.length=0}var ho=T.ReactCurrentDispatcher,fo=T.ReactCurrentBatchConfig,po=0,go=null,mo=null,vo=null,yo=!1,bo=!1,To=0,wo=0;function _o(){throw Error(i(321))}function Eo(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function Co(e,t,r,n,a,o){if(po=o,go=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?ss:cs,e=r(n,a),bo){o=0;do{if(bo=!1,To=0,25<=o)throw Error(i(301));o+=1,vo=mo=null,t.updateQueue=null,ho.current=ls,e=r(n,a)}while(bo)}if(ho.current=os,t=null!==mo&&null!==mo.next,po=0,vo=mo=go=null,yo=!1,t)throw Error(i(300));return e}function ko(){var e=0!==To;return To=0,e}function So(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vo?go.memoizedState=vo=e:vo=vo.next=e,vo}function Ao(){if(null===mo){var e=go.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===vo?go.memoizedState:vo.next;if(null!==t)vo=t,mo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===vo?go.memoizedState=vo=e:vo=vo.next=e}return vo}function Io(e,t){return"function"===typeof t?t(e):t}function Ro(e){var t=Ao(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=mo,a=n.baseQueue,o=r.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}n.baseQueue=a=o,r.pending=null}if(null!==a){o=a.next,n=n.baseState;var c=s=null,l=null,u=o;do{var h=u.lane;if((po&h)===h)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=d,s=n):l=l.next=d,go.lanes|=h,Fc|=h}u=u.next}while(null!==u&&u!==o);null===l?s=n:l.next=c,sn(n,t.memoizedState)||(Ts=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(null!==(e=r.interleaved)){a=e;do{o=a.lane,go.lanes|=o,Fc|=o,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Oo(e){var t=Ao(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,o=t.memoizedState;if(null!==a){r.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sn(o,t.memoizedState)||(Ts=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function No(){}function xo(e,t){var r=go,n=Ao(),a=t(),o=!sn(n.memoizedState,a);if(o&&(n.memoizedState=a,Ts=!0),n=n.queue,Ko(Lo.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||null!==vo&&1&vo.memoizedState.tag){if(r.flags|=2048,Ho(9,Mo.bind(null,r,n,a,t),void 0,null),null===Oc)throw Error(i(349));0!==(30&po)||Po(r,t,a)}return a}function Po(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=go.updateQueue)?(t={lastEffect:null,stores:null},go.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Mo(e,t,r,n){t.value=r,t.getSnapshot=n,Do(t)&&Fo(e)}function Lo(e,t,r){return r((function(){Do(t)&&Fo(e)}))}function Do(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sn(e,r)}catch(n){return!0}}function Fo(e){var t=Ri(e,1);null!==t&&nl(t,e,1,-1)}function Uo(e){var t=So();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Io,lastRenderedState:e},t.queue=e,e=e.dispatch=rs.bind(null,go,e),[t.memoizedState,e]}function Ho(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=go.updateQueue)?(t={lastEffect:null,stores:null},go.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Bo(){return Ao().memoizedState}function jo(e,t,r,n){var a=So();go.flags|=e,a.memoizedState=Ho(1|t,r,void 0,void 0===n?null:n)}function zo(e,t,r,n){var a=Ao();n=void 0===n?null:n;var i=void 0;if(null!==mo){var o=mo.memoizedState;if(i=o.destroy,null!==n&&Eo(n,o.deps))return void(a.memoizedState=Ho(t,r,i,n))}go.flags|=e,a.memoizedState=Ho(1|t,r,i,n)}function qo(e,t){return jo(8390656,8,e,t)}function Ko(e,t){return zo(2048,8,e,t)}function Go(e,t){return zo(4,2,e,t)}function Vo(e,t){return zo(4,4,e,t)}function Wo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Yo(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,zo(4,4,Wo.bind(null,t,e),r)}function $o(){}function Qo(e,t){var r=Ao();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Eo(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Jo(e,t){var r=Ao();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Eo(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Xo(e,t,r){return 0===(21&po)?(e.baseState&&(e.baseState=!1,Ts=!0),e.memoizedState=r):(sn(r,t)||(r=gt(),go.lanes|=r,Fc|=r,e.baseState=!0),t)}function Zo(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var n=fo.transition;fo.transition={};try{e(!1),t()}finally{bt=r,fo.transition=n}}function es(){return Ao().memoizedState}function ts(e,t,r){var n=rl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ns(e))as(t,r);else if(null!==(r=Ii(e,t,r,n))){nl(r,e,n,tl()),is(r,t,n)}}function rs(e,t,r){var n=rl(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ns(e))as(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,r);if(a.hasEagerState=!0,a.eagerState=s,sn(s,o)){var c=t.interleaved;return null===c?(a.next=a,Ai(t)):(a.next=c.next,c.next=a),void(t.interleaved=a)}}catch(l){}null!==(r=Ii(e,t,a,n))&&(nl(r,e,n,a=tl()),is(r,t,n))}}function ns(e){var t=e.alternate;return e===go||null!==t&&t===go}function as(e,t){bo=yo=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function is(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}var os={readContext:ki,useCallback:_o,useContext:_o,useEffect:_o,useImperativeHandle:_o,useInsertionEffect:_o,useLayoutEffect:_o,useMemo:_o,useReducer:_o,useRef:_o,useState:_o,useDebugValue:_o,useDeferredValue:_o,useTransition:_o,useMutableSource:_o,useSyncExternalStore:_o,useId:_o,unstable_isNewReconciler:!1},ss={readContext:ki,useCallback:function(e,t){return So().memoizedState=[e,void 0===t?null:t],e},useContext:ki,useEffect:qo,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,jo(4194308,4,Wo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return jo(4194308,4,e,t)},useInsertionEffect:function(e,t){return jo(4,2,e,t)},useMemo:function(e,t){var r=So();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=So();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ts.bind(null,go,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},So().memoizedState=e},useState:Uo,useDebugValue:$o,useDeferredValue:function(e){return So().memoizedState=e},useTransition:function(){var e=Uo(!1),t=e[0];return e=Zo.bind(null,e[1]),So().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=go,a=So();if(ai){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===Oc)throw Error(i(349));0!==(30&po)||Po(n,t,r)}a.memoizedState=r;var o={value:r,getSnapshot:t};return a.queue=o,qo(Lo.bind(null,n,o,e),[e]),n.flags|=2048,Ho(9,Mo.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=So(),t=Oc.identifierPrefix;if(ai){var r=Ja;t=":"+t+"R"+(r=(Qa&~(1<<32-ot(Qa)-1)).toString(32)+r),0<(r=To++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=wo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cs={readContext:ki,useCallback:Qo,useContext:ki,useEffect:Ko,useImperativeHandle:Yo,useInsertionEffect:Go,useLayoutEffect:Vo,useMemo:Jo,useReducer:Ro,useRef:Bo,useState:function(){return Ro(Io)},useDebugValue:$o,useDeferredValue:function(e){return Xo(Ao(),mo.memoizedState,e)},useTransition:function(){return[Ro(Io)[0],Ao().memoizedState]},useMutableSource:No,useSyncExternalStore:xo,useId:es,unstable_isNewReconciler:!1},ls={readContext:ki,useCallback:Qo,useContext:ki,useEffect:Ko,useImperativeHandle:Yo,useInsertionEffect:Go,useLayoutEffect:Vo,useMemo:Jo,useReducer:Oo,useRef:Bo,useState:function(){return Oo(Io)},useDebugValue:$o,useDeferredValue:function(e){var t=Ao();return null===mo?t.memoizedState=e:Xo(t,mo.memoizedState,e)},useTransition:function(){return[Oo(Io)[0],Ao().memoizedState]},useMutableSource:No,useSyncExternalStore:xo,useId:es,unstable_isNewReconciler:!1};function us(e,t){try{var r="",n=t;do{r+=j(n),n=n.return}while(n);var a=r}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function hs(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,r){(r=Pi(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Gc||(Gc=!0,Vc=n),ds(0,t)},r}function gs(e,t,r){(r=Pi(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){ds(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(r.callback=function(){ds(0,t),"function"!==typeof n&&(null===Wc?Wc=new Set([this]):Wc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function ms(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new fs;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Sl.bind(null,e,t,r),t.then(e,e))}function vs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,r,n,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Pi(-1,1)).tag=2,Mi(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=T.ReactCurrentOwner,Ts=!1;function ws(e,t,r,n){t.child=null===e?Ji(t,null,r,n):Qi(t,e.child,r,n)}function _s(e,t,r,n,a){r=r.render;var i=t.ref;return Ci(t,a),n=Co(e,t,r,n,i,a),r=ko(),null===e||Ts?(ai&&r&&ei(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Es(e,t,r,n,a){if(null===e){var i=r.type;return"function"!==typeof i||Pl(i)||void 0!==i.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Ll(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Cs(e,t,i,n,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((r=null!==(r=r.compare)?r:cn)(o,n)&&e.ref===t.ref)return Gs(e,t,a)}return t.flags|=1,(e=Ml(i,n)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,r,n,a){if(null!==e){var i=e.memoizedProps;if(cn(i,n)&&e.ref===t.ref){if(Ts=!1,t.pendingProps=n=i,0===(e.lanes&a))return t.lanes=e.lanes,Gs(e,t,a);0!==(131072&e.flags)&&(Ts=!0)}}return As(e,t,r,n,a)}function ks(e,t,r){var n=t.pendingProps,a=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sa(Mc,Pc),Pc|=r;else{if(0===(1073741824&r))return e=null!==i?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sa(Mc,Pc),Pc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==i?i.baseLanes:r,Sa(Mc,Pc),Pc|=n}else null!==i?(n=i.baseLanes|r,t.memoizedState=null):n=r,Sa(Mc,Pc),Pc|=n;return ws(e,t,a,r),t.child}function Ss(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function As(e,t,r,n,a){var i=xa(r)?Oa:Ia.current;return i=Na(t,i),Ci(t,a),r=Co(e,t,r,n,i,a),n=ko(),null===e||Ts?(ai&&n&&ei(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Is(e,t,r,n,a){if(xa(r)){var i=!0;Da(t)}else i=!1;if(Ci(t,a),null===t.stateNode)Ks(e,t),qi(t,r,n),Gi(t,r,n,a),n=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var c=o.context,l=r.contextType;"object"===typeof l&&null!==l?l=ki(l):l=Na(t,l=xa(r)?Oa:Ia.current);var u=r.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==n||c!==l)&&Ki(t,o,n,l),Oi=!1;var d=t.memoizedState;o.state=d,Fi(t,n,o,a),c=t.memoizedState,s!==n||d!==c||Ra.current||Oi?("function"===typeof u&&(Bi(t,r,u,n),c=t.memoizedState),(s=Oi||zi(t,r,s,n,d,c,l))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=l,n=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,xi(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:mi(t.type,s),o.props=l,h=t.pendingProps,d=o.context,"object"===typeof(c=r.contextType)&&null!==c?c=ki(c):c=Na(t,c=xa(r)?Oa:Ia.current);var f=r.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==c)&&Ki(t,o,n,c),Oi=!1,d=t.memoizedState,o.state=d,Fi(t,n,o,a);var p=t.memoizedState;s!==h||d!==p||Ra.current||Oi?("function"===typeof f&&(Bi(t,r,f,n),p=t.memoizedState),(l=Oi||zi(t,r,l,n,d,p,c)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(n,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),o.props=n,o.state=p,o.context=c,n=l):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Rs(e,t,r,n,i,a)}function Rs(e,t,r,n,a,i){Ss(e,t);var o=0!==(128&t.flags);if(!n&&!o)return a&&Fa(t,r,!1),Gs(e,t,i);n=t.stateNode,bs.current=t;var s=o&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=Qi(t,e.child,null,i),t.child=Qi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=n.state,a&&Fa(t,r,!0),t.child}function Os(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),no(e,t.containerInfo)}function Ns(e,t,r,n,a){return fi(),pi(a),t.flags|=256,ws(e,t,r,n),t.child}var xs,Ps,Ms,Ls,Ds={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Us(e,t,r){var n,a=t.pendingProps,o=so.current,s=!1,c=0!==(128&t.flags);if((n=c)||(n=(null===e||null!==e.memoizedState)&&0!==(2&o)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Sa(so,1&o),null===e)return li(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=a.children,e=a.fallback,s?(a=t.mode,s=t.child,c={mode:"hidden",children:c},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Fl(c,a,0,null),e=Dl(e,a,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(r),t.memoizedState=Ds,e):Hs(t,c));if(null!==(o=e.memoizedState)&&null!==(n=o.dehydrated))return function(e,t,r,n,a,o,s){if(r)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,n=hs(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=n.fallback,a=t.mode,n=Fl({mode:"visible",children:n.children},a,0,null),(o=Dl(o,a,s,null)).flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,0!==(1&t.mode)&&Qi(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=Ds,o);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var c=n.dgst;return n=c,Bs(e,t,s,n=hs(o=Error(i(419)),n,void 0))}if(c=0!==(s&e.childLanes),Ts||c){if(null!==(n=Oc)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ri(e,a),nl(n,e,a,-1))}return ml(),Bs(e,t,s,n=hs(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ni=la(a.nextSibling),ri=t,ai=!0,ii=null,null!==e&&(Wa[Ya++]=Qa,Wa[Ya++]=Ja,Wa[Ya++]=$a,Qa=e.id,Ja=e.overflow,$a=t),t=Hs(t,n.children),t.flags|=4096,t)}(e,t,c,a,n,o,r);if(s){s=a.fallback,c=t.mode,n=(o=e.child).sibling;var l={mode:"hidden",children:a.children};return 0===(1&c)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=l,t.deletions=null):(a=Ml(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==n?s=Ml(n,s):(s=Dl(s,c,r,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,c=null===(c=e.child.memoizedState)?Fs(r):{baseLanes:c.baseLanes|r,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~r,t.memoizedState=Ds,a}return e=(s=e.child).sibling,a=Ml(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=r),a.return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Hs(e,t){return(t=Fl({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,r,n){return null!==n&&pi(n),Qi(t,e.child,null,r),(e=Hs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function js(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ei(e.return,t,r)}function zs(e,t,r,n,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function qs(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(ws(e,t,n.children,r),0!==(2&(n=so.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&js(e,r,t);else if(19===e.tag)js(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Sa(so,n),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===co(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),zs(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===co(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}zs(t,!0,r,null,i);break;case"together":zs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ks(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Fc|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=Ml(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Ml(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Vs(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ws(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Ys(e,t,r){var n=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(t),null;case 1:case 17:return xa(t.type)&&Pa(),Ws(t),null;case 3:return n=t.stateNode,ao(),ka(Ra),ka(Ia),uo(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(sl(ii),ii=null))),Ps(e,t),Ws(t),null;case 5:oo(t);var a=ro(to.current);if(r=t.type,null!==e&&null!=t.stateNode)Ms(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(i(166));return Ws(t),null}if(e=ro(Zi.current),hi(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[da]=t,n[fa]=o,e=0!==(1&t.mode),r){case"dialog":Hn("cancel",n),Hn("close",n);break;case"iframe":case"object":case"embed":Hn("load",n);break;case"video":case"audio":for(a=0;a<Ln.length;a++)Hn(Ln[a],n);break;case"source":Hn("error",n);break;case"img":case"image":case"link":Hn("error",n),Hn("load",n);break;case"details":Hn("toggle",n);break;case"input":Q(n,o),Hn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Hn("invalid",n);break;case"textarea":ae(n,o),Hn("invalid",n)}for(var c in ye(r,o),a=null,o)if(o.hasOwnProperty(c)){var l=o[c];"children"===c?"string"===typeof l?n.textContent!==l&&(!0!==o.suppressHydrationWarning&&Xn(n.textContent,l,e),a=["children",l]):"number"===typeof l&&n.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&Xn(n.textContent,l,e),a=["children",""+l]):s.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Hn("scroll",n)}switch(r){case"input":V(n),Z(n,o,!0);break;case"textarea":V(n),oe(n);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(n.onclick=Zn)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=c.createElement(r,{is:n.is}):(e=c.createElement(r),"select"===r&&(c=e,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):e=c.createElementNS(e,r),e[da]=t,e[fa]=n,xs(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(r,n),r){case"dialog":Hn("cancel",e),Hn("close",e),a=n;break;case"iframe":case"object":case"embed":Hn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Ln.length;a++)Hn(Ln[a],e);a=n;break;case"source":Hn("error",e),a=n;break;case"img":case"image":case"link":Hn("error",e),Hn("load",e),a=n;break;case"details":Hn("toggle",e),a=n;break;case"input":Q(e,n),a=$(e,n),Hn("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=F({},n,{value:void 0}),Hn("invalid",e);break;case"textarea":ae(e,n),a=ne(e,n),Hn("invalid",e)}for(o in ye(r,a),l=a)if(l.hasOwnProperty(o)){var u=l[o];"style"===o?me(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==r||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Hn("scroll",e):null!=u&&b(e,o,u,c))}switch(r){case"input":V(e),Z(e,n,!1);break;case"textarea":V(e),oe(e);break;case"option":null!=n.value&&e.setAttribute("value",""+K(n.value));break;case"select":e.multiple=!!n.multiple,null!=(o=n.value)?re(e,!!n.multiple,o,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ws(t),null;case 6:if(e&&null!=t.stateNode)Ls(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(r=ro(to.current),ro(Zi.current),hi(t)){if(n=t.stateNode,r=t.memoizedProps,n[da]=t,(o=n.nodeValue!==r)&&null!==(e=ri))switch(e.tag){case 3:Xn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xn(n.nodeValue,r,0!==(1&e.mode))}o&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[da]=t,t.stateNode=n}return Ws(t),null;case 13:if(ka(so),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ni&&0!==(1&t.mode)&&0===(128&t.flags))di(),fi(),t.flags|=98560,o=!1;else if(o=hi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[da]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ws(t),o=!1}else null!==ii&&(sl(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Lc&&(Lc=3):ml())),null!==t.updateQueue&&(t.flags|=4),Ws(t),null);case 4:return ao(),Ps(e,t),null===e&&zn(t.stateNode.containerInfo),Ws(t),null;case 10:return _i(t.type._context),Ws(t),null;case 19:if(ka(so),null===(o=t.memoizedState))return Ws(t),null;if(n=0!==(128&t.flags),null===(c=o.rendering))if(n)Vs(o,!1);else{if(0!==Lc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=co(e))){for(t.flags|=128,Vs(o,!1),null!==(n=c.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(o=r).flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,e=c.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Sa(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>qc&&(t.flags|=128,n=!0,Vs(o,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=co(c))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Vs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!c.alternate&&!ai)return Ws(t),null}else 2*Je()-o.renderingStartTime>qc&&1073741824!==r&&(t.flags|=128,n=!0,Vs(o,!1),t.lanes=4194304);o.isBackwards?(c.sibling=t.child,t.child=c):(null!==(r=o.last)?r.sibling=c:t.child=c,o.last=c)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,r=so.current,Sa(so,n?1&r|2:1&r),t):(Ws(t),null);case 22:case 23:return dl(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Pc)&&(Ws(t),6&t.subtreeFlags&&(t.flags|=8192)):Ws(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function $s(e,t){switch(ti(t),t.tag){case 1:return xa(t.type)&&Pa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),ka(Ra),ka(Ia),uo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(ka(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ka(so),null;case 4:return ao(),null;case 10:return _i(t.type._context),null;case 22:case 23:return dl(),null;default:return null}}xs=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Ps=function(){},Ms=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,ro(Zi.current);var i,o=null;switch(r){case"input":a=$(e,a),n=$(e,n),o=[];break;case"select":a=F({},a,{value:void 0}),n=F({},n,{value:void 0}),o=[];break;case"textarea":a=ne(e,a),n=ne(e,n),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(u in ye(r,n),r=null,a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var c=a[u];for(i in c)c.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var l=n[u];if(c=null!=a?a[u]:void 0,n.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(o||(o=[]),o.push(u,r)),r=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(o=o||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Hn("scroll",e),o||c===l||(o=[])):(o=o||[]).push(u,l))}r&&(o=o||[]).push("style",r);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Ls=function(e,t,r,n){r!==n&&(t.flags|=4)};var Qs=!1,Js=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Zs=null;function ec(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){kl(e,t,n)}else r.current=null}function tc(e,t,r){try{r()}catch(n){kl(e,t,n)}}var rc=!1;function nc(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&tc(t,r,i)}a=a.next}while(a!==n)}}function ac(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ic(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function oc(e){var t=e.alternate;null!==t&&(e.alternate=null,oc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[da],delete t[fa],delete t[ga],delete t[ma],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sc(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(lc(e,t,r),e=e.sibling;null!==e;)lc(e,t,r),e=e.sibling}function uc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(uc(e,t,r),e=e.sibling;null!==e;)uc(e,t,r),e=e.sibling}var hc=null,dc=!1;function fc(e,t,r){for(r=r.child;null!==r;)pc(e,t,r),r=r.sibling}function pc(e,t,r){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,r)}catch(s){}switch(r.tag){case 5:Js||ec(r,t);case 6:var n=hc,a=dc;hc=null,fc(e,t,r),dc=a,null!==(hc=n)&&(dc?(e=hc,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):hc.removeChild(r.stateNode));break;case 18:null!==hc&&(dc?(e=hc,r=r.stateNode,8===e.nodeType?ca(e.parentNode,r):1===e.nodeType&&ca(e,r),zt(e)):ca(hc,r.stateNode));break;case 4:n=hc,a=dc,hc=r.stateNode.containerInfo,dc=!0,fc(e,t,r),hc=n,dc=a;break;case 0:case 11:case 14:case 15:if(!Js&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&tc(r,t,o),a=a.next}while(a!==n)}fc(e,t,r);break;case 1:if(!Js&&(ec(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){kl(r,t,s)}fc(e,t,r);break;case 21:fc(e,t,r);break;case 22:1&r.mode?(Js=(n=Js)||null!==r.memoizedState,fc(e,t,r),Js=n):fc(e,t,r);break;default:fc(e,t,r)}}function gc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Xs),t.forEach((function(t){var n=Rl.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function mc(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n];try{var o=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 5:hc=c.stateNode,dc=!1;break e;case 3:case 4:hc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===hc)throw Error(i(160));pc(o,s,a),hc=null,dc=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(u){kl(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vc(t,e),t=t.sibling}function vc(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),yc(e),4&n){try{nc(3,e,e.return),ac(3,e)}catch(m){kl(e,e.return,m)}try{nc(5,e,e.return)}catch(m){kl(e,e.return,m)}}break;case 1:mc(t,e),yc(e),512&n&&null!==r&&ec(r,r.return);break;case 5:if(mc(t,e),yc(e),512&n&&null!==r&&ec(r,r.return),32&e.flags){var a=e.stateNode;try{de(a,"")}catch(m){kl(e,e.return,m)}}if(4&n&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==r?r.memoizedProps:o,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===o.type&&null!=o.name&&J(a,o),be(c,s);var u=be(c,o);for(s=0;s<l.length;s+=2){var h=l[s],d=l[s+1];"style"===h?me(a,d):"dangerouslySetInnerHTML"===h?he(a,d):"children"===h?de(a,d):b(a,h,d,u)}switch(c){case"input":X(a,o);break;case"textarea":ie(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?re(a,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?re(a,!!o.multiple,o.defaultValue,!0):re(a,!!o.multiple,o.multiple?[]:"",!1))}a[fa]=o}catch(m){kl(e,e.return,m)}}break;case 6:if(mc(t,e),yc(e),4&n){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(m){kl(e,e.return,m)}}break;case 3:if(mc(t,e),yc(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(m){kl(e,e.return,m)}break;case 4:default:mc(t,e),yc(e);break;case 13:mc(t,e),yc(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(zc=Je())),4&n&&gc(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Js=(u=Js)||h,mc(t,e),Js=u):mc(t,e),yc(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Zs=e,h=e.child;null!==h;){for(d=Zs=h;null!==Zs;){switch(p=(f=Zs).child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:ec(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){n=f,r=f.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){kl(n,r,m)}}break;case 5:ec(f,f.return);break;case 22:if(null!==f.memoizedState){_c(d);continue}}null!==p?(p.return=f,Zs=p):_c(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{a=d.stateNode,u?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=d.stateNode,s=void 0!==(l=d.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=ge("display",s))}catch(m){kl(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){kl(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:mc(t,e),yc(e),4&n&&gc(e);case 21:}}function yc(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(sc(r)){var n=r;break e}r=r.return}throw Error(i(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(de(a,""),n.flags&=-33),uc(e,cc(e),a);break;case 3:case 4:var o=n.stateNode.containerInfo;lc(e,cc(e),o);break;default:throw Error(i(161))}}catch(s){kl(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,r){Zs=e,Tc(e,t,r)}function Tc(e,t,r){for(var n=0!==(1&e.mode);null!==Zs;){var a=Zs,i=a.child;if(22===a.tag&&n){var o=null!==a.memoizedState||Qs;if(!o){var s=a.alternate,c=null!==s&&null!==s.memoizedState||Js;s=Qs;var l=Js;if(Qs=o,(Js=c)&&!l)for(Zs=a;null!==Zs;)c=(o=Zs).child,22===o.tag&&null!==o.memoizedState?Ec(a):null!==c?(c.return=o,Zs=c):Ec(a);for(;null!==i;)Zs=i,Tc(i,t,r),i=i.sibling;Zs=a,Qs=s,Js=l}wc(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Zs=i):wc(e)}}function wc(e){for(;null!==Zs;){var t=Zs;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Js||ac(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Js)if(null===r)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:mi(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ui(t,o,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Ui(t,s,r)}break;case 5:var c=t.stateNode;if(null===r&&4&t.flags){r=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&zt(d)}}}break;default:throw Error(i(163))}Js||512&t.flags&&ic(t)}catch(f){kl(t,t.return,f)}}if(t===e){Zs=null;break}if(null!==(r=t.sibling)){r.return=t.return,Zs=r;break}Zs=t.return}}function _c(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Zs=r;break}Zs=t.return}}function Ec(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ac(4,t)}catch(c){kl(t,r,c)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(c){kl(t,a,c)}}var i=t.return;try{ic(t)}catch(c){kl(t,i,c)}break;case 5:var o=t.return;try{ic(t)}catch(c){kl(t,o,c)}}}catch(c){kl(t,t.return,c)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var Cc,kc=Math.ceil,Sc=T.ReactCurrentDispatcher,Ac=T.ReactCurrentOwner,Ic=T.ReactCurrentBatchConfig,Rc=0,Oc=null,Nc=null,xc=0,Pc=0,Mc=Ca(0),Lc=0,Dc=null,Fc=0,Uc=0,Hc=0,Bc=null,jc=null,zc=0,qc=1/0,Kc=null,Gc=!1,Vc=null,Wc=null,Yc=!1,$c=null,Qc=0,Jc=0,Xc=null,Zc=-1,el=0;function tl(){return 0!==(6&Rc)?Je():-1!==Zc?Zc:Zc=Je()}function rl(e){return 0===(1&e.mode)?1:0!==(2&Rc)&&0!==xc?xc&-xc:null!==gi.transition?(0===el&&(el=gt()),el):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nl(e,t,r,n){if(50<Jc)throw Jc=0,Xc=null,Error(i(185));vt(e,r,n),0!==(2&Rc)&&e===Oc||(e===Oc&&(0===(2&Rc)&&(Uc|=r),4===Lc&&cl(e,xc)),al(e,n),1===r&&0===Rc&&0===(1&t.mode)&&(qc=Je()+500,Ha&&za()))}function al(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,c=a[o];-1===c?0!==(s&r)&&0===(s&n)||(a[o]=ft(s,t)):c<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var n=dt(e,e===Oc?xc:0);if(0===n)null!==r&&Ye(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Ye(r),1===t)0===e.tag?function(e){Ha=!0,ja(e)}(ll.bind(null,e)):ja(ll.bind(null,e)),oa((function(){0===(6&Rc)&&za()})),r=null;else{switch(Tt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Ol(r,il.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function il(e,t){if(Zc=-1,el=0,0!==(6&Rc))throw Error(i(327));var r=e.callbackNode;if(El()&&e.callbackNode!==r)return null;var n=dt(e,e===Oc?xc:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=vl(e,n);else{t=n;var a=Rc;Rc|=2;var o=gl();for(Oc===e&&xc===t||(Kc=null,qc=Je()+500,fl(e,t));;)try{bl();break}catch(c){pl(e,c)}wi(),Sc.current=o,Rc=a,null!==Nc?t=0:(Oc=null,xc=0,t=Lc)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(n=a,t=ol(e,a))),1===t)throw r=Dc,fl(e,0),cl(e,n),al(e,Je()),r;if(6===t)cl(e,n);else{if(a=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!sn(i(),a))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=vl(e,n))&&(0!==(o=pt(e))&&(n=o,t=ol(e,o))),1===t))throw r=Dc,fl(e,0),cl(e,n),al(e,Je()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(i(345));case 2:case 5:_l(e,jc,Kc);break;case 3:if(cl(e,n),(130023424&n)===n&&10<(t=zc+500-Je())){if(0!==dt(e,0))break;if(((a=e.suspendedLanes)&n)!==n){tl(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=na(_l.bind(null,e,jc,Kc),t);break}_l(e,jc,Kc);break;case 4:if(cl(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-ot(n);o=1<<s,(s=t[s])>a&&(a=s),n&=~o}if(n=a,10<(n=(120>(n=Je()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*kc(n/1960))-n)){e.timeoutHandle=na(_l.bind(null,e,jc,Kc),n);break}_l(e,jc,Kc);break;default:throw Error(i(329))}}}return al(e,Je()),e.callbackNode===r?il.bind(null,e):null}function ol(e,t){var r=Bc;return e.current.memoizedState.isDehydrated&&(fl(e,t).flags|=256),2!==(e=vl(e,t))&&(t=jc,jc=r,null!==t&&sl(t)),e}function sl(e){null===jc?jc=e:jc.push.apply(jc,e)}function cl(e,t){for(t&=~Hc,t&=~Uc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ot(t),n=1<<r;e[r]=-1,t&=~n}}function ll(e){if(0!==(6&Rc))throw Error(i(327));El();var t=dt(e,0);if(0===(1&t))return al(e,Je()),null;var r=vl(e,t);if(0!==e.tag&&2===r){var n=pt(e);0!==n&&(t=n,r=ol(e,n))}if(1===r)throw r=Dc,fl(e,0),cl(e,t),al(e,Je()),r;if(6===r)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_l(e,jc,Kc),al(e,Je()),null}function ul(e,t){var r=Rc;Rc|=1;try{return e(t)}finally{0===(Rc=r)&&(qc=Je()+500,Ha&&za())}}function hl(e){null!==$c&&0===$c.tag&&0===(6&Rc)&&El();var t=Rc;Rc|=1;var r=Ic.transition,n=bt;try{if(Ic.transition=null,bt=1,e)return e()}finally{bt=n,Ic.transition=r,0===(6&(Rc=t))&&za()}}function dl(){Pc=Mc.current,ka(Mc)}function fl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,aa(r)),null!==Nc)for(r=Nc.return;null!==r;){var n=r;switch(ti(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Pa();break;case 3:ao(),ka(Ra),ka(Ia),uo();break;case 5:oo(n);break;case 4:ao();break;case 13:case 19:ka(so);break;case 10:_i(n.type._context);break;case 22:case 23:dl()}r=r.return}if(Oc=e,Nc=e=Ml(e.current,null),xc=Pc=t,Lc=0,Dc=null,Hc=Uc=Fc=0,jc=Bc=null,null!==Si){for(t=0;t<Si.length;t++)if(null!==(n=(r=Si[t]).interleaved)){r.interleaved=null;var a=n.next,i=r.pending;if(null!==i){var o=i.next;i.next=a,n.next=o}r.pending=n}Si=null}return e}function pl(e,t){for(;;){var r=Nc;try{if(wi(),ho.current=os,yo){for(var n=go.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}yo=!1}if(po=0,vo=mo=go=null,bo=!1,To=0,Ac.current=null,null===r||null===r.return){Lc=1,Dc=t,Nc=null;break}e:{var o=e,s=r.return,c=r,l=t;if(t=xc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,h=c,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=vs(s);if(null!==p){p.flags&=-257,ys(p,s,c,0,t),1&p.mode&&ms(o,u,t),l=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(0===(1&t)){ms(o,u,t),ml();break e}l=Error(i(426))}else if(ai&&1&c.mode){var v=vs(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ys(v,s,c,0,t),pi(us(l,c));break e}}o=l=us(l,c),4!==Lc&&(Lc=2),null===Bc?Bc=[o]:Bc.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Di(o,ps(0,l,t));break e;case 1:c=l;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Wc||!Wc.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Di(o,gs(o,c,t));break e}}o=o.return}while(null!==o)}wl(r)}catch(T){t=T,Nc===r&&null!==r&&(Nc=r=r.return);continue}break}}function gl(){var e=Sc.current;return Sc.current=os,null===e?os:e}function ml(){0!==Lc&&3!==Lc&&2!==Lc||(Lc=4),null===Oc||0===(268435455&Fc)&&0===(268435455&Uc)||cl(Oc,xc)}function vl(e,t){var r=Rc;Rc|=2;var n=gl();for(Oc===e&&xc===t||(Kc=null,fl(e,t));;)try{yl();break}catch(a){pl(e,a)}if(wi(),Rc=r,Sc.current=n,null!==Nc)throw Error(i(261));return Oc=null,xc=0,Lc}function yl(){for(;null!==Nc;)Tl(Nc)}function bl(){for(;null!==Nc&&!$e();)Tl(Nc)}function Tl(e){var t=Cc(e.alternate,e,Pc);e.memoizedProps=e.pendingProps,null===t?wl(e):Nc=t,Ac.current=null}function wl(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Ys(r,t,Pc)))return void(Nc=r)}else{if(null!==(r=$s(r,t)))return r.flags&=32767,void(Nc=r);if(null===e)return Lc=6,void(Nc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Nc=t);Nc=t=e}while(null!==t);0===Lc&&(Lc=5)}function _l(e,t,r){var n=bt,a=Ic.transition;try{Ic.transition=null,bt=1,function(e,t,r,n){do{El()}while(null!==$c);if(0!==(6&Rc))throw Error(i(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ot(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}(e,o),e===Oc&&(Nc=Oc=null,xc=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Yc||(Yc=!0,Ol(tt,(function(){return El(),null}))),o=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||o){o=Ic.transition,Ic.transition=null;var s=bt;bt=1;var c=Rc;Rc|=4,Ac.current=null,function(e,t){if(ea=Kt,fn(e=dn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch(w){r=null;break e}var s=0,c=-1,l=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==r||0!==a&&3!==d.nodeType||(c=s+a),d!==o||0!==n&&3!==d.nodeType||(l=s+n),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===r&&++u===a&&(c=s),f===o&&++h===n&&(l=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}r=-1===c||-1===l?null:{start:c,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ta={focusedElem:e,selectionRange:r},Kt=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:mi(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var T=t.stateNode.containerInfo;1===T.nodeType?T.textContent="":9===T.nodeType&&T.documentElement&&T.removeChild(T.documentElement);break;default:throw Error(i(163))}}catch(w){kl(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}g=rc,rc=!1}(e,r),vc(r,e),pn(ta),Kt=!!ea,ta=ea=null,e.current=r,bc(r,e,a),Qe(),Rc=c,bt=s,Ic.transition=o}else e.current=r;if(Yc&&(Yc=!1,$c=e,Qc=a),o=e.pendingLanes,0===o&&(Wc=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),al(e,Je()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Gc)throw Gc=!1,e=Vc,Vc=null,e;0!==(1&Qc)&&0!==e.tag&&El(),o=e.pendingLanes,0!==(1&o)?e===Xc?Jc++:(Jc=0,Xc=e):Jc=0,za()}(e,t,r,n)}finally{Ic.transition=a,bt=n}return null}function El(){if(null!==$c){var e=Tt(Qc),t=Ic.transition,r=bt;try{if(Ic.transition=null,bt=16>e?16:e,null===$c)var n=!1;else{if(e=$c,$c=null,Qc=0,0!==(6&Rc))throw Error(i(331));var a=Rc;for(Rc|=4,Zs=e.current;null!==Zs;){var o=Zs,s=o.child;if(0!==(16&Zs.flags)){var c=o.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Zs=u;null!==Zs;){var h=Zs;switch(h.tag){case 0:case 11:case 15:nc(8,h,o)}var d=h.child;if(null!==d)d.return=h,Zs=d;else for(;null!==Zs;){var f=(h=Zs).sibling,p=h.return;if(oc(h),h===u){Zs=null;break}if(null!==f){f.return=p,Zs=f;break}Zs=p}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Zs=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Zs=s;else e:for(;null!==Zs;){if(0!==(2048&(o=Zs).flags))switch(o.tag){case 0:case 11:case 15:nc(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Zs=y;break e}Zs=o.return}}var b=e.current;for(Zs=b;null!==Zs;){var T=(s=Zs).child;if(0!==(2064&s.subtreeFlags)&&null!==T)T.return=s,Zs=T;else e:for(s=b;null!==Zs;){if(0!==(2048&(c=Zs).flags))try{switch(c.tag){case 0:case 11:case 15:ac(9,c)}}catch(_){kl(c,c.return,_)}if(c===s){Zs=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Zs=w;break e}Zs=c.return}}if(Rc=a,za(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(_){}n=!0}return n}finally{bt=r,Ic.transition=t}}return!1}function Cl(e,t,r){e=Mi(e,t=ps(0,t=us(r,t),1),1),t=tl(),null!==e&&(vt(e,1,t),al(e,t))}function kl(e,t,r){if(3===e.tag)Cl(e,e,r);else for(;null!==t;){if(3===t.tag){Cl(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Wc||!Wc.has(n))){t=Mi(t,e=gs(t,e=us(r,e),1),1),e=tl(),null!==t&&(vt(t,1,e),al(t,e));break}}t=t.return}}function Sl(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&r,Oc===e&&(xc&r)===r&&(4===Lc||3===Lc&&(130023424&xc)===xc&&500>Je()-zc?fl(e,0):Hc|=r),al(e,t)}function Al(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var r=tl();null!==(e=Ri(e,t))&&(vt(e,t,r),al(e,r))}function Il(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Al(e,r)}function Rl(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(i(314))}null!==n&&n.delete(t),Al(e,r)}function Ol(e,t){return We(e,t)}function Nl(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xl(e,t,r,n){return new Nl(e,t,r,n)}function Pl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ml(e,t){var r=e.alternate;return null===r?((r=xl(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ll(e,t,r,n,a,o){var s=2;if(n=e,"function"===typeof e)Pl(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case E:return Dl(r.children,a,o,t);case C:s=8,a|=8;break;case k:return(e=xl(12,r,t,2|a)).elementType=k,e.lanes=o,e;case R:return(e=xl(13,r,t,a)).elementType=R,e.lanes=o,e;case O:return(e=xl(19,r,t,a)).elementType=O,e.lanes=o,e;case P:return Fl(r,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case A:s=9;break e;case I:s=11;break e;case N:s=14;break e;case x:s=16,n=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=xl(s,r,t,a)).elementType=e,t.type=n,t.lanes=o,t}function Dl(e,t,r,n){return(e=xl(7,e,n,t)).lanes=r,e}function Fl(e,t,r,n){return(e=xl(22,e,n,t)).elementType=P,e.lanes=r,e.stateNode={isHidden:!1},e}function Ul(e,t,r){return(e=xl(6,e,null,t)).lanes=r,e}function Hl(e,t,r){return(t=xl(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bl(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function jl(e,t,r,n,a,i,o,s,c){return e=new Bl(e,t,r,s,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=xl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ni(i),e}function zl(e){if(!e)return Aa;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(xa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var r=e.type;if(xa(r))return La(e,r,t)}return t}function ql(e,t,r,n,a,i,o,s,c){return(e=jl(r,n,!0,e,0,i,0,s,c)).context=zl(null),r=e.current,(i=Pi(n=tl(),a=rl(r))).callback=void 0!==t&&null!==t?t:null,Mi(r,i,a),e.current.lanes=a,vt(e,a,n),al(e,n),e}function Kl(e,t,r,n){var a=t.current,i=tl(),o=rl(a);return r=zl(r),null===t.context?t.context=r:t.pendingContext=r,(t=Pi(i,o)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Mi(a,t,o))&&(nl(e,a,o,i),Li(e,a,o)),o}function Gl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Wl(e,t){Vl(e,t),(e=e.alternate)&&Vl(e,t)}Cc=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ra.current)Ts=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return Ts=!1,function(e,t,r){switch(t.tag){case 3:Os(t),fi();break;case 5:io(t);break;case 1:xa(t.type)&&Da(t);break;case 4:no(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Sa(vi,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Sa(so,1&so.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Us(e,t,r):(Sa(so,1&so.current),null!==(e=Gs(e,t,r))?e.sibling:null);Sa(so,1&so.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return qs(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Sa(so,so.current),n)break;return null;case 22:case 23:return t.lanes=0,ks(e,t,r)}return Gs(e,t,r)}(e,t,r);Ts=0!==(131072&e.flags)}else Ts=!1,ai&&0!==(1048576&t.flags)&&Za(t,Va,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ks(e,t),e=t.pendingProps;var a=Na(t,Ia.current);Ci(t,r),a=Co(null,t,n,e,a,r);var o=ko();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,xa(n)?(o=!0,Da(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ni(t),a.updater=ji,t.stateNode=a,a._reactInternals=t,Gi(t,n,e,r),t=Rs(null,t,n,!0,o,r)):(t.tag=0,ai&&o&&ei(t),ws(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ks(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"===typeof e)return Pl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===N)return 14}return 2}(n),e=mi(n,e),a){case 0:t=As(null,t,n,e,r);break e;case 1:t=Is(null,t,n,e,r);break e;case 11:t=_s(null,t,n,e,r);break e;case 14:t=Es(null,t,n,mi(n.type,e),r);break e}throw Error(i(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,As(e,t,n,a=t.elementType===n?a:mi(n,a),r);case 1:return n=t.type,a=t.pendingProps,Is(e,t,n,a=t.elementType===n?a:mi(n,a),r);case 3:e:{if(Os(t),null===e)throw Error(i(387));n=t.pendingProps,a=(o=t.memoizedState).element,xi(e,t),Fi(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated){if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ns(e,t,n,r,a=us(Error(i(423)),t));break e}if(n!==a){t=Ns(e,t,n,r,a=us(Error(i(424)),t));break e}for(ni=la(t.stateNode.containerInfo.firstChild),ri=t,ai=!0,ii=null,r=Ji(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(fi(),n===a){t=Gs(e,t,r);break e}ws(e,t,n,r)}t=t.child}return t;case 5:return io(t),null===e&&li(t),n=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,ra(n,a)?s=null:null!==o&&ra(n,o)&&(t.flags|=32),Ss(e,t),ws(e,t,s,r),t.child;case 6:return null===e&&li(t),null;case 13:return Us(e,t,r);case 4:return no(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Qi(t,null,n,r):ws(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,_s(e,t,n,a=t.elementType===n?a:mi(n,a),r);case 7:return ws(e,t,t.pendingProps,r),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Sa(vi,n._currentValue),n._currentValue=s,null!==o)if(sn(o.value,s)){if(o.children===a.children&&!Ra.current){t=Gs(e,t,r);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var c=o.dependencies;if(null!==c){s=o.child;for(var l=c.firstContext;null!==l;){if(l.context===n){if(1===o.tag){(l=Pi(-1,r&-r)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),Ei(o.return,r,t),c.lanes|=r;break}l=l.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),Ei(s,r,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ci(t,r),n=n(a=ki(a)),t.flags|=1,ws(e,t,n,r),t.child;case 14:return a=mi(n=t.type,t.pendingProps),Es(e,t,n,a=mi(n.type,a),r);case 15:return Cs(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:mi(n,a),Ks(e,t),t.tag=1,xa(n)?(e=!0,Da(t)):e=!1,Ci(t,r),qi(t,n,a),Gi(t,n,a,r),Rs(null,t,n,!0,e,r);case 19:return qs(e,t,r);case 22:return ks(e,t,r)}throw Error(i(156,t.tag))};var Yl="function"===typeof reportError?reportError:function(e){console.error(e)};function $l(e){this._internalRoot=e}function Ql(e){this._internalRoot=e}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zl(){}function eu(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Gl(o);s.call(e)}}Kl(t,o,e,a)}else o=function(e,t,r,n,a){if(a){if("function"===typeof n){var i=n;n=function(){var e=Gl(o);i.call(e)}}var o=ql(t,n,e,0,null,!1,0,"",Zl);return e._reactRootContainer=o,e[pa]=o.current,zn(8===e.nodeType?e.parentNode:e),hl(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof n){var s=n;n=function(){var e=Gl(c);s.call(e)}}var c=jl(e,0,!1,null,0,!1,0,"",Zl);return e._reactRootContainer=c,e[pa]=c.current,zn(8===e.nodeType?e.parentNode:e),hl((function(){Kl(t,c,r,n)})),c}(r,t,e,a,n);return Gl(o)}Ql.prototype.render=$l.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Kl(e,t,null,null)},Ql.prototype.unmount=$l.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hl((function(){Kl(null,e,null,null)})),t[pa]=null}},Ql.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pt.length&&0!==t&&t<Pt[r].priority;r++);Pt.splice(r,0,e),0===r&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(yt(t,1|r),al(t,Je()),0===(6&Rc)&&(qc=Je()+500,za()))}break;case 13:hl((function(){var t=Ri(e,1);if(null!==t){var r=tl();nl(t,e,1,r)}})),Wl(e,1)}},_t=function(e){if(13===e.tag){var t=Ri(e,134217728);if(null!==t)nl(t,e,134217728,tl());Wl(e,134217728)}},Et=function(e){if(13===e.tag){var t=rl(e),r=Ri(e,t);if(null!==r)nl(r,e,t,tl());Wl(e,t)}},Ct=function(){return bt},kt=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},_e=function(e,t,r){switch(t){case"input":if(X(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=wa(n);if(!a)throw Error(i(90));W(n),X(n,a)}}}break;case"textarea":ie(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ie=ul,Re=hl;var tu={usingClientEntryPoint:!1,Events:[ba,Ta,wa,Se,Ae,ul]},ru={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nu={bundleType:ru.bundleType,version:ru.version,rendererPackageName:ru.rendererPackageName,rendererConfig:ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:ru.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{at=au.inject(nu),it=au}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jl(t))throw Error(i(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Jl(e))throw Error(i(299));var r=!1,n="",a=Yl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=jl(e,1,!1,null,0,r,0,n,a),e[pa]=t.current,zn(8===e.nodeType?e.parentNode:e),new $l(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return hl(e)},t.hydrate=function(e,t,r){if(!Xl(t))throw Error(i(200));return eu(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Jl(e))throw Error(i(405));var n=null!=r&&r.hydratedSources||null,a=!1,o="",s=Yl;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(o=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=ql(t,null,e,1,null!=r?r:null,a,0,o,s),e[pa]=t.current,zn(e),n)for(e=0;e<n.length;e++)a=(a=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Ql(t)},t.render=function(e,t,r){if(!Xl(t))throw Error(i(200));return eu(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Xl(e))throw Error(i(40));return!!e._reactRootContainer&&(hl((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Xl(r))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return eu(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:(e,t,r)=>{"use strict";var n=r(4164);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},4164:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(4463)},6374:(e,t,r)=>{"use strict";var n=r(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var n,i={},l=null,u=null;for(n in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:a,type:e,key:l,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},9117:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||p}function y(){}function b(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var T=b.prototype=new y;T.constructor=b,g(T,v.prototype),T.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,E={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)_.call(t,a)&&!C.hasOwnProperty(a)&&(i[a]=t[a]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===i[a]&&(i[a]=c[a]);return{$$typeof:r,type:e,key:o,ref:s,props:i,_owner:E.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var A=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case n:c=!0}}if(c)return o=o(c=e),e=""===i?"."+I(c,0):i,w(o)?(a="",null!=e&&(a=e.replace(A,"$&/")+"/"),R(o,t,a,"",(function(e){return e}))):null!=o&&(S(o)&&(o=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(A,"$&/")+"/")+e)),t.push(o)),1;if(c=0,i=""===i?".":i+":",w(e))for(var l=0;l<e.length;l++){var u=i+I(s=e[l],l);c+=R(s,t,a,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(s=e.next()).done;)c+=R(s=s.value,t,a,u=i+I(s,l++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function O(e,t,r){if(null==e)return e;var n=[],a=0;return R(e,n,"","",(function(e){return t.call(r,e,a++)})),n}function N(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var x={current:null},P={transition:null},M={ReactCurrentDispatcher:x,ReactCurrentBatchConfig:P,ReactCurrentOwner:E};t.Children={map:O,forEach:function(e,t,r){O(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=g({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=E.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)_.call(t,l)&&!C.hasOwnProperty(l)&&(a[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:r,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return x.current.useCallback(e,t)},t.useContext=function(e){return x.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return x.current.useDeferredValue(e)},t.useEffect=function(e,t){return x.current.useEffect(e,t)},t.useId=function(){return x.current.useId()},t.useImperativeHandle=function(e,t,r){return x.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return x.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return x.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return x.current.useMemo(e,t)},t.useReducer=function(e,t,r){return x.current.useReducer(e,t,r)},t.useRef=function(e){return x.current.useRef(e)},t.useState=function(e){return x.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return x.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return x.current.useTransition()},t.version="18.2.0"},2791:(e,t,r)=>{"use strict";e.exports=r(9117)},184:(e,t,r)=>{"use strict";e.exports=r(6374)},6813:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(!(0<i(a,t)))break e;e[n]=t,e[r]=a,r=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,o=a>>>1;n<o;){var s=2*(n+1)-1,c=e[s],l=s+1,u=e[l];if(0>i(c,r))l<a&&0>i(u,c)?(e[n]=u,e[l]=r,n=l):(e[n]=c,e[s]=r,n=s);else{if(!(l<a&&0>i(u,r)))break e;e[n]=u,e[l]=r,n=l}}}return t}function i(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function T(e){for(var t=n(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,r(l,t)}t=n(u)}}function w(e){if(m=!1,T(e),!g)if(null!==n(l))g=!0,P(_);else{var t=n(u);null!==t&&M(w,t.startTime-e)}}function _(e,r){g=!1,m&&(m=!1,y(S),S=-1),p=!0;var i=f;try{for(T(r),d=n(l);null!==d&&(!(d.expirationTime>r)||e&&!R());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?d.callback=s:d===n(l)&&a(l),T(r)}else a(l);d=n(l)}if(null!==d)var c=!0;else{var h=n(u);null!==h&&M(w,h.startTime-r),c=!1}return c}finally{d=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,C=!1,k=null,S=-1,A=5,I=-1;function R(){return!(t.unstable_now()-I<A)}function O(){if(null!==k){var e=t.unstable_now();I=e;var r=!0;try{r=k(!0,e)}finally{r?E():(C=!1,k=null)}}else C=!1}if("function"===typeof b)E=function(){b(O)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,x=N.port2;N.port1.onmessage=O,E=function(){x.postMessage(null)}}else E=function(){v(O,0)};function P(e){k=e,C||(C=!0,E())}function M(e,r){S=v((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,P(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,r(u,e),null===n(l)&&e===n(u)&&(m?(y(S),S=-1):m=!0,M(w,i-o))):(e.sortIndex=s,r(l,e),g||p||(g=!0,P(_))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},5296:(e,t,r)=>{"use strict";e.exports=r(6813)},5087:(e,t,r)=>{var n;if("object"===typeof globalThis)n=globalThis;else try{n=r(4210)}catch(s){}finally{if(n||"undefined"===typeof window||(n=window),!n)throw new Error("Could not determine global this")}var a=n.WebSocket||n.MozWebSocket,i=r(1496);function o(e,t){return t?new a(e,t):new a(e)}a&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(o,e,{get:function(){return a[e]}})})),e.exports={w3cwebsocket:a?o:null,version:i}},1496:(e,t,r)=>{e.exports=r(9794).version},2300:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});class n{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach(((t,r)=>{e.push(r)})),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}},670:(e,t,r)=>{"use strict";r.d(t,{Is:()=>_,_7:()=>k});var n=r(825),a=r(9269),i=r(9686),o=r(9684),s=r(7906),c=r(2200),l=r(3932);const u={sendGetRequestAsync:()=>Promise.reject((0,c.zP)(l.M2)),sendPostRequestAsync:()=>Promise.reject((0,c.zP)(l.M2))};var h=r(2346);class d{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class f{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:h.$L.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new d}}startPerformanceMeasurement(){return new d}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}var p=r(9050),g=r(4734),m=r(4190);class v{navigateInternal(e,t){return v.defaultNavigateWindow(e,t)}navigateExternal(e,t){return v.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e=>{setTimeout((()=>{e(!0)}),t.timeout)}))}}var y=r(8254),b=r(4394);class T{async sendGetRequestAsync(e,t){let r;try{r=await fetch(e,{method:m.EC.GET,headers:this.getFetchHeaders(t)})}catch(n){throw window.navigator.onLine?(0,y.Z_)(b.C8):(0,y.Z_)(b.Mq)}try{return{headers:this.getHeaderDict(r.headers),body:await r.json(),status:r.status}}catch(n){throw(0,y.Z_)(b.w6)}}async sendPostRequestAsync(e,t){const r=t&&t.body||n.gT.EMPTY_STRING;let a;try{a=await fetch(e,{method:m.EC.POST,headers:this.getFetchHeaders(t),body:r})}catch(i){throw window.navigator.onLine?(0,y.Z_)(b.Dc):(0,y.Z_)(b.Mq)}try{return{headers:this.getHeaderDict(a.headers),body:await a.json(),status:a.status}}catch(i){throw(0,y.Z_)(b.w6)}}getFetchHeaders(e){const t=new Headers;if(!e||!e.headers)return t;const r=e.headers;return Object.keys(r).forEach((e=>{t.append(e,r[e])})),t}getHeaderDict(e){const t={};return e.forEach(((e,r)=>{t[r]=e})),t}}const w=6e4,_=6e3,E=3e4,C=2e3;function k(e,t){let{auth:r,cache:c,system:l,telemetry:h}=e;const d={clientId:n.gT.EMPTY_STRING,authority:"".concat(n.gT.DEFAULT_AUTHORITY),knownAuthorities:[],cloudDiscoveryMetadata:n.gT.EMPTY_STRING,authorityMetadata:n.gT.EMPTY_STRING,redirectUri:n.gT.EMPTY_STRING,postLogoutRedirectUri:n.gT.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:a.A.AAD,OIDCOptions:{serverResponseType:n.rg.FRAGMENT,defaultScopes:[n.gT.OPENID_SCOPE,n.gT.PROFILE_SCOPE,n.gT.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:i.z.None,tenant:n.gT.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1},y={cacheLocation:m.Ix.SessionStorage,temporaryCacheLocation:m.Ix.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!c||c.cacheLocation!==m.Ix.LocalStorage),claimsBasedCachingEnabled:!1},b={loggerCallback:()=>{},logLevel:o.i.Info,piiLoggingEnabled:!1},k={...{...s.z,loggerOptions:b,networkClient:t?new T:u,navigationClient:new v,loadFrameTimeout:0,windowHashTimeout:(null===l||void 0===l?void 0:l.loadFrameTimeout)||w,iframeHashTimeout:(null===l||void 0===l?void 0:l.loadFrameTimeout)||_,navigateFrameWait:0,redirectNavigationTimeout:E,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null===l||void 0===l?void 0:l.nativeBrokerHandshakeTimeout)||C,pollIntervalMilliseconds:m.qx.DEFAULT_POLL_INTERVAL_MS},...l,loggerOptions:(null===l||void 0===l?void 0:l.loggerOptions)||b},S={application:{appName:n.gT.EMPTY_STRING,appVersion:n.gT.EMPTY_STRING},client:new f};if((null===r||void 0===r?void 0:r.protocolMode)!==a.A.OIDC&&null!==r&&void 0!==r&&r.OIDCOptions){new o.Y(k.loggerOptions).warning(JSON.stringify((0,p.ei)(g.qz)))}if(null!==r&&void 0!==r&&r.protocolMode&&r.protocolMode!==a.A.AAD&&null!==k&&void 0!==k&&k.allowNativeBroker)throw(0,p.ei)(g.Ol);return{auth:{...d,...r,OIDCOptions:{...d.OIDCOptions,...null===r||void 0===r?void 0:r.OIDCOptions}},cache:{...y,...c},system:k,telemetry:{...S,...h}}}},828:(e,t,r)=>{"use strict";r.r(t),r.d(t,{StandardController:()=>it});var n=r(5548),a=r(290),i=r(8339);var o=r(7438),s=r(2200),c=r(825),l=r(2738),u=r(9050),h=r(9269),d=r(6378);class f{constructor(){this.expiresAt=d.I.nowSeconds()+c.QU.REFRESH_TIME_SECONDS}updateCloudDiscoveryMetadata(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t}updateEndpointMetadata(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t,this.jwks_uri=e.jwks_uri}updateCanonicalAuthority(e){this.canonical_authority=e}resetExpiresAt(){this.expiresAt=d.I.nowSeconds()+c.QU.REFRESH_TIME_SECONDS}isExpired(){return this.expiresAt<=d.I.nowSeconds()}static isAuthorityMetadataEntity(e,t){return!!t&&(0===e.indexOf(c.QU.CACHE_KEY)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri"))}}var p=r(9686);var g=r(2346);const m=(e,t,r,n,a)=>function(){r.trace("Executing function ".concat(t));const i=null===n||void 0===n?void 0:n.startMeasurement(t,a);try{const n=e(...arguments);return null===i||void 0===i||i.end({success:!0}),r.trace("Returning result from ".concat(t)),n}catch(o){r.trace("Error occurred in ".concat(t));try{r.trace(JSON.stringify(o))}catch(o){r.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1}),o}},v=(e,t,r,n,a)=>function(){r.trace("Executing function ".concat(t));const i=null===n||void 0===n?void 0:n.startMeasurement(t,a);return null===n||void 0===n||n.setPreQueueTime(t,a),e(...arguments).then((e=>(r.trace("Returning result from ".concat(t)),null===i||void 0===i||i.end({success:!0}),e))).catch((e=>{r.trace("Error occurred in ".concat(t));try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw null===i||void 0===i||i.end({success:!1}),e}))};class y{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){var r;null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)t.region_source=c.W.ENVIRONMENT_VARIABLE;else{const e=y.IMDS_OPTIONS;try{const r=await v(this.getRegionFromIMDS.bind(this),g.Ak.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(c.gT.IMDS_VERSION,e);if(r.status===c.YY.httpSuccess&&(n=r.body,t.region_source=c.W.IMDS),r.status===c.YY.httpBadRequest){const r=await v(this.getCurrentVersion.bind(this),g.Ak.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(e);if(!r)return t.region_source=c.W.FAILED_AUTO_DETECTION,null;const a=await v(this.getRegionFromIMDS.bind(this),g.Ak.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(r,e);a.status===c.YY.httpSuccess&&(n=a.body,t.region_source=c.W.IMDS)}}catch(a){return t.region_source=c.W.FAILED_AUTO_DETECTION,null}}return n||(t.region_source=c.W.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,t){var r;return null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync("".concat(c.gT.IMDS_ENDPOINT,"?api-version=").concat(e,"&format=text"),t,c.gT.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync("".concat(c.gT.IMDS_ENDPOINT,"?format=json"),e);return t.status===c.YY.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(r){return null}}}y.IMDS_OPTIONS={headers:{Metadata:"true"}};var b=r(4430),T=r(3932),w=r(4734);class _{constructor(e,t,r,n,a,i,o){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=a,this.performanceClient=i,this.correlationId=o,this.regionDiscovery=new y(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(c.gT.CIAM_AUTH_URL))return i.a.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case c.gT.ADFS:return i.a.Adfs;case c.gT.DSTS:return i.a.Dsts}return i.a.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new o.G(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw(0,s.zP)(T.HO)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw(0,s.zP)(T.HO)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw(0,s.zP)(T.HO)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw(0,s.zP)(T.ig);return this.replacePath(this.metadata.end_session_endpoint)}throw(0,s.zP)(T.HO)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw(0,s.zP)(T.HO)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw(0,s.zP)(T.HO)}canReplaceTenant(e){return 1===e.PathSegments.length&&!_.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===i.a.Default&&this.protocolMode===h.A.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const r=new o.G(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(((e,a)=>{let i=n[a];if(0===a&&this.canReplaceTenant(r)){const e=new o.G(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose("Replacing tenant domain name ".concat(i," with id ").concat(e)),i=e)}e!==i&&(t=t.replace("/".concat(i,"/"),"/".concat(e,"/")))})),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===i.a.Adfs||this.protocolMode!==h.A.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?"".concat(this.canonicalAuthority,".well-known/openid-configuration"):"".concat(this.canonicalAuthority,"v2.0/.well-known/openid-configuration")}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(g.Ak.AuthorityResolveEndpointsAsync,this.correlationId);const t=this.getCurrentMetadataEntity(),r=await v(this.updateCloudDiscoveryMetadata.bind(this),g.Ak.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(t);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,t.preferred_network);const n=await v(this.updateEndpointMetadata.bind(this),g.Ak.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(t);this.updateCachedMetadata(t,r,{source:n})}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e=new f,e.updateCanonicalAuthority(this.canonicalAuthority)),e}updateCachedMetadata(e,t,r){t!==c.pQ.CACHE&&(null===r||void 0===r?void 0:r.source)!==c.pQ.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority));const n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.AuthorityUpdateEndpointMetadata,this.correlationId);const r=this.updateEndpointMetadataFromLocalSources(e);if(r){var n;if(r.source===c.pQ.HARDCODED_VALUES)if(null!==(n=this.authorityOptions.azureRegionConfiguration)&&void 0!==n&&n.azureRegion&&r.metadata){const t=await v(this.updateMetadataWithRegionalInformation.bind(this),g.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r.metadata);e.updateEndpointMetadata(t,!1)}return r.source}let a=await v(this.getEndpointMetadataFromNetwork.bind(this),g.Ak.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();var i;if(a)return null!==(i=this.authorityOptions.azureRegionConfiguration)&&void 0!==i&&i.azureRegion&&(a=await v(this.updateMetadataWithRegionalInformation.bind(this),g.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(a)),e.updateEndpointMetadata(a,!0),c.pQ.NETWORK;throw(0,s.zP)(T.Ce,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),e.updateEndpointMetadata(t,!1),{source:c.pQ.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return e.updateEndpointMetadata(t,!1),{source:c.pQ.HARDCODED_VALUES,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=e.isExpired();return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:c.pQ.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new o.G(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw(0,u.ei)(w.zx)}return null}async getEndpointMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(g.Ak.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const t={},r=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose("Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ".concat(r));try{const e=await this.networkInterface.sendGetRequestAsync(r,t),n=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(e.body);return n?e.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: ".concat(n)),null}}getEndpointMetadataFromHardcodedValues(){return this.canonicalAuthority in l.Qh?l.Qh[this.canonicalAuthority]:null}async updateMetadataWithRegionalInformation(e){var t,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const n=null===(r=this.authorityOptions.azureRegionConfiguration)||void 0===r?void 0:r.azureRegion;if(n){var a;if(n!==c.gT.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=c.ki.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=n,_.replaceWithRegionalInformation(e,n);const t=await v(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),g.Ak.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(null===(a=this.authorityOptions.azureRegionConfiguration)||void 0===a?void 0:a.environmentRegion,this.regionDiscoveryMetadata);if(t)return this.regionDiscoveryMetadata.region_outcome=c.ki.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=t,_.replaceWithRegionalInformation(e,t);this.regionDiscoveryMetadata.region_outcome=c.ki.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const r=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(r)return r;const n=await v(this.getCloudDiscoveryMetadataFromNetwork.bind(this),g.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return e.updateCloudDiscoveryMetadata(n,!0),c.pQ.NETWORK;throw(0,u.ei)(w.o_)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii("Known Authorities: ".concat(this.authorityOptions.knownAuthorities||c.gT.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: ".concat(this.authorityOptions.authorityMetadata||c.gT.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: ".concat(e.canonical_authority||c.gT.NOT_APPLICABLE));const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),e.updateCloudDiscoveryMetadata(t,!1),c.pQ.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(0,l.ix)(this.hostnameAndPort);if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),e.updateCloudDiscoveryMetadata(t,!1),c.pQ.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const r=e.isExpired();return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),c.pQ.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===i.a.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),_.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=(0,l.eM)(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),(0,u.ei)(w.E)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),_.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var e;null===(e=this.performanceClient)||void 0===e||e.addQueueMeasurement(g.Ak.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const t="".concat(c.gT.AAD_INSTANCE_DISCOVERY_ENDPT).concat(this.canonicalAuthority,"oauth2/v2.0/authorize"),r={};let n=null;try{const e=await this.networkInterface.sendGetRequestAsync(t,r);let a,i;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(e.body))a=e.body,i=a.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: ".concat(a.tenant_discovery_endpoint));else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(e.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ".concat(e.status)),a=e.body,a.error===c.gT.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is ".concat(a.error)),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is ".concat(a.error_description)),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=(0,l.eM)(i,this.hostnameAndPort)}catch(a){if(a instanceof b.l4)this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: ".concat(a.errorCode,"\nError Description: ").concat(a.errorMessage));else{const e=a;this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ".concat(e.name,"\nError Description: ").concat(e.message))}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=_.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter((e=>o.G.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort)).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==p.z.None){const e=t.tenant?t.tenant:c.gT.DEFAULT_COMMON_TENANT;r="".concat(t.azureCloudInstance,"/").concat(e,"/")}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw(0,s.zP)(T.HO)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return l.wn.has(e)}static isPublicCloudAuthority(e){return c.gT.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const n=new o.G(e);n.validateAsUri();const a=n.getUrlComponents();let i="".concat(t,".").concat(a.HostNameAndPort);this.isPublicCloudAuthority(a.HostNameAndPort)&&(i="".concat(t,".").concat(c.gT.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX));const s=o.G.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:i}).urlString;return r?"".concat(s,"?").concat(r):s}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=_.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=_.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=_.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const r=new o.G(e).getUrlComponents();if(0===r.PathSegments.length&&r.HostNameAndPort.endsWith(c.gT.CIAM_AUTH_URL)){const e=r.HostNameAndPort.split(".")[0];t="".concat(t).concat(e).concat(c.gT.AAD_TENANT_DOMAIN_SUFFIX)}return t}}function E(e){return e.endsWith(c.gT.FORWARD_SLASH)?e:"".concat(e).concat(c.gT.FORWARD_SLASH)}_.reservedTenantDomains=new Set(["{tenant}","{tenantid}",c.Nb.COMMON,c.Nb.CONSUMERS,c.Nb.ORGANIZATIONS]);var C=r(7561),k=r(6274),S=r(8970),A=r(3362),I=r(9358);class R{generateAppMetadataKey(){return R.generateAppMetadataCacheKey(this.environment,this.clientId)}static generateAppMetadataCacheKey(e,t){return[c.dg,e,t].join(c.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAppMetadataEntity(e,t,r){const n=new R;return n.clientId=e,n.environment=t,r&&(n.familyId=r),n}static isAppMetadataEntity(e,t){return!!t&&(0===e.indexOf(c.dg)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))}}class O{static isThrottlingEntity(e,t){let r=!1;e&&(r=0===e.indexOf(c.bb.THROTTLING_PREFIX));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}}var N=r(8051);class x{static setRequestState(e,t,r){const n=x.generateLibraryState(e,r);return t?"".concat(n).concat(c.gT.RESOURCE_DELIM).concat(t):n}static generateLibraryState(e,t){if(!e)throw(0,s.zP)(T.QL);const r={id:e.createNewGuid()};t&&(r.meta=t);const n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw(0,s.zP)(T.QL);if(!t)throw(0,s.zP)(T.r8);try{const r=t.split(c.gT.RESOURCE_DELIM),n=r[0],a=r.length>1?r.slice(1).join(c.gT.RESOURCE_DELIM):c.gT.EMPTY_STRING,i=e.base64Decode(n),o=JSON.parse(i);return{userRequestState:a||c.gT.EMPTY_STRING,libraryState:o}}catch(r){throw(0,s.zP)(T.r8)}}}const P="home_account_id",M="UPN";var L=r(7232);class D{constructor(e,t,r,n,a){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=a||null}}var F=r(8254),U=r(4190),H=r(2838),B=r(4777);class j{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==U.Ix.LocalStorage&&e!==U.Ix.SessionStorage||!window[e])throw(0,H.Z1)(B.m4)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,t){this.windowStorage.setItem(e,t)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}}var z=r(2300);function q(e,t){if(!t)return null;try{return x.parseRequestState(e,t).libraryState.meta}catch(r){throw(0,s.zP)(T.r8)}}var K=r(5142),G=r(5315),V=r(4394);class W extends A.L{constructor(e,t,r,n,a){super(e,r,n,a),this.COOKIE_LIFE_MULTIPLIER=864e5,this.cacheConfig=t,this.logger=n,this.internalStorage=new z.k,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps())}setupBrowserStorage(e){switch(e){case U.Ix.LocalStorage:case U.Ix.SessionStorage:try{return new j(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=U.Ix.MemoryStorage,new z.k}setupTemporaryCacheStorage(e,t){switch(t){case U.Ix.LocalStorage:case U.Ix.SessionStorage:try{return new j(e||U.Ix.SessionStorage)}catch(r){return this.logger.verbose(r),this.internalStorage}case U.Ix.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){const e="".concat(c.gT.CACHE_PREFIX,".").concat(c.Vi.ID_TOKEN),t="".concat(c.gT.CACHE_PREFIX,".").concat(c.Vi.CLIENT_INFO),r="".concat(c.gT.CACHE_PREFIX,".").concat(c.Vi.ERROR),n="".concat(c.gT.CACHE_PREFIX,".").concat(c.Vi.ERROR_DESC),a=[this.browserStorage.getItem(e),this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n)];[c.Vi.ID_TOKEN,c.Vi.CLIENT_INFO,c.Vi.ERROR,c.Vi.ERROR_DESC].forEach(((e,t)=>this.migrateCacheEntry(e,a[t])))}migrateCacheEntry(e,t){t&&this.setTemporaryCache(e,t,!0)}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(U.Oq.ACCOUNT_KEYS),t=this.getItem("".concat(U.Oq.TOKEN_KEYS,".").concat(this.clientId));if(e&&t)return void this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");this.browserStorage.getKeys().forEach((e=>{if(this.isCredentialKey(e)){const t=this.getItem(e);if(t){const r=this.validateAndParseJson(t);if(r&&r.hasOwnProperty("credentialType"))switch(r.credentialType){case c.d3.ID_TOKEN:if(I.Bq(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: ".concat(e," found, saving key to token key map"));const t=r,n=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(n,c.d3.ID_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: ".concat(e));break;case c.d3.ACCESS_TOKEN:case c.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(I.Om(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: ".concat(e," found, saving key to token key map"));const t=r,n=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(n,c.d3.ACCESS_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ".concat(e));break;case c.d3.REFRESH_TOKEN:if(I.x4(r)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: ".concat(e," found, saving key to token key map"));const t=r,n=this.updateCredentialCacheKey(e,t);return void this.addTokenKey(n,c.d3.REFRESH_TOKEN)}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ".concat(e))}}}if(this.isAccountKey(e)){const t=this.getItem(e);if(t){const r=this.validateAndParseJson(t);r&&k.r.isAccountEntity(r)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: ".concat(e," found, saving key to account key map")),this.addAccountKeyToMap(e))}}}))}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");const t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return r&&k.r.isAccountEntity(r)?A.L.toObject(new k.r,r):(this.removeAccountKeyFromMap(e),null)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(U.Oq.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: ".concat(e));const t=this.getAccountKeys();-1===t.indexOf(e)?(t.push(e),this.setItem(U.Oq.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: ".concat(e));const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(U.Oq.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,c.d3.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,c.d3.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,c.d3.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem("".concat(U.Oq.TOKEN_KEYS,".").concat(this.clientId));if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case c.d3.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case c.d3.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case c.d3.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ".concat(t)),(0,s.zP)(T.cy)}this.setItem("".concat(U.Oq.TOKEN_KEYS,".").concat(this.clientId),JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case c.d3.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ".concat(e," from map"));const n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case c.d3.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ".concat(e," from map"));const a=r.accessToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case c.d3.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ".concat(e," from map"));const i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ".concat(t)),(0,s.zP)(T.cy)}this.setItem("".concat(U.Oq.TOKEN_KEYS,".").concat(this.clientId),JSON.stringify(r))}getIdTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,c.d3.ID_TOKEN),null;const r=this.validateAndParseJson(t);return r&&I.Bq(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,c.d3.ID_TOKEN),null)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const t=I.Mk(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,c.d3.ID_TOKEN)}getAccessTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,c.d3.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return r&&I.Om(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,c.d3.ACCESS_TOKEN),null)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const t=I.Mk(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,c.d3.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,c.d3.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return r&&I.x4(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,c.d3.REFRESH_TOKEN),null)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const t=I.Mk(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,c.d3.REFRESH_TOKEN)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&R.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),A.L.toObject(new R,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&I.Js(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&f.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),A.L.toObject(new f,r)):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter((e=>this.isAuthorityMetadata(e)))}setWrapperMetadata(e,t){this.internalStorage.setItem(U.Bs.WRAPPER_SKU,e),this.internalStorage.setItem(U.Bs.WRAPPER_VER,t)}getWrapperMetadata(){return[this.internalStorage.getItem(U.Bs.WRAPPER_SKU)||c.gT.EMPTY_STRING,this.internalStorage.getItem(U.Bs.WRAPPER_VER)||c.gT.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(c.Vi.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const e=this.generateCacheKey(c.Vi.ACTIVE_ACCOUNT),t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const r=this.getAccountInfoFilteredBy({localAccountId:t});return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(r),r):null}const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(c.Vi.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(c.Vi.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const n={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId};this.browserStorage.setItem(t,JSON.stringify(n)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&O.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),A.L.toObject(new O,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.getItemCookie(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===U.Ix.LocalStorage){const e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){const n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))}removeItem(e){this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}containsKey(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)}getKeys(){return[...this.browserStorage.getKeys(),...this.temporaryCacheStorage.getKeys()]}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.getKeys().forEach((e=>{!this.browserStorage.containsKey(e)&&!this.temporaryCacheStorage.containsKey(e)||-1===e.indexOf(c.gT.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeItem(e)})),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e){e.addQueueMeasurement(g.Ak.ClearTokensAndKeysWithClaims);const t=this.getTokenKeys(),r=[];t.accessToken.forEach((e=>{const t=this.getAccessTokenCredential(e);null!==t&&void 0!==t&&t.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&r.push(this.removeAccessToken(e))})),await Promise.all(r),r.length>0&&this.logger.warning("".concat(r.length," access tokens with claims in the cache keys have been removed from the cache."))}setItemCookie(e,t,r){let n="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";path=/;SameSite=Lax;");if(r){const e=this.getCookieExpirationTime(r);n+="expires=".concat(e,";")}this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n}getItemCookie(e){const t="".concat(encodeURIComponent(e),"="),r=document.cookie.split(";");for(let n=0;n<r.length;n++){let e=r[n];for(;" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(t))return decodeURIComponent(e.substring(t.length,e.length))}return c.gT.EMPTY_STRING}clearMsalCookies(){const e="".concat(c.gT.CACHE_PREFIX,".").concat(this.clientId);document.cookie.split(";").forEach((t=>{for(;" "===t.charAt(0);)t=t.substring(1);if(0===t.indexOf(e)){const e=t.split("=")[0];this.clearItemCookie(e)}}))}clearItemCookie(e){this.setItemCookie(e,c.gT.EMPTY_STRING,-1)}getCookieExpirationTime(e){const t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}getCache(){return this.browserStorage}setCache(){}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):N.x.startsWith(e,c.gT.CACHE_PREFIX)||N.x.startsWith(e,c.Vi.ADAL_ID_TOKEN)?e:"".concat(c.gT.CACHE_PREFIX,".").concat(this.clientId,".").concat(e)}generateAuthorityKey(e){const{libraryState:{id:t}}=x.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(U.c4.AUTHORITY,".").concat(t))}generateNonceKey(e){const{libraryState:{id:t}}=x.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(U.c4.NONCE_IDTOKEN,".").concat(t))}generateStateKey(e){const{libraryState:{id:t}}=x.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey("".concat(U.c4.REQUEST_STATE,".").concat(t))}getCachedAuthority(e){const t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;const n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)}updateCacheEntries(e,t,r,n,a){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);const o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1);const s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),a){const e={credential:a.homeAccountId,type:P};this.setTemporaryCache(U.c4.CCS_CREDENTIAL,JSON.stringify(e),!0)}else if(n){const e={credential:n,type:M};this.setTemporaryCache(U.c4.CCS_CREDENTIAL,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.getKeys().forEach((t=>{-1!==t.indexOf(e)&&this.removeItem(t)})),this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(U.c4.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(U.c4.ORIGIN_URI)),this.removeItem(this.generateCacheKey(U.c4.URL_HASH)),this.removeItem(this.generateCacheKey(U.c4.CORRELATION_ID)),this.removeItem(this.generateCacheKey(U.c4.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(U.c4.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ".concat(r)),this.resetRequestCache(r||c.gT.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((t=>{if(-1===t.indexOf(U.c4.REQUEST_STATE))return;const r=this.temporaryCacheStorage.getItem(t);if(!r)return;const n=q(this.cryptoImpl,r);n&&n.interactionType===e&&(this.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ".concat(r)),this.resetRequestCache(r))})),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=(0,G.h$)(JSON.stringify(e));this.setTemporaryCache(U.c4.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(U.c4.REQUEST_PARAMS,!0);if(!t)throw(0,F.Z_)(V.QO);let r;try{r=JSON.parse((0,K.t)(t))}catch(n){throw this.logger.errorPii("Attempted to parse: ".concat(t)),this.logger.error("Parsing cached token request threw with error: ".concat(n)),(0,F.Z_)(V.e$)}if(this.removeItem(this.generateCacheKey(U.c4.REQUEST_PARAMS)),!r.authority){const t=this.generateAuthorityKey(e),n=this.getTemporaryCache(t);if(!n)throw(0,F.Z_)(V.dT);r.authority=n}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(U.c4.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e="".concat(c.gT.CACHE_PREFIX,".").concat(U.c4.INTERACTION_STATUS_KEY);return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t="".concat(c.gT.CACHE_PREFIX,".").concat(U.c4.INTERACTION_STATUS_KEY);if(e){if(this.getInteractionInProgress())throw(0,F.Z_)(V.Ck);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(c.Vi.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(c.Vi.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(c.Vi.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(c.Vi.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const r=t||e;if(r){const e=L.Z_(r,K.t);if(e.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),e.preferred_username;if(e.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),e.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){const r=I.Mk(t);if(e!==r){const n=this.getItem(e);if(n)return this.removeItem(e),this.setItem(r,n),this.logger.verbose("Updated an outdated ".concat(t.credentialType," cache key")),r;this.logger.error("Attempted to update an outdated ".concat(t.credentialType," cache key but no item matching the outdated key was found in storage"))}return e}getRedirectRequestContext(){return this.getTemporaryCache(U.c4.REDIRECT_CONTEXT,!0)}setRedirectRequestContext(e){this.setTemporaryCache(U.c4.REDIRECT_CONTEXT,e,!0)}async hydrateCache(e,t){var r,n,a,i,o;const s=I.Md(null===(r=e.account)||void 0===r?void 0:r.homeAccountId,null===(n=e.account)||void 0===n?void 0:n.environment,e.idToken,this.clientId,e.tenantId);let c;t.claims&&(c=await this.cryptoImpl.hashString(t.claims));const l=I.Ds(null===(a=e.account)||void 0===a?void 0:a.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),(null===(i=e.expiresOn)||void 0===i?void 0:i.getTime())||0,(null===(o=e.extExpiresOn)||void 0===o?void 0:o.getTime())||0,K.t,void 0,e.tokenType,void 0,t.sshKid,t.claims,c),u=new D(void 0,s,l);return this.saveCacheRecord(u)}}function Y(){return window.parent!==window}function $(){return window.location.href.split("?")[0].split("#")[0]}function Q(){if(o.G.hashContainsKnownProperties(window.location.hash)&&Y())throw(0,F.Z_)(V.xO)}function J(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf("".concat(U.qx.POPUP_NAME_PREFIX,".")))throw(0,F.Z_)(V.bj)}function X(e){if(!e)throw(0,F.Z_)(V.al)}function Z(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout((()=>{try{document.head.removeChild(t)}catch{}}),1e4)}var ee=r(3057),te=r(4270),re=r(9632);class ne{static generateThrottlingStorageKey(e){return"".concat(c.bb.THROTTLING_PREFIX,".").concat(JSON.stringify(e))}static preProcess(e,t){const r=ne.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){var a;if(n.throttleTime<Date.now())return void e.removeItem(r);throw new re.n((null===(a=n.errorCodes)||void 0===a?void 0:a.join(" "))||c.gT.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,t,r){if(ne.checkResponseStatus(r)||ne.checkResponseForRetryAfter(r)){const n={throttleTime:ne.calculateThrottleTime(parseInt(r.headers[c.SZ.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(ne.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(c.SZ.RETRY_AFTER)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||c.bb.DEFAULT_THROTTLE_TIME_SECONDS),r+c.bb.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(e,t,r,n){const a={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(a);e.removeItem(i)}}var ae=r(7906);class ie{constructor(e,t){this.networkClient=e,this.cacheManager=t}async sendPostRequest(e,t,r){let n;ne.preProcess(this.cacheManager,e);try{n=await this.networkClient.sendPostRequestAsync(t,r)}catch(a){throw a instanceof b.l4?a:(0,s.zP)(T.EF)}return ne.postProcess(this.cacheManager,e,n),n}}var oe=r(9684),se=r(1556),ce=r(5808),le=r(4096);class ue{static validateRedirectUri(e){if(!e)throw(0,u.ei)(w.RV)}static validatePrompt(e){const t=[];for(const r in c.NJ)t.push(c.NJ[r]);if(t.indexOf(e)<0)throw(0,u.ei)(w.z_)}static validateClaims(e){try{JSON.parse(e)}catch(t){throw(0,u.ei)(w.nm)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw(0,u.ei)(w.TU);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([c.VX.PLAIN,c.VX.S256].indexOf(e)<0)throw(0,u.ei)(w.d6)}static sanitizeEQParams(e,t){return e?(t.forEach(((t,r)=>{e[r]&&delete e[r]})),Object.fromEntries(Object.entries(e).filter((e=>""!==e[1])))):{}}}class he{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(c.Fo.RESPONSE_TYPE,encodeURIComponent(c.gT.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(c.Fo.RESPONSE_TYPE,encodeURIComponent("".concat(c.gT.TOKEN_RESPONSE_TYPE," ").concat(c.gT.ID_TOKEN_RESPONSE_TYPE)))}addResponseMode(e){this.parameters.set(c.Fo.RESPONSE_MODE,encodeURIComponent(e||c.vw.QUERY))}addNativeBroker(){this.parameters.set(c.Fo.NATIVE_BROKER,encodeURIComponent("1"))}addScopes(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.f_;!t||r.includes("openid")||e.includes("openid")||r.push("openid");const n=t?[...e||[],...r]:e||[],a=new le.i(n);this.parameters.set(c.Fo.SCOPE,encodeURIComponent(a.printScopes()))}addClientId(e){this.parameters.set(c.Fo.CLIENT_ID,encodeURIComponent(e))}addRedirectUri(e){ue.validateRedirectUri(e),this.parameters.set(c.Fo.REDIRECT_URI,encodeURIComponent(e))}addPostLogoutRedirectUri(e){ue.validateRedirectUri(e),this.parameters.set(c.Fo.POST_LOGOUT_URI,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(c.Fo.ID_TOKEN_HINT,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(c.VO.DOMAIN_HINT,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(c.VO.LOGIN_HINT,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(c.SZ.CCS_HEADER,encodeURIComponent("UPN:".concat(e)))}addCcsOid(e){this.parameters.set(c.SZ.CCS_HEADER,encodeURIComponent("Oid:".concat(e.uid,"@").concat(e.utid)))}addSid(e){this.parameters.set(c.VO.SID,encodeURIComponent(e))}addClaims(e,t){const r=this.addClientCapabilitiesToClaims(e,t);ue.validateClaims(r),this.parameters.set(c.Fo.CLAIMS,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(c.Fo.CLIENT_REQUEST_ID,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(c.Fo.X_CLIENT_SKU,e.sku),this.parameters.set(c.Fo.X_CLIENT_VER,e.version),e.os&&this.parameters.set(c.Fo.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(c.Fo.X_CLIENT_CPU,e.cpu)}addApplicationTelemetry(e){null!==e&&void 0!==e&&e.appName&&this.parameters.set(c.Fo.X_APP_NAME,e.appName),null!==e&&void 0!==e&&e.appVersion&&this.parameters.set(c.Fo.X_APP_VER,e.appVersion)}addPrompt(e){ue.validatePrompt(e),this.parameters.set("".concat(c.Fo.PROMPT),encodeURIComponent(e))}addState(e){e&&this.parameters.set(c.Fo.STATE,encodeURIComponent(e))}addNonce(e){this.parameters.set(c.Fo.NONCE,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(ue.validateCodeChallengeParams(e,t),!e||!t)throw(0,u.ei)(w.TU);this.parameters.set(c.Fo.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(c.Fo.CODE_CHALLENGE_METHOD,encodeURIComponent(t))}addAuthorizationCode(e){this.parameters.set(c.Fo.CODE,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(c.Fo.DEVICE_CODE,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(c.Fo.REFRESH_TOKEN,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(c.Fo.CODE_VERIFIER,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(c.Fo.CLIENT_SECRET,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(c.Fo.CLIENT_ASSERTION,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(c.Fo.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(c.Fo.OBO_ASSERTION,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(c.Fo.REQUESTED_TOKEN_USE,encodeURIComponent(e))}addGrantType(e){this.parameters.set(c.Fo.GRANT_TYPE,encodeURIComponent(e))}addClientInfo(){this.parameters.set(c.sR,"1")}addExtraQueryParameters(e){const t=ue.sanitizeEQParams(e,this.parameters);Object.keys(t).forEach((t=>{this.parameters.set(t,e[t])}))}addClientCapabilitiesToClaims(e,t){let r;if(e)try{r=JSON.parse(e)}catch(n){throw(0,u.ei)(w.nm)}else r={};return t&&t.length>0&&(r.hasOwnProperty(c.As.ACCESS_TOKEN)||(r[c.As.ACCESS_TOKEN]={}),r[c.As.ACCESS_TOKEN][c.As.XMS_CC]={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set(c.Ge.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(c.Ge.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(c.Fo.TOKEN_TYPE,c.hO.POP),this.parameters.set(c.Fo.REQ_CNF,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(c.Fo.TOKEN_TYPE,c.hO.SSH),this.parameters.set(c.Fo.REQ_CNF,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(c.Fo.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(c.Fo.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(c.Fo.X_MS_LIB_CAPABILITY,c.bb.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(c.Fo.LOGOUT_HINT,encodeURIComponent(e))}createQueryString(){const e=new Array;return this.parameters.forEach(((t,r)=>{e.push("".concat(r,"=").concat(t))})),e.join("&")}}class de{static async createDiscoveredInstance(e,t,r,n,a,i,o){null===i||void 0===i||i.addQueueMeasurement(g.Ak.AuthorityFactoryCreateDiscoveredInstance,o);const c=_.transformCIAMAuthority(E(e)),l=de.createInstance(c,t,r,n,a,i,o);try{return await v(l.resolveEndpointsAsync.bind(l),g.Ak.AuthorityResolveEndpointsAsync,a,i,o)(),l}catch(u){throw(0,s.zP)(T.HO)}}static createInstance(e,t,r,n,a,i,o){if(!e)throw(0,u.ei)(w.To);return new _(e,t,r,n,a,i,o)}}class fe{constructor(e,t){this.config=(0,ae.j6)(e),this.logger=new oe.Y(this.config.loggerOptions,se.u,se.i),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new ie(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[c.SZ.CONTENT_TYPE]=c.gT.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case P:try{const r=(0,ce.j)(e.credential);t[c.SZ.CCS_HEADER]="Oid:".concat(r.uid,"@").concat(r.utid)}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case M:t[c.SZ.CCS_HEADER]="UPN: ".concat(e.credential)}return t}async executePostToTokenEndpoint(e,t,r,n,a,i){var o,s,l,u;i&&(null===(u=this.performanceClient)||void 0===u||u.addQueueMeasurement(i,a));const h=await this.networkManager.sendPostRequest(n,e,{body:t,headers:r});return null===(o=this.performanceClient)||void 0===o||o.addFields({refreshTokenSize:(null===(s=h.body.refresh_token)||void 0===s?void 0:s.length)||0,httpVerToken:(null===(l=h.headers)||void 0===l?void 0:l[c.SZ.X_MS_HTTP_VERSION])||""},a),this.config.serverTelemetryManager&&h.status<500&&429!==h.status&&this.config.serverTelemetryManager.clearTelemetryCache(),h}async updateAuthority(e,t){var r;null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.UpdateTokenEndpointAuthority,t);const n="https://".concat(e,"/").concat(this.authority.tenant,"/"),a=await de.createDiscoveredInstance(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,this.performanceClient,t);this.authority=a}createTokenQueryParameters(e){const t=new he;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}}const pe="sw";class ge{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var r;null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.PopTokenGenerateCnf,e.correlationId);const n=await v(this.generateKid.bind(this),g.Ak.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),a=this.cryptoUtils.base64Encode(JSON.stringify(n));return{kid:n.kid,reqCnfString:a,reqCnfHash:await this.cryptoUtils.hashString(a)}}async generateKid(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.PopTokenGenerateKid,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:pe}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){const{resourceRequestMethod:a,resourceRequestUri:i,shrClaims:s,shrNonce:c,shrOptions:l}=r,u=i?new o.G(i):void 0,h=null===u||void 0===u?void 0:u.getUrlComponents();return await this.cryptoUtils.signJwt({at:e,ts:d.I.nowSeconds(),m:null===a||void 0===a?void 0:a.toUpperCase(),u:null===h||void 0===h?void 0:h.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:null===h||void 0===h?void 0:h.AbsolutePath,q:null!==h&&void 0!==h&&h.QueryString?[[],h.QueryString]:void 0,client_claims:s||void 0,...n},t,l,r.correlationId)}}class me{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class ve{constructor(e,t,r,n,a,i,o){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=a,this.persistencePlugin=i,this.performanceClient=o}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?(0,s.zP)(T.LV,"Cached State"):(0,s.zP)(T.LV,"Server State");let r,n;try{r=decodeURIComponent(e.state)}catch(a){throw(0,s.zP)(T.r8,e.state)}try{n=decodeURIComponent(t)}catch(a){throw(0,s.zP)(T.r8,e.state)}if(r!==n)throw(0,s.zP)(T.Tu);if(e.error||e.error_description||e.suberror){if((0,C.Cf)(e.error,e.error_description,e.suberror))throw new C.Yo(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"");throw new re.n(e.error||"",e.error_description,e.suberror)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const r="".concat(e.error_codes," - [").concat(e.timestamp,"]: ").concat(e.error_description," - Correlation ID: ").concat(e.correlation_id," - Trace ID: ").concat(e.trace_id),n=new re.n(e.error,r,e.suberror);if(t&&e.status&&e.status>=c.oj.SERVER_ERROR_RANGE_START&&e.status<=c.oj.SERVER_ERROR_RANGE_END)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n".concat(n));if(t&&e.status&&e.status>=c.oj.CLIENT_ERROR_RANGE_START&&e.status<=c.oj.CLIENT_ERROR_RANGE_END)return void this.logger.warning("executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n".concat(n));if((0,C.Cf)(e.error,e.error_description,e.suberror))throw new C.Yo(e.error,e.error_description,e.suberror,e.timestamp||c.gT.EMPTY_STRING,e.trace_id||c.gT.EMPTY_STRING,e.correlation_id||c.gT.EMPTY_STRING,e.claims||c.gT.EMPTY_STRING);throw n}}async handleServerTokenResponse(e,t,r,n,a,i,o,l,u){var h;let d,f;if(null===(h=this.performanceClient)||void 0===h||h.addQueueMeasurement(g.Ak.HandleServerTokenResponse,e.correlation_id),e.id_token){if(d=(0,L.Z_)(e.id_token||c.gT.EMPTY_STRING,this.cryptoObj.base64Decode),a&&a.nonce&&d.nonce!==a.nonce)throw(0,s.zP)(T.vR);if(n.maxAge||0===n.maxAge){const e=d.auth_time;if(!e)throw(0,s.zP)(T.w7);(0,L.ky)(e,n.maxAge)}}this.homeAccountIdentifier=k.r.generateHomeAccountId(e.client_info||c.gT.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,d),a&&a.state&&(f=x.parseRequestState(this.cryptoObj,a.state)),e.key_id=e.key_id||n.sshKid||void 0;const p=this.generateCacheRecord(e,t,r,n,d,i,a);let m;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),m=new me(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(m)),o&&!l&&p.account){const e=p.account.generateAccountKey();if(!this.cacheStorage.getAccount(e))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),ve.generateAuthenticationResult(this.cryptoObj,t,p,!1,n,d,f,void 0,u)}await this.cacheStorage.saveCacheRecord(p,n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&m&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(m))}return ve.generateAuthenticationResult(this.cryptoObj,t,p,!1,n,d,f,e,u)}generateCacheRecord(e,t,r,n,a,i,o){const c=t.getPreferredCache();if(!c)throw(0,s.zP)(T.Q9);let l,u;e.id_token&&a&&(l=(0,I.Md)(this.homeAccountIdentifier,c,e.id_token,this.clientId,a.tid||""),u=k.r.createAccount({homeAccountId:this.homeAccountIdentifier,idTokenClaims:a,clientInfo:e.client_info,cloudGraphHostName:null===o||void 0===o?void 0:o.cloud_graph_host_name,msGraphHost:null===o||void 0===o?void 0:o.msgraph_host},t));let h=null;if(e.access_token){const o=e.scope?le.i.fromString(e.scope):new le.i(n.scopes||[]),s=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,d=r+s,f=d+l,p=u&&u>0?r+u:void 0;h=(0,I.Ds)(this.homeAccountIdentifier,c,e.access_token,this.clientId,(null===a||void 0===a?void 0:a.tid)||t.tenant,o.printScopes(),d,f,this.cryptoObj.base64Decode,p,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let d=null;e.refresh_token&&(d=(0,I.OJ)(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,i));let f=null;return e.foci&&(f=R.createAppMetadataEntity(this.clientId,c,e.foci)),new D(u,l,h,d,f)}static async generateAuthenticationResult(e,t,r,n,a,i,o,l,u){var h,d,f,p;let g,m,v=c.gT.EMPTY_STRING,y=[],b=null,w=c.gT.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType===c.hO.POP){const t=new ge(e),{secret:n,keyId:i}=r.accessToken;if(!i)throw(0,s.zP)(T.Of);v=await t.signPopToken(n,i,a)}else v=r.accessToken.secret;y=le.i.fromString(r.accessToken.target).asArray(),b=new Date(1e3*Number(r.accessToken.expiresOn)),g=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),r.accessToken.refreshOn&&(m=new Date(1e3*Number(r.accessToken.refreshOn)))}r.appMetadata&&(w=r.appMetadata.familyId===c.ch?c.ch:"");const _=(null===i||void 0===i?void 0:i.oid)||(null===i||void 0===i?void 0:i.sub)||"",E=(null===i||void 0===i?void 0:i.tid)||"";null!==l&&void 0!==l&&l.spa_accountid&&r.account&&(r.account.nativeAccountId=null===l||void 0===l?void 0:l.spa_accountid);const C=r.account?{...r.account.getAccountInfo(),idTokenClaims:i}:null;return{authority:t.canonicalAuthority,uniqueId:_,tenantId:E,scopes:y,account:C,idToken:(null===r||void 0===r||null===(h=r.idToken)||void 0===h?void 0:h.secret)||"",idTokenClaims:i||{},accessToken:v,fromCache:n,expiresOn:b,extExpiresOn:g,refreshOn:m,correlationId:a.correlationId,requestId:u||c.gT.EMPTY_STRING,familyId:w,tokenType:(null===(d=r.accessToken)||void 0===d?void 0:d.tokenType)||c.gT.EMPTY_STRING,state:o?o.userRequestState:c.gT.EMPTY_STRING,cloudGraphHostName:(null===(f=r.account)||void 0===f?void 0:f.cloudGraphHostName)||c.gT.EMPTY_STRING,msGraphHost:(null===(p=r.account)||void 0===p?void 0:p.msGraphHost)||c.gT.EMPTY_STRING,code:null===l||void 0===l?void 0:l.spa_code,fromNativeBroker:!1}}}class ye extends fe{constructor(e,t){var r;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=null===(r=this.config.authOptions.authority.options.OIDCOptions)||void 0===r?void 0:r.defaultScopes}async getAuthCodeUrl(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.GetAuthCodeUrl,e.correlationId);const r=await v(this.createAuthCodeUrlQueryString.bind(this),g.Ak.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return o.G.appendQueryString(this.authority.authorizationEndpoint,r)}async acquireToken(e,t){var r,n;if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.AuthClientAcquireToken,e.correlationId),!e.code)throw(0,s.zP)(T.FU);const a=d.I.nowSeconds(),i=await v(this.executeTokenRequest.bind(this),g.Ak.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=null===(n=i.headers)||void 0===n?void 0:n[c.SZ.X_MS_REQUEST_ID],l=new ve(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return l.validateTokenResponse(i.body),v(l.handleServerTokenResponse.bind(l),g.Ak.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,a,e,t,void 0,void 0,void 0,o)}handleFragmentResponse(e,t){if(new ve(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw(0,s.zP)(T.Zv);return e}getLogoutUri(e){if(!e)throw(0,u.ei)(w.$h);const t=this.createLogoutUrlQueryString(e);return o.G.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var r,n;null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.AuthClientExecuteTokenRequest,t.correlationId);const a=this.createTokenQueryParameters(t),i=o.G.appendQueryString(e.tokenEndpoint,a),s=await v(this.createTokenRequestBody.bind(this),g.Ak.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let l;if(t.clientInfo)try{const e=(0,ce.B)(t.clientInfo,this.cryptoUtils);l={credential:"".concat(e.uid).concat(c.Bv.CLIENT_INFO_SEPARATOR).concat(e.utid),type:P}}catch(d){this.logger.verbose("Could not parse client info for CCS Header: "+d)}const u=this.createTokenRequestHeaders(l||t.ccsCredential),h={clientId:(null===(n=t.tokenBodyParameters)||void 0===n?void 0:n.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return v(this.executePostToTokenEndpoint.bind(this),g.Ak.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(i,s,u,h,t.correlationId,g.Ak.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var t,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.AuthClientCreateTokenRequestBody,e.correlationId);const n=new he;if(n.addClientId((null===(r=e.tokenBodyParameters)||void 0===r?void 0:r[c.Fo.CLIENT_ID])||this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):ue.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.oidcDefaultScopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!(0,ae.lh)(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const e=this.config.clientCredentials.clientAssertion;n.addClientAssertion(e.assertion),n.addClientAssertionType(e.assertionType)}if(n.addGrantType(c.qJ.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme===c.hO.POP){const t=new ge(this.cryptoUtils,this.performanceClient),r=await v(t.generateCnf.bind(t),g.Ak.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger);n.addPopToken(r.reqCnfString)}else if(e.authenticationScheme===c.hO.SSH){if(!e.sshJwk)throw(0,u.ei)(w.dK);n.addSshJwk(e.sshJwk)}const a=e.correlationId||this.config.cryptoInterface.createNewGuid();let i;if(n.addCorrelationId(a),(!N.x.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=(0,ce.B)(e.clientInfo,this.cryptoUtils);i={credential:"".concat(t.uid).concat(c.Bv.CLIENT_INFO_SEPARATOR).concat(t.utid),type:P}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case P:try{const e=(0,ce.j)(i.credential);n.addCcsOid(e)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case M:n.addCcsUpn(i.credential)}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[c.Fo.RETURN_SPA_CODE]||n.addExtraQueryParameters({[c.Fo.RETURN_SPA_CODE]:"1"}),n.createQueryString()}async createAuthCodeUrlQueryString(e){var t,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.AuthClientCreateQueryString,e.correlationId);const n=new he;n.addClientId((null===(r=e.extraQueryParameters)||void 0===r?void 0:r[c.Fo.CLIENT_ID])||this.config.authOptions.clientId);const a=[...e.scopes||[],...e.extraScopesToConsent||[]];n.addScopes(a,!0,this.oidcDefaultScopes),n.addRedirectUri(e.redirectUri);const i=e.correlationId||this.config.cryptoInterface.createNewGuid();if(n.addCorrelationId(i),n.addResponseMode(e.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),(0,ae.lh)(this.config)||n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&n.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&n.addPrompt(e.prompt),e.domainHint&&n.addDomainHint(e.domainHint),e.prompt!==c.NJ.SELECT_ACCOUNT)if(e.sid&&e.prompt===c.NJ.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(e.sid);else if(e.account){const t=this.extractAccountSid(e.account),r=this.extractLoginHint(e.account);if(r){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(r);try{const t=(0,ce.j)(e.account.homeAccountId);n.addCcsOid(t)}catch(o){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t&&e.prompt===c.NJ.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(t);try{const t=(0,ce.j)(e.account.homeAccountId);n.addCcsOid(t)}catch(o){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(e.account.username);try{const t=(0,ce.j)(e.account.homeAccountId);n.addCcsOid(t)}catch(o){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&n.addNonce(e.nonce),e.state&&n.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker&&(n.addNativeBroker(),e.authenticationScheme===c.hO.POP)){const t=new ge(this.cryptoUtils),r=await v(t.generateCnf.bind(t),g.Ak.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger);n.addPopToken(r.reqCnfHash)}return n.createQueryString()}createLogoutUrlQueryString(e){const t=new he;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()}extractAccountSid(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.sid)||null}extractLoginHint(e){var t;return(null===(t=e.idTokenClaims)||void 0===t?void 0:t.login_hint)||null}}class be{constructor(e,t){this.cacheOutcome=c.To.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||c.gT.EMPTY_STRING,this.wrapperVer=e.wrapperVer||c.gT.EMPTY_STRING,this.telemetryCacheKey=c.HN.CACHE_KEY+c.Bv.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e="".concat(this.apiId).concat(c.HN.VALUE_SEPARATOR).concat(this.cacheOutcome),t=[this.wrapperSKU,this.wrapperVer].join(c.HN.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(c.HN.VALUE_SEPARATOR);return[c.HN.SCHEMA_VERSION,r,t].join(c.HN.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=be.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(c.HN.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(c.HN.VALUE_SEPARATOR),a=e.errors.length,i=[a,t<a?c.HN.OVERFLOW_TRUE:c.HN.OVERFLOW_FALSE].join(c.HN.VALUE_SEPARATOR);return[c.HN.SCHEMA_VERSION,e.cacheHits,r,n,i].join(c.HN.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=c.HN.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof b.l4?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(c.HN.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=be.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{const r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t,r=0,n=0;const a=e.errors.length;for(t=0;t<a;t++){const a=e.failedRequests[2*t]||c.gT.EMPTY_STRING,i=e.failedRequests[2*t+1]||c.gT.EMPTY_STRING,o=e.errors[t]||c.gT.EMPTY_STRING;if(n+=a.toString().length+i.toString().length+o.length+3,!(n<c.HN.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||c.gT.EMPTY_STRING),e.push(this.regionSource||c.gT.EMPTY_STRING),e.push(this.regionOutcome||c.gT.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}}var Te=r(9037),we=r(636);class _e{constructor(e,t,r,n,a,i,o,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=a,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=c||(0,we.nn)(),this.logger=n.clone(U.qx.MSAL_SKU,Te.i,this.correlationId),this.performanceClient=o}async clearCacheOnLogout(e){if(e){k.r.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(k.r.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(t){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(r){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}async initializeBaseRequest(e,t){this.performanceClient.addQueueMeasurement(g.Ak.InitializeBaseRequest,this.correlationId);const r=e.authority||this.config.auth.authority;t&&await this.validateRequestAuthority(r,t);const n=[...e&&e.scopes||[]],a={...e,correlationId:this.correlationId,authority:r,scopes:n};if(a.authenticationScheme){if(a.authenticationScheme===c.hO.SSH){if(!e.sshJwk)throw(0,u.ei)(w.dK);if(!e.sshKid)throw(0,u.ei)(w.hI)}this.logger.verbose('Authentication Scheme set to "'.concat(a.authenticationScheme,'" as configured in Auth request'))}else a.authenticationScheme=c.hO.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return this.config.cache.claimsBasedCachingEnabled&&e.claims&&!N.x.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await this.browserCrypto.hashString(e.claims)),a}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri||$();return o.G.getAbsoluteUrl(t,$())}async validateRequestAuthority(e,t){if(!(await this.getDiscoveredAuthority(e)).isAlias(t.environment))throw(0,u.ei)(w.Hv)}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new be(r,this.browserStorage)}async getDiscoveredAuthority(e){this.logger.verbose("getDiscoveredAuthority called");const t={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata};return e?(this.logger.verbose("Creating discovered authority with request authority"),await de.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t,this.logger)):(this.logger.verbose("Creating discovered authority with configured authority"),await de.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t,this.logger))}}const Ee=32;async function Ce(e,t,r){e.addQueueMeasurement(g.Ak.GeneratePkceCodes,r);const n=m(ke,g.Ak.GenerateCodeVerifier,t,e,r)(e,t,r);return{verifier:n,challenge:await v(Se,g.Ak.GenerateCodeChallengeFromVerifier,t,e,r)(n,e,t,r)}}function ke(e,t,r){try{const n=new Uint8Array(Ee);m(we.PP,g.Ak.GetRandomValues,t,e,r)(n);return(0,G.Wy)(n)}catch(n){throw(0,F.Z_)(V.vD)}}async function Se(e,t,r,n){t.addQueueMeasurement(g.Ak.GenerateCodeChallengeFromVerifier,n);try{const a=await v(we.Fv,g.Ak.Sha256Digest,r,t,n)(e,t,n);return(0,G.Wy)(new Uint8Array(a))}catch(a){throw(0,F.Z_)(V.vD)}}class Ae extends _e{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(g.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const t=await v(Ce,g.Ak.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:c.gT.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=c.gT.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",null===e||void 0===e?void 0:e.correlationId);const t={correlationId:this.correlationId||(0,we.nn)(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=o.G.getAbsoluteUrl(e.postLogoutRedirectUri,$())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=o.G.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,$())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=o.G.getAbsoluteUrl($(),$())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e,t,r){this.performanceClient.addQueueMeasurement(g.Ak.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const n=await v(this.getClientConfiguration.bind(this),g.Ak.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,t,r);return new ye(n,this.performanceClient)}async getClientConfiguration(e,t,r){this.performanceClient.addQueueMeasurement(g.Ak.StandardInteractionClientGetClientConfiguration,this.correlationId);const n=await v(this.getDiscoveredAuthority.bind(this),g.Ak.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)(t,r),a=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:n,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:a.loggerCallback,piiLoggingEnabled:a.piiLoggingEnabled,logLevel:a.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:U.qx.MSAL_SKU,version:Te.i,cpu:c.gT.EMPTY_STRING,os:c.gT.EMPTY_STRING},telemetry:this.config.telemetry}}async getDiscoveredAuthority(e,t){this.performanceClient.addQueueMeasurement(g.Ak.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},n=e||this.config.auth.authority,a=_.generateAuthority(n,t||this.config.auth.azureCloudOptions);return await v(de.createDiscoveredInstance.bind(de),g.Ak.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(a,this.config.system.networkClient,this.browserStorage,r,this.logger,this.performanceClient,this.correlationId)}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(g.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const r=this.getRedirectUri(e.redirectUri),n={interactionType:t},a=x.setRequestState(this.browserCrypto,e&&e.state||c.gT.EMPTY_STRING,n),i={...await v(this.initializeBaseRequest.bind(this),g.Ak.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(e),redirectUri:r,state:a,nonce:e.nonce||(0,we.nn)(),responseMode:this.config.auth.OIDCOptions.serverResponseType},o=e.account||this.browserStorage.getActiveAccount();if(o&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: ".concat(o.homeAccountId),this.correlationId),i.account=o),!i.loginHint&&!o){const e=this.browserStorage.getLegacyLoginHint();e&&(i.loginHint=e)}return i}}var Ie=r(7093);const Re="user_switch",Oe={[Re]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Ne extends b.l4{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,Ne.prototype),this.name="NativeAuthError",this.ext=r}}function xe(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||(!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode)}function Pe(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return(0,C.ip)(S.QP);case"USER_INTERACTION_REQUIRED":return new C.Yo(e,t);case"USER_CANCEL":return(0,F.Z_)(V.h7);case"NO_NETWORK":return(0,F.Z_)(V.Mq)}return new Ne(e,Oe[e]||t,r)}class Me extends fe{constructor(e,t){super(e,t)}async acquireToken(e){var t,r;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.RefreshTokenClientAcquireToken,e.correlationId);const n=d.I.nowSeconds(),a=await v(this.executeTokenRequest.bind(this),g.Ak.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),i=null===(r=a.headers)||void 0===r?void 0:r[c.SZ.X_MS_REQUEST_ID],o=new ve(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(a.body),v(o.handleServerTokenResponse.bind(o),g.Ak.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(a.body,this.authority,n,e,void 0,void 0,!0,e.forceCache,i)}async acquireTokenByRefreshToken(e){var t;if(!e)throw(0,u.ei)(w.dL);if(null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw(0,s.zP)(T.D7);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return v(this.acquireTokenWithCachedRefreshToken.bind(this),g.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(r){const t=r instanceof C.Yo&&r.errorCode===S.I2,n=r instanceof re.n&&r.errorCode===c.D1.INVALID_GRANT_ERROR&&r.subError===c.D1.CLIENT_MISMATCH_ERROR;if(t||n)return v(this.acquireTokenWithCachedRefreshToken.bind(this),g.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw r}return v(this.acquireTokenWithCachedRefreshToken.bind(this),g.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var r;null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const n=m(this.cacheManager.getRefreshToken.bind(this.cacheManager),g.Ak.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!n)throw(0,C.ip)(S.I2);const a={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||c.hO.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:P}};return v(this.acquireToken.bind(this),g.Ak.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(a)}async executeTokenRequest(e,t){var r,n;null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.RefreshTokenClientExecuteTokenRequest,e.correlationId);const a=this.createTokenQueryParameters(e),i=o.G.appendQueryString(t.tokenEndpoint,a),s=await v(this.createTokenRequestBody.bind(this),g.Ak.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),c=this.createTokenRequestHeaders(e.ccsCredential),l={clientId:(null===(n=e.tokenBodyParameters)||void 0===n?void 0:n.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return v(this.executePostToTokenEndpoint.bind(this),g.Ak.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(i,s,c,l,e.correlationId,g.Ak.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var t,r,n;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const a=e.correlationId,i=new he;if(i.addClientId((null===(r=e.tokenBodyParameters)||void 0===r?void 0:r[c.Fo.CLIENT_ID])||this.config.authOptions.clientId),e.redirectUri&&i.addRedirectUri(e.redirectUri),i.addScopes(e.scopes,!0,null===(n=this.config.authOptions.authority.options.OIDCOptions)||void 0===n?void 0:n.defaultScopes),i.addGrantType(c.qJ.REFRESH_TOKEN_GRANT),i.addClientInfo(),i.addLibraryInfo(this.config.libraryInfo),i.addApplicationTelemetry(this.config.telemetry.application),i.addThrottling(),this.serverTelemetryManager&&!(0,ae.lh)(this.config)&&i.addServerTelemetry(this.serverTelemetryManager),i.addCorrelationId(a),i.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&i.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const e=this.config.clientCredentials.clientAssertion;i.addClientAssertion(e.assertion),i.addClientAssertionType(e.assertionType)}if(e.authenticationScheme===c.hO.POP){const t=new ge(this.cryptoUtils,this.performanceClient),r=await v(t.generateCnf.bind(t),g.Ak.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger);i.addPopToken(r.reqCnfString)}else if(e.authenticationScheme===c.hO.SSH){if(!e.sshJwk)throw(0,u.ei)(w.dK);i.addSshJwk(e.sshJwk)}if((!N.x.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&i.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case P:try{const t=(0,ce.j)(e.ccsCredential.credential);i.addCcsOid(t)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case M:i.addCcsUpn(e.ccsCredential.credential)}return e.tokenBodyParameters&&i.addExtraQueryParameters(e.tokenBodyParameters),i.createQueryString()}}class Le extends fe{constructor(e,t){super(e,t)}async acquireToken(e){try{const[t,r]=await this.acquireCachedToken(e);if(r===c.To.PROACTIVELY_REFRESHED){this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed.");new Me(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch((()=>{}))}return t}catch(t){if(t instanceof s.er&&t.errorCode===T.s$){return new Me(this.config,this.performanceClient).acquireTokenByRefreshToken(e)}throw t}}async acquireCachedToken(e){var t;null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(g.Ak.SilentFlowClientAcquireCachedToken,e.correlationId);let r=c.To.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!N.x.isEmptyObj(e.claims))throw this.setCacheOutcome(c.To.FORCE_REFRESH_OR_CLAIMS,e.correlationId),(0,s.zP)(T.s$);if(!e.account)throw(0,s.zP)(T.D7);const n=e.authority||this.authority.getPreferredCache(),a=this.cacheManager.readCacheRecord(e.account,e,n,this.performanceClient,e.correlationId);if(!a.accessToken)throw this.setCacheOutcome(c.To.NO_CACHED_ACCESS_TOKEN,e.correlationId),(0,s.zP)(T.s$);if(d.I.wasClockTurnedBack(a.accessToken.cachedAt)||d.I.isTokenExpired(a.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(c.To.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),(0,s.zP)(T.s$);return a.accessToken.refreshOn&&d.I.isTokenExpired(a.accessToken.refreshOn,0)&&(r=c.To.PROACTIVELY_REFRESHED),this.setCacheOutcome(r,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await v(this.generateResultFromCacheRecord.bind(this),g.Ak.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),r]}setCacheOutcome(e,t){var r,n;null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(e),null===(n=this.performanceClient)||void 0===n||n.addFields({cacheOutcome:e},t),e!==c.To.NOT_APPLICABLE&&this.logger.info("Token refresh is required due to cache outcome: ".concat(e))}async generateResultFromCacheRecord(e,t){var r;let n;if(null===(r=this.performanceClient)||void 0===r||r.addQueueMeasurement(g.Ak.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId),e.idToken&&(n=(0,L.Z_)(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){var a;const e=null===(a=n)||void 0===a?void 0:a.auth_time;if(!e)throw(0,s.zP)(T.w7);(0,L.ky)(e,t.maxAge)}return await ve.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}}class De extends Ae{async acquireToken(e){this.performanceClient.addQueueMeasurement(g.Ak.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(U.WN.acquireTokenSilent_silentFlow),r=await this.createSilentFlowClient(t,e.authority,e.azureCloudOptions);this.logger.verbose("Silent auth client created");try{const t=(await v(r.acquireCachedToken.bind(r),g.Ak.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(n){throw n instanceof F.Ut&&n.errorCode===V.XM&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),n}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(null===t||void 0===t?void 0:t.account)}async createSilentFlowClient(e,t,r){const n=await v(this.getClientConfiguration.bind(this),g.Ak.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,t,r);return new Le(n,this.performanceClient)}async initializeSilentRequest(e,t){this.performanceClient.addQueueMeasurement(g.Ak.InitializeSilentRequest,this.correlationId);const r=await v(this.initializeBaseRequest.bind(this),g.Ak.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(e,t);return{...e,...r,account:t,forceRefresh:e.forceRefresh||!1}}}const Fe="brk_client_id",Ue="brk_redirect_uri";class He extends _e{constructor(e,t,r,n,a,i,o,s,c,l,u,h){super(e,t,r,n,a,i,s,c,h),this.apiId=o,this.accountId=l,this.nativeMessageHandler=c,this.nativeStorageManager=u,this.silentCacheClient=new De(e,this.nativeStorageManager,r,n,a,i,s,c,h)}async acquireToken(e){this.performanceClient.addQueueMeasurement(g.Ak.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(g.Ak.NativeInteractionClientAcquireToken,e.correlationId),r=d.I.nowSeconds(),n=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,n);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(s){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const a={method:U.Ky.GetToken,request:n},i=await this.nativeMessageHandler.sendMessage(a),o=this.validateNativeResponse(i);return this.handleNativeResponse(o,n,r).then((e=>(t.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),e))).catch((e=>{throw t.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e}))}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:le.i.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),(0,s.zP)(T.cX);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw(0,s.zP)(T.cX);try{const e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),a={...r,idTokenClaims:null===n||void 0===n?void 0:n.idTokenClaims};return{...n,account:a}}catch(n){throw n}}async acquireTokenRedirect(e){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const t=await this.initializeNativeRequest(e),r={method:U.Ky.GetToken,request:t};try{const e=await this.nativeMessageHandler.sendMessage(r);this.validateNativeResponse(e)}catch(i){if(i instanceof Ne&&xe(i))throw i}this.browserStorage.setTemporaryCache(U.c4.NATIVE_REQUEST,JSON.stringify(t),!0);const n={apiId:U.WN.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);await this.navigationClient.navigateExternal(a,n)}async handleRedirectPromise(){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const e=this.browserStorage.getCachedNativeRequest();if(!e)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),null;const{prompt:t,...r}=e;t&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(U.c4.NATIVE_REQUEST));const n={method:U.Ky.GetToken,request:r},a=d.I.nowSeconds();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.nativeMessageHandler.sendMessage(n);this.validateNativeResponse(e);const t=this.handleNativeResponse(e,r,a);return this.browserStorage.setInteractionInProgress(!1),t}catch(i){throw this.browserStorage.setInteractionInProgress(!1),i}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),e.account.id!==t.accountId)throw Pe(Re);const n=await this.getDiscoveredAuthority(t.authority),a=L.Z_(e.id_token,K.t),i=this.createHomeAccountIdentifier(e,a),o=k.r.createAccount({homeAccountId:i,idTokenClaims:a,clientInfo:e.client_info,nativeAccountId:e.account.id},n),s=await this.generateAuthenticationResult(e,t,a,o,n.canonicalAuthority,r);return this.cacheAccount(o),this.cacheNativeTokens(e,t,i,a,s.accessToken,s.tenantId,r),s}createHomeAccountIdentifier(e,t){return k.r.generateHomeAccountId(e.client_info||c.gT.EMPTY_STRING,i.a.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?le.i.fromString(e.scope):le.i.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===c.hO.POP){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new ge(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw(0,s.zP)(T.Of);return await r.signPopToken(e.access_token,t.keyId,n)}return e.access_token}async generateAuthenticationResult(e,t,r,n,a,i){const o=this.addTelemetryFromNativeResponse(e),s=e.scope?le.i.fromString(e.scope):le.i.fromString(t.scope),l=e.account.properties||{},u=l.UID||r.oid||r.sub||c.gT.EMPTY_STRING,h=l.TenantId||r.tid||c.gT.EMPTY_STRING,d=(r?Object.assign(new k.r,{...n,idTokenClaims:r}):n).getAccountInfo(),f=await this.generatePopAccessToken(e,t),p=t.tokenType===c.hO.POP?c.hO.POP:c.hO.BEARER;return{authority:a,uniqueId:u,tenantId:h,scopes:s.asArray(),account:d,idToken:e.id_token,idTokenClaims:r,accessToken:f,fromCache:!!o&&this.isResponseFromCache(o),expiresOn:new Date(1e3*Number(i+e.expires_in)),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch((e=>{this.logger.error("Error occurred while removing account context from browser storage. ".concat(e))}))}cacheNativeTokens(e,t,r,n,a,i,o){const s=I.Md(r,t.authority,e.id_token||"",t.clientId,n.tid||""),l=o+(t.tokenType===c.hO.POP?c.gT.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),u=this.generateScopes(e,t),h=I.Ds(r,t.authority,a,t.clientId,n.tid||i,u.printScopes(),l,0,K.t),d=new D(void 0,s,h);this.nativeStorageManager.saveCacheRecord(d,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw(0,b.MD)(Ie.g,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.validateRequestAuthority(t,e.account);const r=new o.G(t);r.validateAsUri();const{scopes:n,...a}=e,i=new le.i(n||[]);i.appendScopes(c.f_);const s={...a,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case U.WN.ssoSilent:case U.WN.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),c.NJ.NONE}if(e.prompt)switch(e.prompt){case c.NJ.NONE:case c.NJ.CONSENT:case c.NJ.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace("initializeNativeRequest: prompt = ".concat(e.prompt," is not compatible with native flow")),(0,F.Z_)(V.o9)}else this.logger.trace("initializeNativeRequest: prompt was not provided")})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1};if(this.handleExtraBrokerParams(s),s.extraParameters=s.extraParameters||{},s.extraParameters.telemetry=U.BD.MATS_TELEMETRY,e.authenticationScheme===c.hO.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},r=new ge(this.browserCrypto),n=await v(r.generateCnf.bind(r),g.Ak.PopTokenGenerateCnf,this.logger,this.performanceClient,this.correlationId)(t,this.logger);s.reqCnf=n.reqCnfHash,s.keyId=n.kid}return s}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(Fe)&&e.extraParameters.hasOwnProperty(Ue)&&e.extraParameters.hasOwnProperty(c.Fo.CLIENT_ID)){const t=e.extraParameters[c.Fo.CLIENT_ID],r=e.redirectUri,n=e.extraParameters[Ue];e.extraParameters={child_client_id:t,child_redirect_uri:r},e.redirectUri=n}}}class Be{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(g.Ak.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:U.BD.CHANNEL_ID,extensionId:this.extensionId,responseId:(0,we.nn)(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: ".concat(JSON.stringify(t))),this.messageChannel.port1.postMessage(t),new Promise(((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})}))}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const n=new Be(e,t,r,U.BD.PREFERRED_EXTENSION_ID);return await n.sendHandshakeRequest(),n}catch(n){const a=new Be(e,t,r);return await a.sendHandshakeRequest(),a}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:U.BD.CHANNEL_ID,extensionId:this.extensionId,responseId:(0,we.nn)(),body:{method:U.Ky.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise(((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout((()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r((0,F.Z_)(V.hR)),this.handshakeResolvers.delete(e.responseId)}),this.handshakeTimeoutMs)}))}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===U.BD.CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===U.Ky.HandshakeRequest){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace("NativeMessageHandler.onWindowMessage - resolver can't be found for request ".concat(t.responseId));this.logger.verbose(t.extensionId?"Extension with id: ".concat(t.extensionId," not installed"):"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject((0,F.Z_)(V.Wb))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===U.Ky.Response){if(!r)return;const e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: ".concat(JSON.stringify(e))),"Success"!==e.status)r.reject(Pe(e.code,e.description,e.ext));else{if(!e.result)throw(0,b.MD)(Ie.g,"Event does not contain result.");e.result.code&&e.result.description?r.reject(Pe(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===U.Ky.HandshakeResponse){if(!n)return void this.logger.trace("NativeMessageHandler.onChannelMessage - resolver can't be found for request ".concat(t.responseId));clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: ".concat(this.extensionId)),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(a){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: ".concat(a)),this.logger.errorPii("Unable to parse ".concat(e)),r?r.reject(a):n&&n.reject(a)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case c.hO.BEARER:case c.hO.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class je{constructor(e,t,r,n,a){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=a}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(g.Ak.HandleCodeResponse,t.correlationId);try{r=this.authModule.handleFragmentResponse(e,t.state)}catch(n){throw n instanceof re.n&&n.subError===V.h7?(0,F.Z_)(V.h7):n}return v(this.handleCodeResponseFromServer.bind(this),g.Ak.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(g.Ak.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await v(this.authModule.updateAuthority.bind(this.authModule),g.Ak.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await v(this.authModule.acquireToken.bind(this.authModule),g.Ak.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:P}:e.loginHint?{credential:e.loginHint,type:M}:null}}var ze=r(9911);function qe(e,t,r){const n=ze.F(e);if(!n)throw ze.q(e)?(r.error("A ".concat(t," is present in the iframe but it does not contain known properties. It's likely that the ").concat(t," has been replaced by code running on the redirectUri page.")),r.errorPii("The ".concat(t," detected is: ").concat(e)),(0,F.Z_)(V.S_)):(r.error("The request has returned to the redirectUri but a ".concat(t," is not present. It's likely that the ").concat(t," has been removed or the page has been redirected by code running on the redirectUri page.")),(0,F.Z_)(V.nF));return n}class Ke extends Ae{constructor(e,t,r,n,a,i,o,s,c,l){super(e,t,r,n,a,i,o,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s}acquireToken(e){try{const t=this.generatePopupName(e.scopes||c.f_,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,r);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");const n=this.openSizedPopup("about:blank",t,r);return this.acquireTokenPopupAsync(e,t,r,n)}}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(t),n=e&&e.authority,a=e&&e.mainWindowRedirectUri,i=(null===e||void 0===e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,a);{this.logger.verbose("asyncPopup set to false, opening popup");const e=this.openSizedPopup("about:blank",r,i);return this.logoutPopupAsync(t,r,i,n,e,a)}}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t,r,n){this.logger.verbose("acquireTokenPopupAsync called");const a=this.initializeServerTelemetryManager(U.WN.acquireTokenPopup),i=await v(this.initializeAuthorizationRequest.bind(this),g.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,U.s_.Popup);Z(i.authority);try{const o=await v(this.initializeAuthorizationCodeRequest.bind(this),g.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(i),s=await v(this.createAuthCodeClient.bind(this),g.Ak.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(a,i.authority,i.azureCloudOptions),c=Be.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let l;c&&(l=this.performanceClient.startMeasurement(g.Ak.FetchAccountIdWithNativeBroker,e.correlationId));const u=await s.getAuthCodeUrl({...i,nativeBroker:c}),h=new je(s,this.browserStorage,o,this.logger,this.performanceClient),d={popup:n,popupName:t,popupWindowAttributes:r},f=this.initiateAuthRequest(u,d);this.eventHandler.emitEvent(ee.t.POPUP_OPENED,U.s_.Popup,{popupWindow:f},null);const p=await this.monitorPopupForHash(f),y=m(qe,g.Ak.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(p,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(ne.removeThrottle(this.browserStorage,this.config.auth.clientId,o),y.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),l&&l.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw(0,F.Z_)(V.V7);const e=new He(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,U.WN.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,y.accountId,this.nativeStorage,i.correlationId),{userRequestState:t}=x.parseRequestState(this.browserCrypto,i.state);return e.acquireToken({...i,state:t,prompt:void 0})}return await h.handleCodeResponse(y,i)}catch(o){throw n&&n.close(),o instanceof b.l4&&(o.setCorrelationId(this.correlationId),a.cacheFailedRequest(o)),o}}async logoutPopupAsync(e,t,r,n,a,i){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(ee.t.LOGOUT_START,U.s_.Popup,e);const s=this.initializeServerTelemetryManager(U.WN.logoutPopup);try{await this.clearCacheOnLogout(e.account);const u=await v(this.createAuthCodeClient.bind(this),g.Ak.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(s,n);try{u.authority.endSessionEndpoint}catch{var c;if(null!==(c=e.account)&&void 0!==c&&c.homeAccountId&&e.postLogoutRedirectUri&&u.authority.protocolMode===h.A.OIDC){var l;if(this.browserStorage.removeAccount(null===(l=e.account)||void 0===l?void 0:l.homeAccountId),this.eventHandler.emitEvent(ee.t.LOGOUT_SUCCESS,U.s_.Popup,e),i){const e={apiId:U.WN.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=o.G.getAbsoluteUrl(i,$());await this.navigationClient.navigateInternal(t,e)}return void(a&&a.close())}}const d=u.getLogoutUri(e);this.eventHandler.emitEvent(ee.t.LOGOUT_SUCCESS,U.s_.Popup,e);const f=this.openPopup(d,{popupName:t,popupWindowAttributes:r,popup:a});if(this.eventHandler.emitEvent(ee.t.POPUP_OPENED,U.s_.Popup,{popupWindow:f},null),await this.monitorPopupForHash(f).catch((()=>{})),i){const e={apiId:U.WN.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=o.G.getAbsoluteUrl(i,$());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: ".concat(t)),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(u){throw a&&a.close(),u instanceof b.l4&&(u.setCorrelationId(this.correlationId),s.cacheFailedRequest(u)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(ee.t.LOGOUT_FAILURE,U.s_.Popup,null,u),this.eventHandler.emitEvent(ee.t.LOGOUT_END,U.s_.Popup),u}this.eventHandler.emitEvent(ee.t.LOGOUT_END,U.s_.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii("Navigate to: ".concat(e)),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),(0,F.Z_)(V._c)}monitorPopupForHash(e){return new Promise(((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const n=setInterval((()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),void r((0,F.Z_)(V.h7));let a="";try{a=e.location.href}catch(s){}if(!a||"about:blank"===a)return;clearInterval(n);let i="";const o=this.config.auth.OIDCOptions.serverResponseType;e&&(i=o===c.rg.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)}),this.config.system.pollIntervalMilliseconds)})).finally((()=>{this.cleanPopup(e)}))}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: ".concat(e)),r.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii("Opening popup window to: ".concat(e)),r=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!r)throw(0,F.Z_)(V.H);return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),(0,F.Z_)(V.E)}}openSizedPopup(e,t,r){var n,a,i,o;const s=window.screenLeft?window.screenLeft:window.screenX,c=window.screenTop?window.screenTop:window.screenY,l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,u=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let h=null===(n=r.popupSize)||void 0===n?void 0:n.width,d=null===(a=r.popupSize)||void 0===a?void 0:a.height,f=null===(i=r.popupPosition)||void 0===i?void 0:i.top,p=null===(o=r.popupPosition)||void 0===o?void 0:o.left;return(!h||h<0||h>l)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),h=U.qx.POPUP_WIDTH),(!d||d<0||d>u)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),d=U.qx.POPUP_HEIGHT),(!f||f<0||f>u)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),f=Math.max(0,u/2-U.qx.POPUP_HEIGHT/2+c)),(!p||p<0||p>l)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),p=Math.max(0,l/2-U.qx.POPUP_WIDTH/2+s)),window.open(e,t,"width=".concat(h,", height=").concat(d,", top=").concat(f,", left=").concat(p,", scrollbars=yes"))}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(U.s_.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return"".concat(U.qx.POPUP_NAME_PREFIX,".").concat(this.config.auth.clientId,".").concat(e.join("-"),".").concat(t,".").concat(this.correlationId)}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return"".concat(U.qx.POPUP_NAME_PREFIX,".").concat(this.config.auth.clientId,".").concat(t,".").concat(this.correlationId)}}class Ge{constructor(e,t,r,n,a){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=a}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(U.c4.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(U.c4.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: ".concat(e));const r={apiId:U.WN.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if("function"===typeof t.onRedirectNavigate){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==t.onRedirectNavigate(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await t.navigationClient.navigateExternal(e,r)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await t.navigationClient.navigateExternal(e,r)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),(0,F.Z_)(V._c)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(t),n=this.browserStorage.getTemporaryCache(r);if(!n)throw(0,s.zP)(T.LV,"Cached State");let a;try{a=this.authModule.handleFragmentResponse(e,n)}catch(l){throw l instanceof re.n&&l.subError===V.h7?(0,F.Z_)(V.h7):l}const i=this.browserStorage.generateNonceKey(n),o=this.browserStorage.getTemporaryCache(i);if(this.authCodeRequest.code=a.code,a.cloud_instance_host_name&&await v(this.authModule.updateAuthority.bind(this.authModule),g.Ak.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(a.cloud_instance_host_name,this.authCodeRequest.correlationId),a.nonce=o||void 0,a.state=n,a.client_info)this.authCodeRequest.clientInfo=a.client_info;else{const e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}const c=await this.authModule.acquireToken(this.authCodeRequest,a);return this.browserStorage.cleanRequestByState(t),c}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(U.c4.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: ".concat(e))}return null}}class Ve extends Ae{constructor(e,t,r,n,a,i,o,s,c,l){super(e,t,r,n,a,i,o,c,l),this.nativeStorage=s}async acquireToken(e){const t=await v(this.initializeAuthorizationRequest.bind(this),g.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,U.s_.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const r=this.initializeServerTelemetryManager(U.WN.acquireTokenRedirect),n=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(ee.t.RESTORE_FROM_BFCACHE,U.s_.Redirect))};try{const a=await v(this.initializeAuthorizationCodeRequest.bind(this),g.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),i=await v(this.createAuthCodeClient.bind(this),g.Ak.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(r,t.authority,t.azureCloudOptions),o=new Ge(i,this.browserStorage,a,this.logger,this.performanceClient),s=await i.getAuthCodeUrl({...t,nativeBroker:Be.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii("Redirect start page: ".concat(c)),window.addEventListener("pageshow",n),await o.initiateAuthRequest(s,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate})}catch(a){throw a instanceof b.l4&&(a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a)),window.removeEventListener("pageshow",n),this.browserStorage.cleanRequestByState(t.state),a}}async handleRedirectPromise(e){const t=this.initializeServerTelemetryManager(U.WN.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[r,n]=this.getRedirectResponse(e||"");if(!r)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(U.s_.Redirect),null;const a=this.browserStorage.getTemporaryCache(U.c4.ORIGIN_URI,!0)||c.gT.EMPTY_STRING,i=o.G.removeHashFromUrl(a);if(i===o.G.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(a);return await this.handleResponse(r,t)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),this.handleResponse(r,t);if(!Y()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(U.c4.URL_HASH,n,!0);const e={apiId:U.WN.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let i=!0;if(a&&"null"!==a)this.logger.verbose("Navigating to loginRequestUrl: ".concat(a)),i=await this.navigationClient.navigateInternal(a,e);else{const t=function(){const e=new o.G(window.location.href).getUrlComponents();return"".concat(e.Protocol,"//").concat(e.HostNameAndPort,"/")}();this.browserStorage.setTemporaryCache(U.c4.ORIGIN_URI,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),i=await this.navigationClient.navigateInternal(t,e)}if(!i)return this.handleResponse(r,t)}return null}catch(r){throw r instanceof b.l4&&(r.setCorrelationId(this.correlationId),t.cacheFailedRequest(r)),this.browserStorage.cleanRequestByInteractionType(U.s_.Redirect),r}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===c.rg.QUERY?window.location.search:window.location.hash);let r=ze.F(t);if(r){try{!function(e,t,r){if(!e.state)throw(0,F.Z_)(V.Xk);const n=q(t,e.state);if(!n)throw(0,F.Z_)(V.$P);if(n.interactionType!==r)throw(0,F.Z_)(V.yK)}(r,this.browserCrypto,U.s_.Redirect)}catch(i){return i instanceof b.l4&&this.logger.error("Interaction type validation failed due to ".concat(i.errorCode,": ").concat(i.errorMessage)),[null,""]}return(n=window).location.hash="","function"===typeof n.history.replaceState&&n.history.replaceState(null,"","".concat(n.location.origin).concat(n.location.pathname).concat(n.location.search)),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}var n;const a=this.browserStorage.getTemporaryCache(U.c4.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(U.c4.URL_HASH)),a&&(r=ze.F(a),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,a]):[null,""]}async handleResponse(e,t){const r=e.state;if(!r)throw(0,F.Z_)(V.Xk);const n=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw(0,F.Z_)(V.V7);const t=new He(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,U.WN.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,n.correlationId),{userRequestState:a}=x.parseRequestState(this.browserCrypto,r);return t.acquireToken({...n,state:a,prompt:void 0}).finally((()=>{this.browserStorage.cleanRequestByState(r)}))}const a=this.browserStorage.getCachedAuthority(r);if(!a)throw(0,F.Z_)(V.dT);const i=await v(this.createAuthCodeClient.bind(this),g.Ak.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(t,a);ne.removeThrottle(this.browserStorage,this.config.auth.clientId,n);const o=new Ge(i,this.browserStorage,n,this.logger,this.performanceClient);return await o.handleCodeResponse(e,r)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(U.WN.logout);try{this.eventHandler.emitEvent(ee.t.LOGOUT_START,U.s_.Redirect,e),await this.clearCacheOnLogout(t.account);const i={apiId:U.WN.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await v(this.createAuthCodeClient.bind(this),g.Ak.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(r,e&&e.authority);if(o.authority.protocolMode===h.A.OIDC)try{o.authority.endSessionEndpoint}catch{var n,a;if(null!==(n=t.account)&&void 0!==n&&n.homeAccountId)return this.browserStorage.removeAccount(null===(a=t.account)||void 0===a?void 0:a.homeAccountId),void this.eventHandler.emitEvent(ee.t.LOGOUT_SUCCESS,U.s_.Redirect,t)}const s=o.getLogoutUri(t);if(this.eventHandler.emitEvent(ee.t.LOGOUT_SUCCESS,U.s_.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(s,i);if(!1!==e.onRedirectNavigate(s))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),void await this.navigationClient.navigateExternal(s,i);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(i){throw i instanceof b.l4&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),this.eventHandler.emitEvent(ee.t.LOGOUT_FAILURE,U.s_.Redirect,null,i),this.eventHandler.emitEvent(ee.t.LOGOUT_END,U.s_.Redirect),i}this.eventHandler.emitEvent(ee.t.LOGOUT_END,U.s_.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return o.G.getAbsoluteUrl(t,$())}}var We=r(670);async function Ye(e,t,r,n,a){if(t.addQueueMeasurement(g.Ak.SilentHandlerInitiateAuthRequest,n),!e)throw r.info("Navigate url is empty"),(0,F.Z_)(V._c);return a?await v(Qe,g.Ak.SilentHandlerLoadFrame,r,t,n)(e,a,t,n):m(Je,g.Ak.SilentHandlerLoadFrameSync,r,t,n)(e)}async function $e(e,t,r,n,a,i,o){return n.addQueueMeasurement(g.Ak.SilentHandlerMonitorIframeForHash,i),new Promise(((n,i)=>{t<We.Is&&a.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower (".concat(t,"ms) than the default (").concat(We.Is,"ms). This may result in timeouts."));const s=window.setTimeout((()=>{window.clearInterval(l),i((0,F.Z_)(V.JA))}),t),l=window.setInterval((()=>{let t="";const r=e.contentWindow;try{t=r?r.location.href:""}catch(i){}if(!t||"about:blank"===t)return;let a="";r&&(a=o===c.rg.QUERY?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(l),n(a)}),r)})).finally((()=>{m(Ze,g.Ak.RemoveHiddenIframe,a,n,i)(e)}))}function Qe(e,t,r,n){return r.addQueueMeasurement(g.Ak.SilentHandlerLoadFrame,n),new Promise(((r,n)=>{const a=Xe();window.setTimeout((()=>{a?(a.src=e,r(a)):n("Unable to load iframe")}),t)}))}function Je(e){const t=Xe();return t.src=e,t}function Xe(){const e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e}function Ze(e){document.body===e.parentNode&&document.body.removeChild(e)}class et extends Ae{constructor(e,t,r,n,a,i,o,s,c,l,u){super(e,t,r,n,a,i,s,l,u),this.apiId=o,this.nativeStorage=c}async acquireToken(e){if(this.performanceClient.addQueueMeasurement(g.Ak.SilentIframeClientAcquireToken,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==c.NJ.NONE&&e.prompt!==c.NJ.NO_SESSION)throw(0,F.Z_)(V.WQ);const t=await v(this.initializeAuthorizationRequest.bind(this),g.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)({...e,prompt:e.prompt||c.NJ.NONE},U.s_.Silent);Z(t.authority);const r=this.initializeServerTelemetryManager(this.apiId);try{const n=await v(this.createAuthCodeClient.bind(this),g.Ak.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)(r,t.authority,t.azureCloudOptions);return await v(this.silentTokenHelper.bind(this),g.Ak.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(n,t)}catch(n){throw n instanceof b.l4&&(n.setCorrelationId(this.correlationId),r.cacheFailedRequest(n)),n}}logout(){return Promise.reject((0,F.Z_)(V.I9))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(g.Ak.SilentIframeClientTokenHelper,r);const n=await v(this.initializeAuthorizationCodeRequest.bind(this),g.Ak.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(t),a=await v(e.getAuthCodeUrl.bind(e),g.Ak.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...t,nativeBroker:Be.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),i=new je(e,this.browserStorage,n,this.logger,this.performanceClient),o=await v(Ye,g.Ak.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(a,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,l=await v($e,g.Ak.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),u=m(qe,g.Ak.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,s,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw(0,F.Z_)(V.V7);const e=new He(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,r),{userRequestState:n}=x.parseRequestState(this.browserCrypto,t.state);return v(e.acquireToken.bind(e),g.Ak.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...t,state:n,prompt:t.prompt||c.NJ.NONE})}return v(i.handleCodeResponse.bind(i),g.Ak.HandleCodeResponse,this.logger,this.performanceClient,r)(u,t)}}class tt extends Ae{async acquireToken(e){this.performanceClient.addQueueMeasurement(g.Ak.SilentRefreshClientAcquireToken,e.correlationId);const t=await v(this.initializeBaseRequest.bind(this),g.Ak.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,e.account),r={...e,...t},n=this.initializeServerTelemetryManager(U.WN.acquireTokenSilent_silentFlow),a=await this.createRefreshTokenClient(n,r.authority,r.azureCloudOptions);return v(a.acquireTokenByRefreshToken.bind(a),g.Ak.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch((e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e}))}logout(){return Promise.reject((0,F.Z_)(V.I9))}async createRefreshTokenClient(e,t,r){const n=await v(this.getClientConfiguration.bind(this),g.Ak.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,t,r);return new Me(n,this.performanceClient)}}class rt{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}loadExternalTokens(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw(0,F.Z_)(V.Jd);const n=L.Z_(t.id_token,K.t);let a,i,o;if(e.account)o=k.r.createFromAccountInfo(e.account),a=new D(o,this.loadIdToken(t.id_token,o.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,t,o.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,t,o.homeAccountId,e.account.environment));else{if(!e.authority)throw(0,F.Z_)(V.Jd);{const s=_.generateAuthority(e.authority,e.azureCloudOptions),c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(i=new _(s,this.config.system.networkClient,this.storage,c,this.logger),r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),o=this.loadAccount(n,i,r.clientInfo),a=new D(o,this.loadIdToken(t.id_token,o.homeAccountId,i.hostnameAndPort,i.tenant),this.loadAccessToken(e,t,o.homeAccountId,i.hostnameAndPort,i.tenant,r),this.loadRefreshToken(e,t,o.homeAccountId,i.hostnameAndPort));else{if(!t.client_info)throw(0,F.Z_)(V.Jd);this.logger.trace("TokenCache - homeAccountId from response"),o=this.loadAccount(n,i,t.client_info),a=new D(o,this.loadIdToken(t.id_token,o.homeAccountId,i.hostnameAndPort,i.tenant),this.loadAccessToken(e,t,o.homeAccountId,i.hostnameAndPort,i.tenant,r),this.loadRefreshToken(e,t,o.homeAccountId,i.hostnameAndPort))}}}return this.generateAuthenticationResult(e,n,a,o,i)}loadAccount(e,t,r,n){let a;if(n?a=n:void 0!==t.authorityType&&r&&(a=k.r.generateHomeAccountId(r,t.authorityType,this.logger,this.cryptoObj,e)),!a)throw(0,F.Z_)(V.Jd);const i=k.r.createAccount({homeAccountId:a,idTokenClaims:e,clientInfo:r,environment:t.hostnameAndPort},t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(i),i;throw(0,F.Z_)(V.Jd)}loadIdToken(e,t,r,n){const a=I.Md(t,r,e,this.config.auth.clientId,n);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(a),a;throw(0,F.Z_)(V.Jd)}loadAccessToken(e,t,r,n,a,i){if(!t.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!t.expires_in)throw(0,F.Z_)(V.Jd);if(!i.extendedExpiresOn)throw(0,F.Z_)(V.Jd);const o=new le.i(e.scopes).printScopes(),s=i.expiresOn||t.expires_in+(new Date).getTime()/1e3,c=i.extendedExpiresOn,l=I.Ds(r,n,t.access_token,this.config.auth.clientId,a,o,s,c,K.t);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(l),l;throw(0,F.Z_)(V.Jd)}loadRefreshToken(e,t,r,n){if(!t.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;const a=I.OJ(r,n,t.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(a),a;throw(0,F.Z_)(V.Jd)}generateAuthenticationResult(e,t,r,n,a){var i,o;let s,l=c.gT.EMPTY_STRING,u=[],h=null;null!==r&&void 0!==r&&r.accessToken&&(l=r.accessToken.secret,u=le.i.fromString(r.accessToken.target).asArray(),h=new Date(1e3*Number(r.accessToken.expiresOn)),s=new Date(1e3*Number(r.accessToken.extendedExpiresOn)));const d=t.oid||t.sub||c.gT.EMPTY_STRING,f=t.tid||c.gT.EMPTY_STRING;return{authority:a?a.canonicalAuthority:c.gT.EMPTY_STRING,uniqueId:d,tenantId:f,scopes:u,account:n.getAccountInfo(),idToken:(null===(i=r.idToken)||void 0===i?void 0:i.secret)||"",idTokenClaims:t||{},accessToken:l,fromCache:!0,expiresOn:h,correlationId:e.correlationId||c.gT.EMPTY_STRING,requestId:c.gT.EMPTY_STRING,extExpiresOn:s,familyId:c.gT.EMPTY_STRING,tokenType:(null===r||void 0===r||null===(o=r.accessToken)||void 0===o?void 0:o.tokenType)||c.gT.EMPTY_STRING,state:c.gT.EMPTY_STRING,cloudGraphHostName:n.cloudGraphHostName||c.gT.EMPTY_STRING,msGraphHost:n.msGraphHost||c.gT.EMPTY_STRING,code:void 0,fromNativeBroker:!1}}}class nt extends ye{constructor(e){super(e),this.includeRedirectUri=!1}}class at extends Ae{constructor(e,t,r,n,a,i,o,s,c,l){super(e,t,r,n,a,i,s,c,l),this.apiId=o}async acquireToken(e){if(!e.code)throw(0,F.Z_)(V.Aj);const t=await v(this.initializeAuthorizationRequest.bind(this),g.Ak.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,U.s_.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const n={...t,code:e.code},a=await v(this.getClientConfiguration.bind(this),g.Ak.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)(r,t.authority),i=new nt(a);this.logger.verbose("Auth code client created");const o=new je(i,this.browserStorage,n,this.logger,this.performanceClient);return v(o.handleCodeResponseFromServer.bind(o),g.Ak.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(n){throw n instanceof b.l4&&(n.setCorrelationId(this.correlationId),r.cacheFailedRequest(n)),n}}logout(){return Promise.reject((0,F.Z_)(V.I9))}}class it{constructor(e){this.atsAsyncMeasurement=void 0,this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new n.Q(this.logger,this.performanceClient):a.d,this.eventHandler=new te.b(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new W(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,function(e){const t=e.cloudDiscoveryMetadata;let r;if(t)try{r=JSON.parse(t)}catch(n){throw(0,u.ei)(w.E)}return{canonicalAuthority:e.authority?E(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:r}}(this.config.auth)):((e,t)=>{const r={cacheLocation:U.Ix.MemoryStorage,temporaryCacheLocation:U.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new W(e,r,a.d,t)})(this.config.auth.clientId,this.logger);const t={cacheLocation:U.Ix.MemoryStorage,temporaryCacheLocation:U.Ix.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new W(this.config.auth.clientId,t,this.browserCrypto,this.logger),this.tokenCache=new rt(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e){const t=new it(e);return await t.initialize(),t}trackPageVisibility(){this.atsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.atsAsyncMeasurement.increment({visibilityChangeCount:1}))}async initialize(){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");const e=this.config.system.allowNativeBroker,t=this.performanceClient.startMeasurement(g.Ak.InitializeClientApplication);if(this.eventHandler.emitEvent(ee.t.INITIALIZE_START),e)try{this.nativeExtensionProvider=await Be.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(r){this.logger.verbose(r)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await v(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),g.Ak.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient)(this.performanceClient)),this.initialized=!0,this.eventHandler.emitEvent(ee.t.INITIALIZE_END),t.end({allowNativeBroker:e,success:!0})}async handleRedirectPromise(e){this.logger.verbose("handleRedirectPromise called"),X(this.initialized);const t=this.getAllAccounts();if(this.isBrowserEnvironment){const r=e||"";let n=this.redirectResponse.get(r);if("undefined"===typeof n){this.eventHandler.emitEvent(ee.t.HANDLE_REDIRECT_START,U.s_.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise");const a=this.browserStorage.getCachedNativeRequest();let i;if(a&&Be.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e){this.logger.trace("handleRedirectPromise - acquiring token from native platform");i=new He(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,U.WN.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,a.accountId,this.nativeInternalStorage,a.correlationId).handleRedirectPromise()}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const t=this.browserStorage.getTemporaryCache(U.c4.CORRELATION_ID,!0)||c.gT.EMPTY_STRING;i=this.createRedirectClient(t).handleRedirectPromise(e)}n=i.then((e=>{if(e){t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(ee.t.LOGIN_SUCCESS,U.s_.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_SUCCESS,U.s_.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success"))}return this.eventHandler.emitEvent(ee.t.HANDLE_REDIRECT_END,U.s_.Redirect),e})).catch((e=>{throw t.length>0?this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_FAILURE,U.s_.Redirect,null,e):this.eventHandler.emitEvent(ee.t.LOGIN_FAILURE,U.s_.Redirect,null,e),this.eventHandler.emitEvent(ee.t.HANDLE_REDIRECT_END,U.s_.Redirect),e})),this.redirectResponse.set(r,n)}else this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call");return n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(U.s_.Redirect);const r=this.getAllAccounts().length>0;let n;if(r?this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_START,U.s_.Redirect,e):this.eventHandler.emitEvent(ee.t.LOGIN_START,U.s_.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)){n=new He(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,U.WN.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e).catch((r=>{if(r instanceof Ne&&xe(r)){this.nativeExtensionProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(r instanceof C.Yo){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw this.getBrowserStorage().setInteractionInProgress(!1),r}))}else{n=this.createRedirectClient(t).acquireToken(e)}return n.catch((e=>{throw r?this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_FAILURE,U.s_.Redirect,null,e):this.eventHandler.emitEvent(ee.t.LOGIN_FAILURE,U.s_.Redirect,null,e),e}))}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(g.Ak.AcquireTokenPopup,t);try{this.logger.verbose("acquireTokenPopup called",t),this.preflightBrowserEnvironmentCheck(U.s_.Popup)}catch(i){return Promise.reject(i)}const n=this.getAllAccounts();let a;if(n.length>0?this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_START,U.s_.Popup,e):this.eventHandler.emitEvent(ee.t.LOGIN_START,U.s_.Popup,e),this.canUseNative(e))a=this.acquireTokenNative({...e,correlationId:t},U.WN.acquireTokenPopup).then((e=>(this.getBrowserStorage().setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),e))).catch((r=>{if(r instanceof Ne&&xe(r)){this.nativeExtensionProvider=void 0;return this.createPopupClient(t).acquireToken(e)}if(r instanceof C.Yo){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e)}throw this.getBrowserStorage().setInteractionInProgress(!1),r}));else{a=this.createPopupClient(t).acquireToken(e)}return a.then((e=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(ee.t.LOGIN_SUCCESS,U.s_.Popup,e):this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_SUCCESS,U.s_.Popup,e),r.add({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),r.end({success:!0,requestId:e.requestId}),e))).catch((e=>(n.length>0?this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_FAILURE,U.s_.Popup,null,e):this.eventHandler.emitEvent(ee.t.LOGIN_FAILURE,U.s_.Popup,null,e),r.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),Promise.reject(e))))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var t;const r=this.getRequestCorrelationId(e),n={...e,prompt:e.prompt,correlationId:r};let a;if(this.preflightBrowserEnvironmentCheck(U.s_.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(g.Ak.SsoSilent,r),null===(t=this.ssoSilentMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(ee.t.SSO_SILENT_START,U.s_.Silent,n),this.canUseNative(n))a=this.acquireTokenNative(n,U.WN.ssoSilent).catch((e=>{if(e instanceof Ne&&xe(e)){this.nativeExtensionProvider=void 0;return this.createSilentIframeClient(n.correlationId).acquireToken(n)}throw e}));else{a=this.createSilentIframeClient(n.correlationId).acquireToken(n)}return a.then((e=>{var t,r;return this.eventHandler.emitEvent(ee.t.SSO_SILENT_SUCCESS,U.s_.Silent,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.add({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),null===(r=this.ssoSilentMeasurement)||void 0===r||r.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((e=>{var t;throw this.eventHandler.emitEvent(ee.t.SSO_SILENT_FAILURE,U.s_.Silent,null,e),null===(t=this.ssoSilentMeasurement)||void 0===t||t.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.preflightBrowserEnvironmentCheck(U.s_.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_BY_CODE_START,U.s_.Silent,e);const r=this.performanceClient.startMeasurement(g.Ak.AcquireTokenByCode,t);try{if(e.code&&e.nativeAccountId)throw(0,F.Z_)(V.LL);if(e.code){const n=e.code;let a=this.hybridAuthCodeResponses.get(n);return a?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),a=this.acquireTokenByCodeAsync({...e,correlationId:t}).then((e=>(this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_BY_CODE_SUCCESS,U.s_.Silent,e),this.hybridAuthCodeResponses.delete(n),r.add({accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length}),r.end({success:!0,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e))).catch((e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_BY_CODE_FAILURE,U.s_.Silent,null,e),r.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})),this.hybridAuthCodeResponses.set(n,a)),a}if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return this.acquireTokenNative({...e,correlationId:t},U.WN.acquireTokenByCode,e.nativeAccountId).catch((e=>{throw e instanceof Ne&&xe(e)&&(this.nativeExtensionProvider=void 0),e}));throw(0,F.Z_)(V.KA)}throw(0,F.Z_)(V.Dy)}catch(n){throw this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_BY_CODE_FAILURE,U.s_.Silent,null,n),r.end({errorCode:n instanceof b.l4&&n.errorCode||void 0,subErrorCode:n instanceof b.l4&&n.subError||void 0,success:!1}),n}}async acquireTokenByCodeAsync(e){var t;this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(g.Ak.AcquireTokenByCodeAsync,e.correlationId),null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const r=this.createSilentAuthCodeClient(e.correlationId);return await r.acquireToken(e).then((e=>{var t;return null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((e=>{var t;throw null===(t=this.acquireTokenByCodeAsyncMeasurement)||void 0===t||t.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)}))}async acquireTokenFromCache(e,t,r){switch(this.performanceClient.addQueueMeasurement(g.Ak.AcquireTokenFromCache,t.correlationId),r){case U.lu.Default:case U.lu.AccessToken:case U.lu.AccessTokenAndRefreshToken:return v(e.acquireToken.bind(e),g.Ak.SilentCacheClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(t);default:throw(0,s.zP)(T.s$)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(g.Ak.AcquireTokenByRefreshToken,e.correlationId),t){case U.lu.Default:case U.lu.AccessTokenAndRefreshToken:case U.lu.RefreshToken:case U.lu.RefreshTokenAndNetwork:const t=this.createSilentRefreshClient(e.correlationId);return v(t.acquireToken.bind(t),g.Ak.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw(0,s.zP)(T.s$)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(g.Ak.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return v(t.acquireToken.bind(t),g.Ak.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);this.preflightBrowserEnvironmentCheck(U.s_.Redirect);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);this.preflightBrowserEnvironmentCheck(U.s_.Popup);return this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts(e):[]}getAccount(e){if(this.logger.trace("getAccount called"),0===Object.keys(e).length)return this.logger.warning("getAccount: No accountFilter provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy(e);return t?(this.logger.verbose("getAccount: Account matching provided filter found, returning"),t):(this.logger.verbose("getAccount: No matching account found, returning null"),null)}getAccountByUsername(e){if(this.logger.trace("getAccountByUsername called"),!e)return this.logger.warning("getAccountByUsername: No username provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({username:e});return t?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: ".concat(e)),t):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)}getAccountByHomeId(e){if(this.logger.trace("getAccountByHomeId called"),!e)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:e});return t?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ".concat(e)),t):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)}getAccountByLocalId(e){if(this.logger.trace("getAccountByLocalId called"),!e)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;const t=this.browserStorage.getAccountInfoFilteredBy({localAccountId:e});return t?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: ".concat(e)),t):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)}setActiveAccount(e){this.browserStorage.setActiveAccount(e)}getActiveAccount(){return this.browserStorage.getActiveAccount()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=k.r.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}preflightBrowserEnvironmentCheck(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),function(e){if(!e)throw(0,F.Z_)(V.Dx)}(this.isBrowserEnvironment),function(e,t){const r=Y();if(e===U.s_.Redirect&&r&&!t)throw(0,F.Z_)(V.b_)}(e,this.config.system.allowRedirectInIframe),Q(),J(),X(this.initialized),e===U.s_.Redirect&&this.config.cache.cacheLocation===U.Ix.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw(0,H.Z1)(B.xC);e!==U.s_.Redirect&&e!==U.s_.Popup||this.preflightInteractiveRequest(!t)}preflightInteractiveRequest(e){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),Q(),e&&this.getBrowserStorage().setInteractionInProgress(!0)}async acquireTokenNative(e,t,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw(0,F.Z_)(V.V7);return new He(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!Be.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case c.NJ.NONE:case c.NJ.CONSENT:case c.NJ.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = ".concat(e.prompt," is not compatible with native flow, returning false")),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.browserStorage.getAccountInfoFilteredBy({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Ke(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new Ve(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new et(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,U.WN.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new De(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new tt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new at(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,U.WN.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}getBrowserStorage(){return this.browserStorage}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(e){return null!==e&&void 0!==e&&e.correlationId?e.correlationId:this.isBrowserEnvironment?(0,we.nn)():c.gT.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||U.yo})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||U.yo})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(g.Ak.AcquireTokenSilent,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(U.s_.Silent),this.logger.verbose("acquireTokenSilent called",t);const n=e.account||this.getActiveAccount();if(!n)throw(0,F.Z_)(V.wH);const a={clientId:this.config.auth.clientId,authority:e.authority||c.gT.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},i=JSON.stringify(a),o=this.activeSilentTokenRequests.get(i);if("undefined"===typeof o){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const a=v(this.acquireTokenSilentAsync.bind(this),g.Ak.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},n).then((t=>(this.activeSilentTokenRequests.delete(i),r.add({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),r.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:t.requestId}),t))).catch((e=>{throw this.activeSilentTokenRequests.delete(i),r.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e}));return this.activeSilentTokenRequests.set(i,a),a}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discard(),o}async acquireTokenSilentAsync(e,t){var r;let n;if(this.performanceClient.addQueueMeasurement(g.Ak.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_START,U.s_.Silent,e),this.atsAsyncMeasurement=this.performanceClient.startMeasurement(g.Ak.AcquireTokenSilentAsync,e.correlationId),null===(r=this.atsAsyncMeasurement)||void 0===r||r.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),Be.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&t.nativeAccountId){this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform");const r={...e,account:t};n=this.acquireTokenNative(r,U.WN.acquireTokenSilent_silentFlow).catch((async t=>{if(t instanceof Ne&&xe(t)){this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0;return this.createSilentIframeClient(e.correlationId).acquireToken(e)}throw t}))}else{this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow");const r=this.createSilentCacheClient(e.correlationId),a=await v(r.initializeSilentRequest.bind(r),g.Ak.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t),i=e.cacheLookupPolicy||U.lu.Default;n=v(this.acquireTokenFromCache.bind(this),g.Ak.AcquireTokenFromCache,this.logger,this.performanceClient,a.correlationId)(r,a,i).catch((t=>{if(e.cacheLookupPolicy===U.lu.AccessToken)throw t;return Q(),this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_NETWORK_START,U.s_.Silent,a),v(this.acquireTokenByRefreshToken.bind(this),g.Ak.AcquireTokenByRefreshToken,this.logger,this.performanceClient,a.correlationId)(a,i).catch((t=>{const r=!(t instanceof C.Yo)&&(t.errorCode===U.qx.INVALID_GRANT_ERROR||t.errorCode===T.s$)||t.errorCode===S.I2,n=i===U.lu.Default||i===U.lu.Skip||i===U.lu.RefreshTokenAndNetwork;if(r&&n)return this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",e.correlationId),v(this.acquireTokenBySilentIframe.bind(this),g.Ak.AcquireTokenBySilentIframe,this.logger,this.performanceClient,a.correlationId)(a);throw t}))}))}return n.then((e=>{var t;return this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_SUCCESS,U.s_.Silent,e),null===(t=this.atsAsyncMeasurement)||void 0===t||t.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker,requestId:e.requestId}),e})).catch((e=>{var t;throw this.eventHandler.emitEvent(ee.t.ACQUIRE_TOKEN_FAILURE,U.s_.Silent,null,e),null===(t=this.atsAsyncMeasurement)||void 0===t||t.end({errorCode:e.errorCode,subErrorCode:e.subError,success:!1}),e})).finally((()=>{document.removeEventListener("visibilitychange",this.trackPageVisibility)}))}}},636:(e,t,r)=>{"use strict";r.d(t,{$5:()=>m,Au:()=>p,Fv:()=>h,Mg:()=>g,PP:()=>d,Xx:()=>v,nn:()=>f,qz:()=>u});var n=r(8254),a=r(2346),i=r(4190),o=r(4394);const s="SHA-256",c=new Uint8Array([1,0,1]),l={name:"RSASSA-PKCS1-v1_5",hash:s,modulusLength:2048,publicExponent:c};function u(e){if(!("crypto"in window))throw e.error("BrowserCrypto: crypto interface is unavailable"),(0,n.Z_)(o.TR);e.verbose("BrowserCrypto: modern crypto interface available")}async function h(e,t,r){null===t||void 0===t||t.addQueueMeasurement(a.Ak.Sha256Digest,r);const n=(new TextEncoder).encode(e);return window.crypto.subtle.digest(s,n)}function d(e){return window.crypto.getRandomValues(e)}function f(){return window.crypto.randomUUID()}async function p(e,t){return window.crypto.subtle.generateKey(l,e,t)}async function g(e){return window.crypto.subtle.exportKey(i.Mm,e)}async function m(e,t,r){return window.crypto.subtle.importKey(i.Mm,e,l,t,r)}async function v(e,t){return window.crypto.subtle.sign(l,e,t)}},5548:(e,t,r)=>{"use strict";r.d(t,{Q:()=>C});var n=r(2346),a=r(4430);const i="missing_kid_error",o="missing_alg_error",s={[i]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[o]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class c extends a.l4{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,c.prototype)}}function l(e){return new c(e,s[e])}var u=r(825);class h{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw l(i);if(!e.alg)throw l(o);const t=new h({typ:e.typ||u.xd.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}var d=r(5315),f=r(5142),p=r(636),g=r(8254),m=r(4190),v=r(4394);class y{constructor(){this.dbName=m.H4,this.version=m.kd,this.tableName=m.Gv,this.dbOpen=!1}async open(){return new Promise(((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",(e=>{e.target.result.createObjectStore(this.tableName)})),r.addEventListener("success",(t=>{const r=t;this.db=r.target.result,this.dbOpen=!0,e()})),r.addEventListener("error",(()=>t((0,g.Z_)(v.Pi))))}))}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return await this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r((0,g.Z_)(v.IL));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async setItem(e,t){return await this.validateDbIsOpen(),new Promise(((r,n)=>{if(!this.db)return n((0,g.Z_)(v.IL));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",(()=>{this.closeConnection(),r()})),a.addEventListener("error",(e=>{this.closeConnection(),n(e)}))}))}async removeItem(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r((0,g.Z_)(v.IL));const n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",(()=>{this.closeConnection(),t()})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async getKeys(){return await this.validateDbIsOpen(),new Promise(((e,t)=>{if(!this.db)return t((0,g.Z_)(v.IL));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",(t=>{const r=t;this.closeConnection(),e(r.target.result)})),r.addEventListener("error",(e=>{this.closeConnection(),t(e)}))}))}async containsKey(e){return await this.validateDbIsOpen(),new Promise(((t,r)=>{if(!this.db)return r((0,g.Z_)(v.IL));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",(e=>{const r=e;this.closeConnection(),t(1===r.target.result)})),n.addEventListener("error",(e=>{this.closeConnection(),r(e)}))}))}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise(((e,t)=>{const r=window.indexedDB.deleteDatabase(m.H4);r.addEventListener("success",(()=>e(!0))),r.addEventListener("blocked",(()=>e(!0))),r.addEventListener("error",(()=>t(!1)))}))}}var b=r(2300);class T{constructor(e,t){this.inMemoryCache=new b.k,this.indexedDBCache=new y,this.logger=e,this.storeName=t}handleDatabaseAccessError(e){if(!(e instanceof g.Ut&&e.errorCode===v.Pi))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(r){this.handleDatabaseAccessError(r)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(r){this.handleDatabaseAccessError(r)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(r){this.handleDatabaseAccessError(r)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore ".concat(this.storeName)),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore ".concat(this.storeName," deleted"))}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}const w="asymmetricKeys",_="symmetricKeys";class E{constructor(e){this.logger=e,this.asymmetricKeys=new T(this.logger,w),this.symmetricKeys=new T(this.logger,_)}async clear(){this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory();try{return await this.asymmetricKeys.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error("Clearing keystore failed with error: ".concat(e.message)):this.logger.error("Clearing keystore failed with unknown error"),!1}}}class C{constructor(e,t){this.logger=e,(0,p.qz)(e),this.cache=new E(this.logger),this.performanceClient=t}createNewGuid(){return(0,p.nn)()}base64Encode(e){return(0,d.h$)(e)}base64Decode(e){return(0,f.t)(e)}async getPublicKeyThumbprint(e){var t;const r=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(n.Ak.CryptoOptsGetPublicKeyThumbprint,e.correlationId),a=await(0,p.Au)(C.EXTRACTABLE,C.POP_KEY_USAGES),i=await(0,p.Mg)(a.publicKey),o=k({e:i.e,kty:i.kty,n:i.n}),s=await this.hashString(o),c=await(0,p.Mg)(a.privateKey),l=await(0,p.$5)(c,!1,["sign"]);return await this.cache.asymmetricKeys.setItem(s,{privateKey:l,publicKey:a.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),r&&r.end({success:!0}),s}async removeTokenBindingKey(e){await this.cache.asymmetricKeys.removeItem(e);return!await this.cache.asymmetricKeys.containsKey(e)}async clearKeystore(){return await this.cache.clear()}async signJwt(e,t,r,a){var i;const o=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(n.Ak.CryptoOptsSignJwt,a),s=await this.cache.asymmetricKeys.getItem(t);if(!s)throw(0,g.Z_)(v.XM);const c=await(0,p.Mg)(s.publicKey),l=k(c),u=(0,d._j)(JSON.stringify({kid:t})),f=h.getShrHeaderString({...null===r||void 0===r?void 0:r.header,alg:c.alg,kid:u}),m=(0,d._j)(f);e.cnf={jwk:JSON.parse(l)};const y=(0,d._j)(JSON.stringify(e)),b="".concat(m,".").concat(y),T=(new TextEncoder).encode(b),w=await(0,p.Xx)(s.privateKey,T),_=(0,d.Wy)(new Uint8Array(w)),E="".concat(b,".").concat(_);return o&&o.end({success:!0}),E}async hashString(e){const t=await(0,p.Fv)(e),r=new Uint8Array(t);return(0,d.Wy)(r)}}function k(e){return JSON.stringify(e,Object.keys(e).sort())}C.POP_KEY_USAGES=["sign","verify"],C.EXTRACTABLE=!0},5142:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});var n=r(8254),a=r(4394);function i(e){return(new TextDecoder).decode(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw(0,n.Z_)(a.lZ)}const r=atob(t);return Uint8Array.from(r,(e=>e.codePointAt(0)||0))}(e))}},5315:(e,t,r)=>{"use strict";function n(e){return encodeURIComponent(i(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function a(e){return o(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function i(e){return o((new TextEncoder).encode(e))}function o(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}r.d(t,{Wy:()=>a,_j:()=>n,h$:()=>i})},8254:(e,t,r)=>{"use strict";r.d(t,{Ut:()=>s,Z_:()=>c});var n=r(4430),a=r(4394);const i="For more visit: aka.ms/msaljs/browser-errors",o={[a.vD]:"The PKCE code challenge and verifier could not be generated.",[a.TR]:"The crypto object or function is not available.",[a._c]:"Navigation URI is empty. Please check stack trace for more info.",[a.nF]:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ".concat(i),[a.Xk]:"Hash does not contain state. Please verify that the request originated from msal.",[a.S_]:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ".concat(i),[a.$P]:"Unable to parse state. Please verify that the request originated from msal.",[a.yK]:"Hash contains state but the interaction type does not match the caller.",[a.Ck]:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ".concat(i),[a.E]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[a.H]:"window.open returned null or undefined window object.",[a.h7]:"User cancelled the flow.",[a.ZT]:"Token acquisition in popup failed due to timeout.  ".concat(i),[a.JA]:"Token acquisition in iframe failed due to timeout.  ".concat(i),[a.b_]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[a.xO]:"Request was blocked inside an iframe because MSAL detected an authentication response.  ".concat(i),[a.bj]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[a.h8]:"The iframe being monitored was closed prematurely.",[a.I9]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[a.wH]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[a.WQ]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[a.QO]:"No token request found in cache.",[a.e$]:"The cached token request could not be parsed.",[a.dT]:"No cached authority found.",[a.BO]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[a.Ut]:"Invalid cache type",[a.Dx]:"Login and token requests are not supported in non-browser environments.",[a.IL]:"Database is not open!",[a.Mq]:"No network connectivity. Check your internet connection.",[a.Dc]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[a.C8]:"Network request failed. Please check the network trace to determine root cause.",[a.w6]:"Failed to parse network response. Check network trace.",[a.Jd]:"Error loading token to cache.",[a.XM]:"Cryptographic Key or Keypair not found in browser storage.",[a.Aj]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[a.Dy]:"An authorization code or nativeAccountId must be provided to this flow.",[a.LL]:"Request cannot contain both spa code and native account id.",[a.Pi]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[a.KA]:"Unable to acquire token from native platform.  ".concat(i),[a.hR]:"Timed out while attempting to establish connection to browser extension",[a.Wb]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[a.V7]:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ".concat(i),[a.al]:"You must call and await the initialize function before attempting to call any other MSAL API.  ".concat(i),[a.o9]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[a.lZ]:"Invalid base64 encoded string."};a.vD,a.vD,a.TR,a.TR,a._c,a._c,a.nF,a.nF,a.Xk,a.Xk,a.S_,a.S_,a.$P,a.$P,a.yK,a.yK,a.Ck,a.Ck,a.E,a.E,a.H,a.H,a.h7,a.h7,a.ZT,a.ZT,a.JA,a.JA,a.b_,a.b_,a.xO,a.xO,a.bj,a.bj,a.h8,a.h8,a.I9,a.I9,a.wH,a.wH,a.WQ,a.WQ,a.QO,a.QO,a.e$,a.e$,a.dT,a.dT,a.BO,a.BO,a.Ut,a.Ut,a.Dx,a.Dx,a.IL,a.IL,a.Mq,a.Mq,a.Dc,a.Dc,a.C8,a.C8,a.w6,a.w6,a.Jd,a.Jd,a.XM,a.XM,a.Aj,a.Aj,a.Dy,a.Dy,a.LL,a.LL,a.Pi,a.Pi,a.KA,a.KA,a.hR,a.hR,a.Wb,a.Wb,a.V7,a.V7,a.al,a.al,a.o9,a.o9,a.lZ,a.lZ;class s extends n.l4{constructor(e){super(e,o[e]),Object.setPrototypeOf(this,s.prototype),this.name="BrowserAuthError"}}function c(e){return new s(e)}},4394:(e,t,r)=>{"use strict";r.d(t,{$P:()=>l,Aj:()=>F,BO:()=>A,C8:()=>P,Ck:()=>h,Dc:()=>x,Dx:()=>R,Dy:()=>U,E:()=>d,H:()=>f,I9:()=>w,IL:()=>O,JA:()=>m,Jd:()=>L,KA:()=>j,LL:()=>H,Mq:()=>N,Pi:()=>B,QO:()=>C,S_:()=>c,TR:()=>a,Ut:()=>I,V7:()=>K,WQ:()=>E,Wb:()=>q,XM:()=>D,Xk:()=>s,ZT:()=>g,_c:()=>i,al:()=>G,b_:()=>v,bj:()=>b,dT:()=>S,e$:()=>k,h7:()=>p,h8:()=>T,hR:()=>z,lZ:()=>W,nF:()=>o,o9:()=>V,vD:()=>n,w6:()=>M,wH:()=>_,xO:()=>y,yK:()=>u});const n="pkce_not_created",a="crypto_nonexistent",i="empty_navigate_uri",o="hash_empty_error",s="no_state_in_hash",c="hash_does_not_contain_known_properties",l="unable_to_parse_state",u="state_interaction_type_mismatch",h="interaction_in_progress",d="popup_window_error",f="empty_window_error",p="user_cancelled",g="monitor_popup_timeout",m="monitor_window_timeout",v="redirect_in_iframe",y="block_iframe_reload",b="block_nested_popups",T="iframe_closed_prematurely",w="silent_logout_unsupported",_="no_account_error",E="silent_prompt_value_error",C="no_token_request_cache_error",k="unable_to_parse_token_request_cache_error",S="no_cached_authority_error",A="auth_request_not_set_error",I="invalid_cache_type",R="non_browser_environment",O="database_not_open",N="no_network_connectivity",x="post_request_failed",P="get_request_failed",M="failed_to_parse_response",L="unable_to_load_token",D="crypto_key_not_found",F="auth_code_required",U="auth_code_or_nativeAccountId_required",H="spa_code_and_nativeAccountId_present",B="database_unavailable",j="unable_to_acquire_token_from_native_platform",z="native_handshake_timeout",q="native_extension_not_installed",K="native_connection_not_established",G="uninitialized_public_client_application",V="native_prompt_not_supported",W="invalid_base64_string"},2838:(e,t,r)=>{"use strict";r.d(t,{Z1:()=>s});var n=r(4430),a=r(4777);const i={[a.m4]:"Given storage configuration option was not supported.",[a.hJ]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[a.xC]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};a.m4,i[a.m4],a.hJ,i[a.hJ],a.xC,i[a.xC];class o extends n.l4{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,o.prototype)}}function s(e){return new o(e,i[e])}},4777:(e,t,r)=>{"use strict";r.d(t,{hJ:()=>a,m4:()=>n,xC:()=>i});const n="storage_not_supported",a="stubbed_public_client_application_called",i="in_mem_redirect_unavailable"},4270:(e,t,r)=>{"use strict";r.d(t,{b:()=>s});var n=r(6274),a=r(3362),i=r(3057),o=r(636);class s{constructor(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(e){if("undefined"!==typeof window){const t=(0,o.nn)();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: ".concat(t)),t}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback ".concat(e," removed."))}enableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){"undefined"!==typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(e,t,r,n){if("undefined"!==typeof window){const a={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: ".concat(e)),this.eventCallbacks.forEach(((t,r)=>{this.logger.verbose("Emitting event to callback ".concat(r,": ").concat(e)),t.apply(null,[a])}))}}handleAccountCacheChange(e){try{const t=e.newValue||e.oldValue;if(!t)return;const r=JSON.parse(t);if("object"!==typeof r||!n.r.isAccountEntity(r))return;const o=a.L.toObject(new n.r,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(i.t.ACCOUNT_ADDED,void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(i.t.ACCOUNT_REMOVED,void 0,o))}catch(e){return}}}},3057:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});const n={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"}},9037:(e,t,r)=>{"use strict";r.d(t,{i:()=>a,u:()=>n});const n="@azure/msal-browser",a="3.5.0"},4190:(e,t,r)=>{"use strict";r.d(t,{$H:()=>p,BD:()=>i,Bs:()=>h,EC:()=>c,Gv:()=>T,H4:()=>y,Ix:()=>s,Ky:()=>o,Mm:()=>m,Oq:()=>u,WN:()=>d,c4:()=>l,kd:()=>b,lA:()=>v,lu:()=>w,qx:()=>a,s_:()=>f,yo:()=>g});var n=r(825);const a={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},i={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},o={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},s={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},c={GET:"GET",POST:"POST"},l={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},u={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},h={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},d={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var f;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(f||(f={}));const p={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},g={scopes:n.f_},m="jwk",v={React:"@azure/msal-react",Angular:"@azure/msal-angular"},y="msal.db",b=1,T="".concat(y,".keys"),w={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5}},7232:(e,t,r)=>{"use strict";r.d(t,{Z_:()=>i,ky:()=>o});var n=r(2200),a=r(3932);function i(e,t){const r=function(e){if(!e)throw(0,n.zP)(a.PM);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw(0,n.zP)(a.GH);return t[2]}(e);try{const e=t(r);return JSON.parse(e)}catch(i){throw(0,n.zP)(a.GH)}}function o(e,t){if(0===t||Date.now()-3e5>e+t)throw(0,n.zP)(a.Ao)}},5808:(e,t,r)=>{"use strict";r.d(t,{B:()=>o,j:()=>s});var n=r(2200),a=r(825),i=r(3932);function o(e,t){if(!e)throw(0,n.zP)(i.S7);try{const r=t.base64Decode(e);return JSON.parse(r)}catch(r){throw(0,n.zP)(i.ZE)}}function s(e){if(!e)throw(0,n.zP)(i.ZE);const t=e.split(a.Bv.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?a.gT.EMPTY_STRING:t[1]}}},2738:(e,t,r)=>{"use strict";r.d(t,{Qh:()=>i,_u:()=>c,eM:()=>h,ix:()=>u,wn:()=>s});var n=r(7438),a=r(825);const i={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},o={tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},s=new Set;function c(e,t){let r;const i=e.canonicalAuthority;if(i){var s;const c=new n.G(i).getUrlComponents().HostNameAndPort;r=l(c,null===(s=e.cloudDiscoveryMetadata)||void 0===s?void 0:s.metadata,a.pQ.CONFIG,t)||l(c,o.metadata,a.pQ.HARDCODED_VALUES,t)||e.knownAuthorities}return r||[]}function l(e,t,r,n){if(null===n||void 0===n||n.trace("getAliasesFromMetadata called with source: ".concat(r)),e&&t){const a=h(t,e);if(a)return null===n||void 0===n||n.trace("getAliasesFromMetadata: found cloud discovery metadata in ".concat(r,", returning aliases")),a.aliases;null===n||void 0===n||n.trace("getAliasesFromMetadata: did not find cloud discovery metadata in ".concat(r))}return null}function u(e){return h(o.metadata,e)}function h(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(n.aliases.includes(t))return n}return null}o.metadata.forEach((e=>{e.aliases.forEach((e=>{s.add(e)}))}))},9686:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});const n={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"}},8339:(e,t,r)=>{"use strict";r.d(t,{a:()=>n});const n={Default:0,Adfs:1,Dsts:2,Ciam:3}},9269:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n={AAD:"AAD",OIDC:"OIDC"}},3362:(e,t,r)=>{"use strict";r.d(t,{L:()=>d,w:()=>f});var n=r(825),a=r(9358),i=r(4096),o=r(6274),s=r(2200),c=r(7232),l=r(1556),u=r(2738),h=r(3932);class d{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(l.u,l.i),this.staticAuthorityOptions=n}getAllAccounts(e){const t=[];return this.getAccountsFilteredBy(e||{}).forEach((r=>{const n=this.getAccountInfoFromEntity(r,e);n&&t.push(n)})),t}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.filter((e=>!!e.idTokenClaims))[0]:1===t.length?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}getAccountInfoFromEntity(e,t){const r=e.getAccountInfo(),n=this.getIdToken(r);if(n){const e=(0,c.Z_)(n.secret,this.cryptoImpl.base64Decode);if(this.idTokenClaimsMatchAccountFilter(e,t))return r.idToken=n.secret,r.idTokenClaims=e,r}return r}idTokenClaimsMatchAccountFilter(e,t){if(t){if(t.loginHint&&!this.matchLoginHint(e,t.loginHint))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t){if(!e)throw(0,s.zP)(h.mj);e.account&&this.setAccount(e.account),e.idToken&&!1!==(null===t||void 0===t?void 0:t.idToken)&&this.setIdTokenCredential(e.idToken),e.accessToken&&!1!==(null===t||void 0===t?void 0:t.accessToken)&&await this.saveAccessToken(e.accessToken),e.refreshToken&&!1!==(null===t||void 0===t?void 0:t.refreshToken)&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}async saveAccessToken(e){const t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),n=i.i.fromString(e.target),a=[];r.accessToken.forEach((e=>{if(!this.accessTokenKeyMatchesFilter(e,t,!1))return;const r=this.getAccessTokenCredential(e);if(r&&this.credentialMatchesFilter(r,t)){i.i.fromString(r.target).intersectingScopeSets(n)&&a.push(this.removeAccessToken(e))}})),await Promise.all(a),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach((t=>{if(!this.isAccountKey(t,e.homeAccountId,e.tenantId))return;const n=this.getAccount(t);n&&(e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId)||e.localAccountId&&!this.matchLocalAccountId(n,e.localAccountId)||e.username&&!this.matchUsername(n,e.username)||e.environment&&!this.matchEnvironment(n,e.environment)||e.realm&&!this.matchRealm(n,e.realm)||e.tenantId&&!this.matchRealm(n,e.tenantId)||e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(n,e.authorityType)||e.name&&!this.matchName(n,e.name)||r.push(n))})),r}isAccountKey(e,t,r){return!(e.split(n.Bv.CACHE_KEY_SEPARATOR).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(r&&!e.toLowerCase().includes(r.toLowerCase())))}isCredentialKey(e){if(e.split(n.Bv.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(n.d3.ID_TOKEN.toLowerCase())&&-1===t.indexOf(n.d3.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(n.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(n.d3.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(n.d3.REFRESH_TOKEN.toLowerCase())>-1){const e="".concat(n.d3.REFRESH_TOKEN).concat(n.Bv.CACHE_KEY_SEPARATOR).concat(this.clientId).concat(n.Bv.CACHE_KEY_SEPARATOR),r="".concat(n.d3.REFRESH_TOKEN).concat(n.Bv.CACHE_KEY_SEPARATOR).concat(n.ch).concat(n.Bv.CACHE_KEY_SEPARATOR);if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===n.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===n.hO.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)}getAppMetadataFilteredByInternal(e,t){const r=this.getKeys(),n={};return r.forEach((r=>{if(!this.isAppMetadata(r))return;const a=this.getAppMetadata(r);a&&(e&&!this.matchEnvironment(a,e)||t&&!this.matchClientId(a,t)||(n[r]=a))})),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach((t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)})),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach((e=>{t.push(this.removeAccount(e))})),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach((e=>{0===e.indexOf(r)&&this.removeIdToken(e)})),t.accessToken.forEach((e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))})),t.refreshToken.forEach((e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)})),await Promise.all(n)}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===n.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===n.hO.POP){const e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(r){throw(0,s.zP)(h.ol)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach((e=>{this.isAppMetadata(e)&&this.removeItem(e)})),!0}readCacheRecord(e,t,r,n,a){const i=this.getTokenKeys(),o=this.readAccountFromCache(e),s=this.getIdToken(e,i,n,a),l=this.getAccessToken(e,t,i,n,a),u=this.getRefreshToken(e,!1,i,n,a),h=this.readAppMetadataFromCache(r);return o&&s&&(o.idTokenClaims=(0,c.Z_)(s.secret,this.cryptoImpl.base64Decode)),{account:o,idToken:s,accessToken:l,refreshToken:u,appMetadata:h}}readAccountFromCache(e){const t=o.r.generateAccountCacheKey(e);return this.getAccount(t)}getIdToken(e,t,r,i){this.commonLogger.trace("CacheManager - getIdToken called");const o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:n.d3.ID_TOKEN,clientId:this.clientId,realm:e.tenantId},s=this.getIdTokensByFilter(o,t),c=s.length;return c<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):c>1?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),s.forEach((e=>{this.removeIdToken((0,a.Mk)(e))})),r&&i&&r.addFields({multiMatchedID:s.length},i),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),s[0])}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,n=[];return r.forEach((t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.push(r)})),n}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,o,s){this.commonLogger.trace("CacheManager - getAccessToken called");const c=i.i.createSearchScopes(t.scopes),l=t.authenticationScheme||n.hO.BEARER,u=l&&l.toLowerCase()!==n.hO.BEARER.toLowerCase()?n.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME:n.d3.ACCESS_TOKEN,h={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:u,clientId:this.clientId,realm:e.tenantId,target:c,tokenType:l,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=r&&r.accessToken||this.getTokenKeys().accessToken,f=[];d.forEach((e=>{if(this.accessTokenKeyMatchesFilter(e,h,!0)){const t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,h)&&f.push(t)}}));const p=f.length;return p<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):p>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),f.forEach((e=>{this.removeAccessToken((0,a.Mk)(e))})),o&&s&&o.addFields({multiMatchedAT:f.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),f[0])}accessTokenKeyMatchesFilter(e,t,r){const n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===n.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach((t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;const n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)})),r}getRefreshToken(e,t,r,a,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const o=t?n.ch:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:n.d3.REFRESH_TOKEN,clientId:this.clientId,familyId:o},c=r&&r.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach((e=>{if(this.refreshTokenKeyMatchesFilter(e,s)){const t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,s)&&l.push(t)}}));const u=l.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&a&&i&&a.addFields({multiMatchedRT:u},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map((e=>r[e])),a=n.length;if(a<1)return null;if(a>1)throw(0,s.zP)(h.EC);return n[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==n.ch)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountId(e,t){return!("string"!==typeof e.localAccountId||t!==e.localAccountId)}matchUsername(e,t){return!("string"!==typeof e.username||t.toLowerCase()!==e.username.toLowerCase())}matchName(e,t){var r;return!(t.toLowerCase()!==(null===(r=e.name)||void 0===r?void 0:r.toLowerCase()))}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const r=(0,u._u)(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(!e.realm||t!==e.realm)}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHint(e,t){return(null===e||void 0===e?void 0:e.login_hint)===t||(e.preferred_username===t||(null===e||void 0===e?void 0:e.upn)===t)}matchSid(e,t){return!(null===e||void 0===e||!e.sid||e.sid!==t)}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==n.d3.ACCESS_TOKEN&&e.credentialType!==n.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return i.i.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(n.dg)}isAuthorityMetadata(e){return-1!==e.indexOf(n.QU.CACHE_KEY)}generateAuthorityMetadataCacheKey(e){return"".concat(n.QU.CACHE_KEY,"-").concat(this.clientId,"-").concat(e)}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class f extends d{setAccount(){throw(0,s.zP)(h.M2)}getAccount(){throw(0,s.zP)(h.M2)}setIdTokenCredential(){throw(0,s.zP)(h.M2)}getIdTokenCredential(){throw(0,s.zP)(h.M2)}setAccessTokenCredential(){throw(0,s.zP)(h.M2)}getAccessTokenCredential(){throw(0,s.zP)(h.M2)}setRefreshTokenCredential(){throw(0,s.zP)(h.M2)}getRefreshTokenCredential(){throw(0,s.zP)(h.M2)}setAppMetadata(){throw(0,s.zP)(h.M2)}getAppMetadata(){throw(0,s.zP)(h.M2)}setServerTelemetry(){throw(0,s.zP)(h.M2)}getServerTelemetry(){throw(0,s.zP)(h.M2)}setAuthorityMetadata(){throw(0,s.zP)(h.M2)}getAuthorityMetadata(){throw(0,s.zP)(h.M2)}getAuthorityMetadataKeys(){throw(0,s.zP)(h.M2)}setThrottlingCache(){throw(0,s.zP)(h.M2)}getThrottlingCache(){throw(0,s.zP)(h.M2)}removeItem(){throw(0,s.zP)(h.M2)}containsKey(){throw(0,s.zP)(h.M2)}getKeys(){throw(0,s.zP)(h.M2)}getAccountKeys(){throw(0,s.zP)(h.M2)}getTokenKeys(){throw(0,s.zP)(h.M2)}async clear(){throw(0,s.zP)(h.M2)}updateCredentialCacheKey(){throw(0,s.zP)(h.M2)}}},6274:(e,t,r)=>{"use strict";r.d(t,{r:()=>l});var n=r(825),a=r(5808),i=r(2200),o=r(8339),s=r(9269),c=r(3932);class l{generateAccountId(){return[this.homeAccountId,this.environment].join(n.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return l.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType}}static generateAccountCacheKey(e){return[e.homeAccountId,e.environment||n.gT.EMPTY_STRING,e.tenantId||n.gT.EMPTY_STRING].join(n.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t){const r=new l;t.authorityType===o.a.Adfs?r.authorityType=n.iR.ADFS_ACCOUNT_TYPE:t.protocolMode===s.A.AAD?r.authorityType=n.iR.MSSTS_ACCOUNT_TYPE:r.authorityType=n.iR.GENERIC_ACCOUNT_TYPE,r.clientInfo=e.clientInfo,r.homeAccountId=e.homeAccountId,r.nativeAccountId=e.nativeAccountId;const a=e.environment||t&&t.getPreferredCache();if(!a)throw(0,i.zP)(c.Q9);r.environment=a,r.realm=e.idTokenClaims.tid||n.gT.EMPTY_STRING,r.localAccountId=e.idTokenClaims.oid||e.idTokenClaims.sub||n.gT.EMPTY_STRING;const u=e.idTokenClaims.preferred_username||e.idTokenClaims.upn,h=e.idTokenClaims.emails?e.idTokenClaims.emails[0]:null;return r.username=u||h||n.gT.EMPTY_STRING,r.name=e.idTokenClaims.name,r.cloudGraphHostName=e.cloudGraphHostName,r.msGraphHost=e.msGraphHost,r}static createFromAccountInfo(e,t,r){const a=new l;return a.authorityType=e.authorityType||n.iR.GENERIC_ACCOUNT_TYPE,a.homeAccountId=e.homeAccountId,a.localAccountId=e.localAccountId,a.nativeAccountId=e.nativeAccountId,a.realm=e.tenantId,a.environment=e.environment,a.username=e.username,a.name=e.name,a.cloudGraphHostName=t,a.msGraphHost=r,a}static generateHomeAccountId(e,t,r,i,s){const c=null!==s&&void 0!==s&&s.sub?s.sub:n.gT.EMPTY_STRING;if(t===o.a.Adfs||t===o.a.Dsts)return c;if(e)try{const t=(0,a.B)(e,i);if(t.uid&&t.utid)return"".concat(t.uid).concat(n.Bv.CLIENT_INFO_SEPARATOR).concat(t.utid)}catch(l){}return r.verbose("No client info in response"),c}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){const r=e.idTokenClaims||{},a=t.idTokenClaims||{};n=r.iat===a.iat&&r.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}},9358:(e,t,r)=>{"use strict";r.d(t,{Bq:()=>p,Ds:()=>u,Js:()=>w,Md:()=>l,Mk:()=>c,OJ:()=>h,Om:()=>f,x4:()=>g});var n=r(7232),a=r(2200),i=r(825),o=r(6378),s=r(3932);function c(e){return[m(e),v(e),y(e),b(e),T(e)].join(i.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function l(e,t,r,n,a){return{credentialType:i.d3.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:a}}function u(e,t,r,c,l,u,h,d,f,p,g,m,v,y,b){var T,w;const _={homeAccountId:e,credentialType:i.d3.ACCESS_TOKEN,secret:r,cachedAt:o.I.nowSeconds().toString(),expiresOn:h.toString(),extendedExpiresOn:d.toString(),environment:t,clientId:c,realm:l,target:u,tokenType:g||i.hO.BEARER};if(m&&(_.userAssertionHash=m),p&&(_.refreshOn=p.toString()),y&&(_.requestedClaims=y,_.requestedClaimsHash=b),(null===(T=_.tokenType)||void 0===T?void 0:T.toLowerCase())!==i.hO.BEARER.toLowerCase())switch(_.credentialType=i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME,_.tokenType){case i.hO.POP:const e=(0,n.Z_)(r,f);if(null===e||void 0===e||null===(w=e.cnf)||void 0===w||!w.kid)throw(0,a.zP)(s.P_);_.keyId=e.cnf.kid;break;case i.hO.SSH:_.keyId=v}return _}function h(e,t,r,n,a,o){const s={credentialType:i.d3.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return o&&(s.userAssertionHash=o),a&&(s.familyId=a),s}function d(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function f(e){return!!e&&(d(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===i.d3.ACCESS_TOKEN||e.credentialType===i.d3.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function p(e){return!!e&&(d(e)&&e.hasOwnProperty("realm")&&e.credentialType===i.d3.ID_TOKEN)}function g(e){return!!e&&(d(e)&&e.credentialType===i.d3.REFRESH_TOKEN)}function m(e){return[e.homeAccountId,e.environment].join(i.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function v(e){const t=e.credentialType===i.d3.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(i.Bv.CACHE_KEY_SEPARATOR).toLowerCase()}function y(e){return(e.target||"").toLowerCase()}function b(e){return(e.requestedClaimsHash||"").toLowerCase()}function T(e){return e.tokenType&&e.tokenType.toLowerCase()!==i.hO.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function w(e,t){const r=0===e.indexOf(i.HN.CACHE_KEY);let n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}},7906:(e,t,r)=>{"use strict";r.d(t,{j6:()=>T,lh:()=>w,z:()=>d});var n=r(290),a=r(9684),i=r(825),o=r(1556),s=r(9686),c=r(3362),l=r(9269),u=r(2200),h=r(3932);const d={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},f={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:a.i.Info,correlationId:i.gT.EMPTY_STRING},p={claimsBasedCachingEnabled:!1},g={async sendGetRequestAsync(){throw(0,u.zP)(h.M2)},async sendPostRequestAsync(){throw(0,u.zP)(h.M2)}},m={sku:i.gT.SKU,version:o.i,cpu:i.gT.EMPTY_STRING,os:i.gT.EMPTY_STRING},v={clientSecret:i.gT.EMPTY_STRING,clientAssertion:void 0},y={azureCloudInstance:s.z.None,tenant:"".concat(i.gT.DEFAULT_COMMON_TENANT)},b={application:{appName:"",appVersion:""}};function T(e){let{authOptions:t,systemOptions:r,loggerOptions:i,cacheOptions:o,storageInterface:s,networkInterface:l,cryptoInterface:u,clientCredentials:h,libraryInfo:T,telemetry:w,serverTelemetryManager:_,persistencePlugin:E,serializableCache:C}=e;const k={...f,...i};return{authOptions:(S=t,{clientCapabilities:[],azureCloudOptions:y,skipAuthorityMetadataCache:!1,...S}),systemOptions:{...d,...r},loggerOptions:k,cacheOptions:{...p,...o},storageInterface:s||new c.w(t.clientId,n.d,new a.Y(k)),networkInterface:l||g,cryptoInterface:u||n.d,clientCredentials:h||v,libraryInfo:{...m,...T},telemetry:{...b,...w},serverTelemetryManager:_||null,persistencePlugin:E||null,serializableCache:C||null};var S}function w(e){return e.authOptions.authority.options.protocolMode===l.A.OIDC}},290:(e,t,r)=>{"use strict";r.d(t,{d:()=>i});var n=r(2200),a=r(3932);const i={createNewGuid:()=>{throw(0,n.zP)(a.M2)},base64Decode:()=>{throw(0,n.zP)(a.M2)},base64Encode:()=>{throw(0,n.zP)(a.M2)},async getPublicKeyThumbprint(){throw(0,n.zP)(a.M2)},async removeTokenBindingKey(){throw(0,n.zP)(a.M2)},async clearKeystore(){throw(0,n.zP)(a.M2)},async signJwt(){throw(0,n.zP)(a.M2)},async hashString(){throw(0,n.zP)(a.M2)}}},4430:(e,t,r)=>{"use strict";r.d(t,{MD:()=>s,l4:()=>o});var n=r(825),a=r(7093);const i={[a.g]:"Unexpected error in authentication.",[a.D]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};a.g,i[a.g],a.D,i[a.D];class o extends Error{constructor(e,t,r){super(t?"".concat(e,": ").concat(t):e),Object.setPrototypeOf(this,o.prototype),this.errorCode=e||n.gT.EMPTY_STRING,this.errorMessage=t||n.gT.EMPTY_STRING,this.subError=r||n.gT.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function s(e,t){return new o(e,t?"".concat(i[e]," ").concat(t):i[e])}},7093:(e,t,r)=>{"use strict";r.d(t,{D:()=>a,g:()=>n});const n="unexpected_error",a="post_request_failed"},2200:(e,t,r)=>{"use strict";r.d(t,{er:()=>o,zP:()=>s});var n=r(4430),a=r(3932);const i={[a.ZE]:"The client info could not be parsed/decoded correctly",[a.S7]:"The client info was empty",[a.GH]:"Token cannot be parsed",[a.PM]:"The token is null or empty",[a.HO]:"Endpoints cannot be resolved",[a.EF]:"Network request failed",[a.Ce]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[a.b4]:"The hash parameters could not be deserialized",[a.r8]:"State was not the expected format",[a.Tu]:"State mismatch error",[a.LV]:"State not found",[a.vR]:"Nonce mismatch error",[a.w7]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[a.Ao]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[a.MU]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[a.RH]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[a.EC]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[a.FU]:"Token request cannot be made without authorization code or refresh token.",[a.v1]:"Cannot remove null or empty scope from ScopeSet",[a.f4]:"Cannot append ScopeSet",[a.S]:"Empty input ScopeSet cannot be processed",[a.Jk]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[a.tS]:"Device code is expired.",[a.ZT]:"Device code stopped polling for unknown reasons.",[a.D7]:"Please pass an account object, silent flow is not supported without account information",[a.mj]:"Cache record object was null or undefined.",[a.Q9]:"Invalid environment when attempting to create cache entry",[a.cX]:"No account found in cache for given key.",[a.QL]:"No crypto object detected.",[a.cy]:"Unexpected credential type.",[a.aE]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[a.SX]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[a.s$]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[a.nQ]:"User defined timeout for device code polling reached",[a.P_]:"Cannot generate a POP jwt if the token_claims are not populated",[a.Zv]:"Server response does not contain an authorization code to proceed",[a.ol]:"Could not remove the credential's binding key from storage.",[a.ig]:"The provided authority does not support logout",[a.Of]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[a.Mq]:"No network connectivity. Check your internet connection.",[a.$R]:"User cancelled the flow.",[a.k7]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[a.M2]:"This method has not been implemented",[a.Ls]:"The nested app auth bridge is disabled"};a.ZE,a.ZE,a.S7,a.S7,a.GH,a.GH,a.PM,a.PM,a.HO,a.HO,a.EF,a.EF,a.Ce,a.Ce,a.b4,a.b4,a.r8,a.r8,a.Tu,a.Tu,a.LV,a.LV,a.vR,a.vR,a.w7,a.w7,a.Ao,a.Ao,a.MU,a.MU,a.RH,a.RH,a.EC,a.EC,a.FU,a.FU,a.v1,a.v1,a.f4,a.f4,a.S,a.S,a.Jk,a.Jk,a.tS,a.tS,a.ZT,a.ZT,a.D7,a.D7,a.mj,a.mj,a.Q9,a.Q9,a.cX,a.cX,a.QL,a.QL,a.cy,a.cy,a.aE,a.aE,a.SX,a.SX,a.s$,a.s$,a.nQ,a.nQ,a.P_,a.P_,a.Zv,a.Zv,a.ol,a.ol,a.ig,a.ig,a.Of,a.Of,a.Mq,a.Mq,a.$R,a.$R,a.k7,a.k7,a.Ls,a.Ls;class o extends n.l4{constructor(e,t){super(e,t?"".concat(i[e],": ").concat(t):i[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,o.prototype)}}function s(e,t){return new o(e,t)}},3932:(e,t,r)=>{"use strict";r.d(t,{$R:()=>q,Ao:()=>m,Ce:()=>l,D7:()=>A,EC:()=>b,EF:()=>c,FU:()=>T,GH:()=>i,HO:()=>s,Jk:()=>C,LV:()=>f,Ls:()=>V,M2:()=>G,MU:()=>v,Mq:()=>z,Of:()=>j,PM:()=>o,P_:()=>F,Q9:()=>R,QL:()=>N,RH:()=>y,S:()=>E,S7:()=>a,SX:()=>M,Tu:()=>d,ZE:()=>n,ZT:()=>S,Zv:()=>U,aE:()=>P,b4:()=>u,cX:()=>O,cy:()=>x,f4:()=>_,ig:()=>B,k7:()=>K,mj:()=>I,nQ:()=>D,ol:()=>H,r8:()=>h,s$:()=>L,tS:()=>k,v1:()=>w,vR:()=>p,w7:()=>g});const n="client_info_decoding_error",a="client_info_empty_error",i="token_parsing_error",o="null_or_empty_token",s="endpoints_resolution_error",c="network_error",l="openid_config_error",u="hash_not_deserialized",h="invalid_state",d="state_mismatch",f="state_not_found",p="nonce_mismatch",g="auth_time_not_found",m="max_age_transpired",v="multiple_matching_tokens",y="multiple_matching_accounts",b="multiple_matching_appMetadata",T="request_cannot_be_made",w="cannot_remove_empty_scope",_="cannot_append_scopeset",E="empty_input_scopeset",C="device_code_polling_cancelled",k="device_code_expired",S="device_code_unknown_error",A="no_account_in_silent_request",I="invalid_cache_record",R="invalid_cache_environment",O="no_account_found",N="no_crypto_object",x="unexpected_credential_type",P="invalid_assertion",M="invalid_client_credential",L="token_refresh_required",D="user_timeout_reached",F="token_claims_cnf_required_for_signedjwt",U="authorization_code_missing_from_server_response",H="binding_key_not_removed",B="end_session_endpoint_not_supported",j="key_id_missing",z="no_network_connectivity",q="user_canceled",K="missing_tenant_id_error",G="method_not_implemented",V="nested_app_auth_bridge_disabled"},9050:(e,t,r)=>{"use strict";r.d(t,{ei:()=>s});var n=r(4430),a=r(4734);const i={[a.RV]:"A redirect URI is required for all calls, and none has been set.",[a.LB]:"Could not parse the given claims request object.",[a.Oz]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[a.yH]:"URL could not be parsed into appropriate segments.",[a.To]:"URL was empty or null.",[a.vE]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[a.z_]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[a.nm]:"Given claims parameter must be a stringified JSON object.",[a.dL]:"Token request was empty and not found in cache.",[a.$h]:"The logout request was null or undefined.",[a.d6]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[a.TU]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[a.E]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[a.zx]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[a.o_]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[a.dK]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[a.hI]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[a.U9]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[a.i1]:"Invalid authentication header provided",[a.qz]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[a.Ol]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[a.Hv]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};a.RV,a.RV,a.LB,a.LB,a.Oz,a.Oz,a.yH,a.yH,a.To,a.To,a.vE,a.vE,a.z_,a.z_,a.nm,a.nm,a.dL,a.dL,a.$h,a.$h,a.d6,a.d6,a.TU,a.TU,a.E,a.E,a.zx,a.zx,a.o_,a.o_,a.dK,a.dK,a.hI,a.hI,a.U9,a.U9,a.i1,a.i1,a.qz,a.qz,a.Ol,a.Ol,a.Hv,a.Hv;class o extends n.l4{constructor(e){super(e,i[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,o.prototype)}}function s(e){return new o(e)}},4734:(e,t,r)=>{"use strict";r.d(t,{$h:()=>d,E:()=>g,Hv:()=>C,LB:()=>a,Ol:()=>E,Oz:()=>i,RV:()=>n,TU:()=>p,To:()=>s,U9:()=>T,d6:()=>f,dK:()=>y,dL:()=>h,hI:()=>b,i1:()=>w,nm:()=>u,o_:()=>v,qz:()=>_,vE:()=>c,yH:()=>o,z_:()=>l,zx:()=>m});const n="redirect_uri_empty",a="claims_request_parsing_error",i="authority_uri_insecure",o="url_parse_error",s="empty_url_error",c="empty_input_scopes_error",l="invalid_prompt_value",u="invalid_claims",h="token_request_empty",d="logout_request_empty",f="invalid_code_challenge_method",p="pkce_params_missing",g="invalid_cloud_discovery_metadata",m="invalid_authority_metadata",v="untrusted_authority",y="missing_ssh_jwk",b="missing_ssh_kid",T="missing_nonce_authentication_header",w="invalid_authentication_header",_="cannot_set_OIDCOptions",E="cannot_allow_native_broker",C="authority_mismatch"},7561:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>u,Yo:()=>l,ip:()=>h});var n=r(825),a=r(4430),i=r(8970);const o=[i.tZ,i.Mo,i.kk],s=["message_only","additional_action","basic_action","user_password_expired","consent_required"],c={[i.I2]:"No refresh token found in the cache. Please sign-in.",[i.QP]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."};i.I2,c[i.I2],i.QP,c[i.QP];class l extends a.l4{constructor(e,t,r,a,i,o,s){super(e,t,r),Object.setPrototypeOf(this,l.prototype),this.timestamp=a||n.gT.EMPTY_STRING,this.traceId=i||n.gT.EMPTY_STRING,this.correlationId=o||n.gT.EMPTY_STRING,this.claims=s||n.gT.EMPTY_STRING,this.name="InteractionRequiredAuthError"}}function u(e,t,r){const n=!!e&&o.indexOf(e)>-1,a=!!r&&s.indexOf(r)>-1,i=!!t&&o.some((e=>t.indexOf(e)>-1));return n||i||a}function h(e){return new l(e,c[e])}},8970:(e,t,r)=>{"use strict";r.d(t,{I2:()=>n,Mo:()=>o,QP:()=>a,kk:()=>s,tZ:()=>i});const n="no_tokens_found",a="native_account_unavailable",i="interaction_required",o="consent_required",s="login_required"},9632:(e,t,r)=>{"use strict";r.d(t,{n:()=>a});var n=r(4430);class a extends n.l4{constructor(e,t,r){super(e,t,r),this.name="ServerError",Object.setPrototypeOf(this,a.prototype)}}},9684:(e,t,r)=>{"use strict";r.d(t,{Y:()=>i,i:()=>n});var n,a=r(825);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(n||(n={}));class i{constructor(e,t,r){this.level=n.Info;const o=e||i.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||(()=>{}),this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level="number"===typeof o.logLevel?o.logLevel:n.Info,this.correlationId=o.correlationId||a.gT.EMPTY_STRING,this.packageName=t||a.gT.EMPTY_STRING,this.packageVersion=r||a.gT.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:n.Info}}clone(e,t,r){return new i({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const r=(new Date).toUTCString(),a="[".concat(r,"] : [").concat(t.correlationId||this.correlationId||"","]"),i="".concat(a," : ").concat(this.packageName,"@").concat(this.packageVersion," : ").concat(n[t.logLevel]," - ").concat(e);this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:n.Error,containsPii:!1,correlationId:t||a.gT.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:n.Error,containsPii:!0,correlationId:t||a.gT.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:n.Warning,containsPii:!1,correlationId:t||a.gT.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:n.Warning,containsPii:!0,correlationId:t||a.gT.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:n.Info,containsPii:!1,correlationId:t||a.gT.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:n.Info,containsPii:!0,correlationId:t||a.gT.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:n.Verbose,containsPii:!1,correlationId:t||a.gT.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:n.Verbose,containsPii:!0,correlationId:t||a.gT.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:n.Trace,containsPii:!1,correlationId:t||a.gT.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:n.Trace,containsPii:!0,correlationId:t||a.gT.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}},1556:(e,t,r)=>{"use strict";r.d(t,{i:()=>a,u:()=>n});const n="@azure/msal-common",a="14.4.0"},4096:(e,t,r)=>{"use strict";r.d(t,{i:()=>l});var n=r(9050),a=r(8051),i=r(2200),o=r(825),s=r(4734),c=r(3932);class l{constructor(e){const t=e?a.x.trimArrayEntries([...e]):[],r=t?a.x.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach((e=>this.scopes.add(e)))}static fromString(e){const t=(e||o.gT.EMPTY_STRING).split(" ");return new l(t)}static createSearchScopes(e){const t=new l(e);return t.containsOnlyOIDCScopes()?t.removeScope(o.gT.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw(0,n.ei)(s.vE)}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new l(t);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((e=>this.containsScope(e))))}containsOnlyOIDCScopes(){let e=0;return o.$f.forEach((t=>{this.containsScope(t)&&(e+=1)})),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach((e=>this.appendScope(e)))}catch(t){throw(0,i.zP)(c.f4)}}removeScope(e){if(!e)throw(0,i.zP)(c.v1);this.scopes.delete(e.trim())}removeOIDCScopes(){o.$f.forEach((e=>{this.scopes.delete(e)}))}unionScopeSets(e){if(!e)throw(0,i.zP)(c.S);const t=new Set;return e.scopes.forEach((e=>t.add(e.toLowerCase()))),this.scopes.forEach((e=>t.add(e.toLowerCase()))),t}intersectingScopeSets(e){if(!e)throw(0,i.zP)(c.S);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach((t=>e.push(t))),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return o.gT.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}},2346:(e,t,r)=>{"use strict";r.d(t,{$L:()=>a,Ak:()=>n});const n={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromiseMeasurement",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},a={NotStarted:0,InProgress:1,Completed:2};new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT"])},7438:(e,t,r)=>{"use strict";r.d(t,{G:()=>c});var n=r(9050),a=r(8051),i=r(825),o=r(9911),s=r(4734);class c{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw(0,n.ei)(s.To);e.includes("#")||(this._urlString=c.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return a.x.endsWith(t,"?")?t=t.slice(0,-1):a.x.endsWith(t,"?/")&&(t=t.slice(0,-2)),a.x.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(t){throw(0,n.ei)(s.yH)}if(!e.HostNameAndPort||!e.PathSegments)throw(0,n.ei)(s.yH);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw(0,n.ei)(s.Oz)}static appendQueryString(e,t){return t?e.indexOf("?")<0?"".concat(e,"?").concat(t):"".concat(e,"&").concat(t):e}static removeHashFromUrl(e){return c.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==i.Nb.COMMON&&r[0]!==i.Nb.ORGANIZATIONS||(r[0]=e),c.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw(0,n.ei)(s.yH);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let a=r.AbsolutePath.split("/");return a=a.filter((e=>e&&e.length>0)),r.PathSegments=a,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw(0,n.ei)(s.yH);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===i.gT.FORWARD_SLASH){const r=new c(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new c(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!(0,o.F)(e)}}},825:(e,t,r)=>{"use strict";r.d(t,{$f:()=>o,As:()=>h,Bv:()=>b,D1:()=>R,Fo:()=>u,Ge:()=>O,HN:()=>S,NJ:()=>d,Nb:()=>l,QU:()=>C,SZ:()=>s,To:()=>M,VO:()=>f,VX:()=>p,Vi:()=>c,W:()=>x,YY:()=>N,bb:()=>I,ch:()=>E,d3:()=>T,dg:()=>w,f_:()=>i,gT:()=>n,hO:()=>A,iR:()=>y,ki:()=>P,oj:()=>a,pQ:()=>k,qJ:()=>v,rg:()=>g,sR:()=>_,vw:()=>m,xd:()=>L});const n={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},a={SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},i=[n.OPENID_SCOPE,n.PROFILE_SCOPE,n.OFFLINE_ACCESS_SCOPE],o=[...i,n.EMAIL_SCOPE],s={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},c={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},l={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},u={CLIENT_ID:"client_id",REDIRECT_URI:"redirect_uri",RESPONSE_TYPE:"response_type",RESPONSE_MODE:"response_mode",GRANT_TYPE:"grant_type",CLAIMS:"claims",SCOPE:"scope",ERROR:"error",ERROR_DESCRIPTION:"error_description",ACCESS_TOKEN:"access_token",ID_TOKEN:"id_token",REFRESH_TOKEN:"refresh_token",EXPIRES_IN:"expires_in",STATE:"state",NONCE:"nonce",PROMPT:"prompt",SESSION_STATE:"session_state",CLIENT_INFO:"client_info",CODE:"code",CODE_CHALLENGE:"code_challenge",CODE_CHALLENGE_METHOD:"code_challenge_method",CODE_VERIFIER:"code_verifier",CLIENT_REQUEST_ID:"client-request-id",X_CLIENT_SKU:"x-client-SKU",X_CLIENT_VER:"x-client-VER",X_CLIENT_OS:"x-client-OS",X_CLIENT_CPU:"x-client-CPU",X_CLIENT_CURR_TELEM:"x-client-current-telemetry",X_CLIENT_LAST_TELEM:"x-client-last-telemetry",X_MS_LIB_CAPABILITY:"x-ms-lib-capability",X_APP_NAME:"x-app-name",X_APP_VER:"x-app-ver",POST_LOGOUT_URI:"post_logout_redirect_uri",ID_TOKEN_HINT:"id_token_hint",DEVICE_CODE:"device_code",CLIENT_SECRET:"client_secret",CLIENT_ASSERTION:"client_assertion",CLIENT_ASSERTION_TYPE:"client_assertion_type",TOKEN_TYPE:"token_type",REQ_CNF:"req_cnf",OBO_ASSERTION:"assertion",REQUESTED_TOKEN_USE:"requested_token_use",ON_BEHALF_OF:"on_behalf_of",FOCI:"foci",CCS_HEADER:"X-AnchorMailbox",RETURN_SPA_CODE:"return_spa_code",NATIVE_BROKER:"nativebroker",LOGOUT_HINT:"logout_hint"},h={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},d={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},f={ACCOUNT:"account",SID:"sid",LOGIN_HINT:"login_hint",ID_TOKEN:"id_token",DOMAIN_HINT:"domain_hint",ORGANIZATIONS:"organizations",CONSUMERS:"consumers",ACCOUNT_ID:"accountIdentifier",HOMEACCOUNT_ID:"homeAccountIdentifier"},p={PLAIN:"plain",S256:"S256"},g={QUERY:"query",FRAGMENT:"fragment"},m={...g,FORM_POST:"form_post"},v={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},y={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},b={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},T={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},w="appmetadata",_="client_info",E="1",C={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400},k={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},S={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},A={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},I={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},R={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},O={username:"username",password:"password"},N={httpSuccess:200,httpBadRequest:400},x={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},P={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},M={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},L={Jwt:"JWT",Jwk:"JWK",Pop:"pop"}},8051:(e,t,r)=>{"use strict";r.d(t,{x:()=>n});class n{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(t){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach((e=>{if(e.trim()){const[r,a]=e.split(/=(.+)/g,2);r&&a&&(t[n(r)]=n(a))}})),t}static trimArrayEntries(e){return e.map((e=>e.trim()))}static removeEmptyStringsFromArray(e){return e.filter((e=>!!e))}static jsonParseHelper(e){try{return JSON.parse(e)}catch(t){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}},6378:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});class n{static nowSeconds(){return Math.round((new Date).getTime()/1e3)}static isTokenExpired(e,t){const r=Number(e)||0;return n.nowSeconds()+t>r}static wasClockTurnedBack(e){return Number(e)>n.nowSeconds()}static delay(e,t){return new Promise((r=>setTimeout((()=>r(t)),e)))}}},9911:(e,t,r)=>{"use strict";r.d(t,{F:()=>o,q:()=>i});var n=r(2200),a=r(3932);function i(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function o(e){if(!e||e.indexOf("=")<0)return null;try{const t=i(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.error||r.error_description||r.state)return r}catch(t){throw(0,n.zP)(a.b4)}return null}},9794:e=>{"use strict";e.exports={version:"1.0.34"}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"===typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"===typeof n.then)return n}var i=Object.create(null);r.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,r.d(i,o),i}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>"static/js/"+e+".0ea319e6.chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="admeco3:";r.l=(n,a,i,o)=>{if(e[n])e[n].push(a);else{var s,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var h=l[u];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+i){s=h;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[a];var d=(t,r)=>{s.onerror=s.onload=null,clearTimeout(f);var a=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((e=>e(r))),t)return t(r)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/admeco3/",(()=>{var e={179:0};r.f.j=(t,n)=>{var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise(((r,n)=>a=e[t]=[r,n]));n.push(a[2]=i);var o=r.p+r.u(t),s=new Error;r.l(o,(n=>{if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var a,i,o=n[0],s=n[1],c=n[2],l=0;if(o.some((t=>0!==e[t]))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(c)c(r)}for(t&&t(n);l<o.length;l++)i=o[l],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkadmeco3=self.webpackChunkadmeco3||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e,t=r(2791),n=r.t(t,2),a=r(1250);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const o="popstate";function s(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function c(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function l(e,t){return{usr:e.state,key:e.key,idx:t}}function u(e,t,r,n){return void 0===r&&(r=null),i({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?d(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function h(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function d(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function f(t,r,n,a){void 0===a&&(a={});let{window:c=document.defaultView,v5Compat:d=!1}=a,f=c.history,p=e.Pop,g=null,m=v();function v(){return(f.state||{idx:null}).idx}function y(){p=e.Pop;let t=v(),r=null==t?null:t-m;m=t,g&&g({action:p,location:T.location,delta:r})}function b(e){let t="null"!==c.location.origin?c.location.origin:c.location.href,r="string"===typeof e?e:h(e);return s(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==m&&(m=0,f.replaceState(i({},f.state,{idx:m}),""));let T={get action(){return p},get location(){return t(c,f)},listen(e){if(g)throw new Error("A history only accepts one active listener");return c.addEventListener(o,y),g=e,()=>{c.removeEventListener(o,y),g=null}},createHref:e=>r(c,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,r){p=e.Push;let a=u(T.location,t,r);n&&n(a,t),m=v()+1;let i=l(a,m),o=T.createHref(a);try{f.pushState(i,"",o)}catch(s){if(s instanceof DOMException&&"DataCloneError"===s.name)throw s;c.location.assign(o)}d&&g&&g({action:p,location:T.location,delta:1})},replace:function(t,r){p=e.Replace;let a=u(T.location,t,r);n&&n(a,t),m=v();let i=l(a,m),o=T.createHref(a);f.replaceState(i,"",o),d&&g&&g({action:p,location:T.location,delta:0})},go:e=>f.go(e)};return T}var p;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(p||(p={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function g(e,t,r){void 0===r&&(r="/");let n=R(("string"===typeof t?d(t):t).pathname||"/",r);if(null==n)return null;let a=m(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let i=null;for(let o=0;null==i&&o<a.length;++o)i=S(a[o],I(n));return i}function m(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");let a=(e,a,i)=>{let o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(s(o.relativePath.startsWith(n),'Absolute route path "'+o.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(n.length));let c=P([n,o.relativePath]),l=r.concat(o);e.children&&e.children.length>0&&(s(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+c+'".'),m(e.children,t,l,c)),(null!=e.path||e.index)&&t.push({path:c,score:k(c,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let n of v(e.path))a(e,t,n);else a(e,t)})),t}function v(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(0===n.length)return a?[i,""]:[i];let o=v(n.join("/")),s=[];return s.push(...o.map((e=>""===e?i:[i,e].join("/")))),a&&s.push(...o),s.map((t=>e.startsWith("/")&&""===t?"/":t))}const y=/^:\w+$/,b=3,T=2,w=1,_=10,E=-2,C=e=>"*"===e;function k(e,t){let r=e.split("/"),n=r.length;return r.some(C)&&(n+=E),t&&(n+=T),r.filter((e=>!C(e))).reduce(((e,t)=>e+(y.test(t)?b:""===t?w:_)),n)}function S(e,t){let{routesMeta:r}=e,n={},a="/",i=[];for(let o=0;o<r.length;++o){let e=r[o],s=o===r.length-1,c="/"===a?t:t.slice(a.length)||"/",l=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:s},c);if(!l)return null;Object.assign(n,l.params);let u=e.route;i.push({params:n,pathname:P([a,l.pathname]),pathnameBase:M(P([a,l.pathnameBase])),route:u}),"/"!==l.pathnameBase&&(a=P([a,l.pathnameBase]))}return i}function A(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);c("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,n]}(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:n.reduce(((e,t,r)=>{let{paramName:n,isOptional:a}=t;if("*"===n){let e=s[r]||"";o=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[r];return e[n]=a&&!l?void 0:function(e,t){try{return decodeURIComponent(e)}catch(r){return c(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+r+")."),e}}(l||"",n),e}),{}),pathname:i,pathnameBase:o,pattern:e}}function I(e){try{return decodeURI(e)}catch(t){return c(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function O(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function N(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function x(e,t,r,n){let a;void 0===n&&(n=!1),"string"===typeof e?a=d(e):(a=i({},e),s(!a.pathname||!a.pathname.includes("?"),O("?","pathname","search",a)),s(!a.pathname||!a.pathname.includes("#"),O("#","pathname","hash",a)),s(!a.search||!a.search.includes("#"),O("#","search","hash",a)));let o,c=""===e||""===a.pathname,l=c?"/":a.pathname;if(n||null==l)o=r;else{let e=t.length-1;if(l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}o=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:r,search:n="",hash:a=""}="string"===typeof e?d(e):e,i=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:i,search:L(n),hash:D(a)}}(a,o),h=l&&"/"!==l&&l.endsWith("/"),f=(c||"."===l)&&r.endsWith("/");return u.pathname.endsWith("/")||!h&&!f||(u.pathname+="/"),u}const P=e=>e.join("/").replace(/\/\/+/g,"/"),M=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),L=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",D=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function F(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const U=["post","put","patch","delete"],H=(new Set(U),["get",...U]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},B.apply(this,arguments)}const j=t.createContext(null);const z=t.createContext(null);const q=t.createContext(null);const K=t.createContext(null);const G=t.createContext({outlet:null,matches:[],isDataRoute:!1});const V=t.createContext(null);function W(){return null!=t.useContext(K)}function Y(){return W()||s(!1),t.useContext(K).location}function Q(e){t.useContext(q).static||t.useLayoutEffect(e)}function J(){let{isDataRoute:e}=t.useContext(G);return e?function(){let{router:e}=se(ie.UseNavigateStable),r=le(oe.UseNavigateStable),n=t.useRef(!1);return Q((()=>{n.current=!0})),t.useCallback((function(t,a){void 0===a&&(a={}),n.current&&("number"===typeof t?e.navigate(t):e.navigate(t,B({fromRouteId:r},a)))}),[e,r])}():function(){W()||s(!1);let e=t.useContext(j),{basename:r,navigator:n}=t.useContext(q),{matches:a}=t.useContext(G),{pathname:i}=Y(),o=JSON.stringify(N(a).map((e=>e.pathnameBase))),c=t.useRef(!1);return Q((()=>{c.current=!0})),t.useCallback((function(t,a){if(void 0===a&&(a={}),!c.current)return;if("number"===typeof t)return void n.go(t);let s=x(t,JSON.parse(o),i,"path"===a.relative);null==e&&"/"!==r&&(s.pathname="/"===s.pathname?r:P([r,s.pathname])),(a.replace?n.replace:n.push)(s,a.state,a)}),[r,n,o,i,e])}()}function X(e,r){let{relative:n}=void 0===r?{}:r,{matches:a}=t.useContext(G),{pathname:i}=Y(),o=JSON.stringify(N(a).map((e=>e.pathnameBase)));return t.useMemo((()=>x(e,JSON.parse(o),i,"path"===n)),[e,o,i,n])}function Z(r,n,a){W()||s(!1);let{navigator:i}=t.useContext(q),{matches:o}=t.useContext(G),c=o[o.length-1],l=c?c.params:{},u=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let h,f=Y();if(n){var p;let e="string"===typeof n?d(n):n;"/"===u||(null==(p=e.pathname)?void 0:p.startsWith(u))||s(!1),h=e}else h=f;let m=h.pathname||"/",v=g(r,{pathname:"/"===u?m:m.slice(u.length)||"/"});let y=ae(v&&v.map((e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:P([u,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:P([u,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),o,a);return n&&y?t.createElement(K.Provider,{value:{location:B({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:e.Pop}},y):y}function ee(){let e=function(){var e;let r=t.useContext(V),n=ce(oe.UseRouteError),a=le(oe.UseRouteError);if(r)return r;return null==(e=n.errors)?void 0:e[a]}(),r=F(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},r),n?t.createElement("pre",{style:i},n):null,null)}const te=t.createElement(ee,null);class re extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error?t.createElement(G.Provider,{value:this.props.routeContext},t.createElement(V.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ne(e){let{routeContext:r,match:n,children:a}=e,i=t.useContext(j);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),t.createElement(G.Provider,{value:r},a)}function ae(e,r,n){var a;if(void 0===r&&(r=[]),void 0===n&&(n=null),null==e){var i;if(null==(i=n)||!i.errors)return null;e=n.matches}let o=e,c=null==(a=n)?void 0:a.errors;if(null!=c){let e=o.findIndex((e=>e.route.id&&(null==c?void 0:c[e.route.id])));e>=0||s(!1),o=o.slice(0,Math.min(o.length,e+1))}return o.reduceRight(((e,a,i)=>{let s=a.route.id?null==c?void 0:c[a.route.id]:null,l=null;n&&(l=a.route.errorElement||te);let u=r.concat(o.slice(0,i+1)),h=()=>{let r;return r=s?l:a.route.Component?t.createElement(a.route.Component,null):a.route.element?a.route.element:e,t.createElement(ne,{match:a,routeContext:{outlet:e,matches:u,isDataRoute:null!=n},children:r})};return n&&(a.route.ErrorBoundary||a.route.errorElement||0===i)?t.createElement(re,{location:n.location,revalidation:n.revalidation,component:l,error:s,children:h(),routeContext:{outlet:null,matches:u,isDataRoute:!0}}):h()}),null)}var ie=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ie||{}),oe=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(oe||{});function se(e){let r=t.useContext(j);return r||s(!1),r}function ce(e){let r=t.useContext(z);return r||s(!1),r}function le(e){let r=function(e){let r=t.useContext(G);return r||s(!1),r}(),n=r.matches[r.matches.length-1];return n.route.id||s(!1),n.route.id}n.startTransition;function ue(e){s(!1)}function he(r){let{basename:n="/",children:a=null,location:i,navigationType:o=e.Pop,navigator:c,static:l=!1}=r;W()&&s(!1);let u=n.replace(/^\/*/,"/"),h=t.useMemo((()=>({basename:u,navigator:c,static:l})),[u,c,l]);"string"===typeof i&&(i=d(i));let{pathname:f="/",search:p="",hash:g="",state:m=null,key:v="default"}=i,y=t.useMemo((()=>{let e=R(f,u);return null==e?null:{location:{pathname:e,search:p,hash:g,state:m,key:v},navigationType:o}}),[u,f,p,g,m,v,o]);return null==y?null:t.createElement(q.Provider,{value:h},t.createElement(K.Provider,{children:a,value:y}))}function de(e){let{children:t,location:r}=e;return Z(fe(t),r)}new Promise((()=>{}));t.Component;function fe(e,r){void 0===r&&(r=[]);let n=[];return t.Children.forEach(e,((e,a)=>{if(!t.isValidElement(e))return;let i=[...r,a];if(e.type===t.Fragment)return void n.push.apply(n,fe(e.props.children,i));e.type!==ue&&s(!1),e.props.index&&e.props.children&&s(!1);let o={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=fe(e.props.children,i)),n.push(o)})),n}var pe={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ge=t.createContext&&t.createContext(pe),me=function(){return me=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},me.apply(this,arguments)},ve=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r};function ye(e){return e&&e.map((function(e,r){return t.createElement(e.tag,me({key:r},e.attr),ye(e.child))}))}function be(e){return function(r){return t.createElement(Te,me({attr:me({},e.attr)},r),ye(e.child))}}function Te(e){var r=function(r){var n,a=e.attr,i=e.size,o=e.title,s=ve(e,["attr","size","title"]),c=i||r.size||"1em";return r.className&&(n=r.className),e.className&&(n=(n?n+" ":"")+e.className),t.createElement("svg",me({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,s,{className:n,style:me(me({color:e.color||r.color},r.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),o&&t.createElement("title",null,o),e.children)};return void 0!==ge?t.createElement(ge.Consumer,null,(function(e){return r(e)})):r(pe)}function we(e){return be({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"}}]})(e)}function _e(e){return be({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M858.9 689L530.5 308.2c-9.4-10.9-27.5-10.9-37 0L165.1 689c-12.2 14.2-1.2 35 18.5 35h656.8c19.7 0 30.7-20.8 18.5-35z"}}]})(e)}function Ee(e){return be({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"}}]})(e)}const Ce=r.p+"static/media/sti_logo.0ae7eff90a155fb9782b.png";class ke extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",r=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=r}}class Se extends ke{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ae extends ke{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ie extends ke{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Re=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};class Oe{constructor(e){let{headers:t={},customFetch:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.t.bind(r,526,23)).then((e=>{let{default:r}=e;return r(...t)}))}:fetch),function(){return t(...arguments)}})(n)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;return Re(this,void 0,void 0,(function*(){try{const{headers:n,method:a,body:i}=t;let o,s={};i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!==typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(s["Content-Type"]="application/octet-stream",o=i):"string"===typeof i?(s["Content-Type"]="text/plain",o=i):"undefined"!==typeof FormData&&i instanceof FormData?o=i:(s["Content-Type"]="application/json",o=JSON.stringify(i)));const c=yield this.fetch("".concat(this.url,"/").concat(e),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},s),this.headers),n),body:o}).catch((e=>{throw new Se(e)})),l=c.headers.get("x-relay-error");if(l&&"true"===l)throw new Ae(c);if(!c.ok)throw new Ie(c);let u,h=(null!==(r=c.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return u="application/json"===h?yield c.json():"application/octet-stream"===h?yield c.blob():"multipart/form-data"===h?yield c.formData():yield c.text(),{data:u,error:null}}catch(n){return{data:null,error:n}}}))}}var Ne=r(526),xe=r.n(Ne);class Pe{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=xe():this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,r,n;let a=null,i=null,o=null,s=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),l=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&l&&l.length>1&&(o=parseInt(l[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(a={code:"PGRST116",details:"Results contain ".concat(i.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,o=null,s=406,c="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(i=[],a=null,s=200,c="OK")}catch(l){404===e.status&&""===t?(s=204,c="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(n=null===a||void 0===a?void 0:a.details)||void 0===n?void 0:n.includes("0 rows"))&&(a=null,s=200,c="OK"),a&&this.shouldThrowOnError)throw a}return{error:a,data:i,count:o,status:s,statusText:c}}));return this.shouldThrowOnError||(r=r.catch((e=>{var t,r,n;return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:"".concat(null!==(r=null===e||void 0===e?void 0:e.stack)&&void 0!==r?r:""),hint:"",code:"".concat(null!==(n=null===e||void 0===e?void 0:e.code)&&void 0!==n?n:"")},data:null,count:null,status:0,statusText:""}}))),r.then(e,t)}}class Me extends Pe{select(e){let t=!1;const r=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:r,foreignTable:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=n?"".concat(n,".order"):"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,"".concat(i?"".concat(i,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===r?"":r?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="undefined"===typeof t?"limit":"".concat(t,".limit");return this.url.searchParams.set(r,"".concat(e)),this}range(e,t){let{foreignTable:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n="undefined"===typeof r?"offset":"".concat(r,".offset"),a="undefined"===typeof r?"limit":"".concat(r,".limit");return this.url.searchParams.set(n,"".concat(e)),this.url.searchParams.set(a,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:i="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),s=this.headers.Accept;return this.headers.Accept="application/vnd.pgrst.plan+".concat(i,'; for="').concat(s,'"; options=').concat(o,";"),this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Le extends Me{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const r=t.map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e))).join(",");return this.url.searchParams.append(e,"in.(".concat(r,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:r,type:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";"plain"===n?a="pl":"phrase"===n?a="ph":"websearch"===n&&(a="w");const i=void 0===r?"":"(".concat(r,")");return this.url.searchParams.append(e,"".concat(a,"fts").concat(i,".").concat(t)),this}match(e){return Object.entries(e).forEach((e=>{let[t,r]=e;this.url.searchParams.append(t,"eq.".concat(r))})),this}not(e,t,r){return this.url.searchParams.append(e,"not.".concat(t,".").concat(r)),this}or(e){let{foreignTable:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t?"".concat(t,".or"):"or";return this.url.searchParams.append(r,"(".concat(e,")")),this}filter(e,t,r){return this.url.searchParams.append(e,"".concat(t,".").concat(r)),this}}class De{constructor(e,t){let{headers:r={},schema:n,fetch:a}=t;this.url=e,this.headers=r,this.schema=n,this.fetch=a}select(e){let{head:t=!1,count:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t?"HEAD":"GET";let a=!1;const i=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!a?"":('"'===e&&(a=!a),e))).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer="count=".concat(r)),new Le({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push("count=".concat(t)),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>'"'.concat(e,'"')));this.url.searchParams.set("columns",e.join(","))}}return new Le({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=["resolution=".concat(r?"ignore":"merge","-duplicates")];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push("count=".concat(n)),a||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>'"'.concat(e,'"')));this.url.searchParams.set("columns",e.join(","))}}return new Le({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push("count=".concat(t)),this.headers.Prefer=r.join(","),new Le({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push("count=".concat(e)),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Le({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Fe={"X-Client-Info":"postgrest-js/".concat("1.8.5")};class Ue{constructor(e){let{headers:t={},schema:r,fetch:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},Fe),t),this.schemaName=r,this.fetch=n}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new De(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Ue(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:n=!1,count:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new URL("".concat(this.url,"/rpc/").concat(e));let o;n?(t="HEAD",Object.entries(r).forEach((e=>{let[t,r]=e;i.searchParams.append(t,"".concat(r))}))):(t="POST",o=r);const s=Object.assign({},this.headers);return a&&(s.Prefer="count=".concat(a)),new Le({method:t,url:i,headers:s,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}}var He=r(5087);const Be={"X-Client-Info":"realtime-js/".concat("2.8.4")};var je,ze,qe,Ke,Ge,Ve,We;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(je||(je={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(ze||(ze={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(qe||(qe={})),function(e){e.websocket="websocket"}(Ke||(Ke={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(Ge||(Ge={}));class Ye{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}class $e{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=r.decode(e.slice(i,i+n));i+=n;const s=r.decode(e.slice(i,i+a));i+=a;return{ref:null,topic:o,event:s,payload:JSON.parse(r.decode(e.slice(i,e.byteLength)))}}}class Qe{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:r}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(r)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(Ve||(Ve={}));class Je{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},(e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Je.syncState(this.state,e,t,r),this.pendingDiffs.forEach((e=>{this.state=Je.syncDiff(this.state,e,t,r)})),this.pendingDiffs=[],n()})),this.channel._on(r.diff,{},(e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Je.syncDiff(this.state,e,t,r),n())})),this.onJoin(((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})})),this.onLeave(((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,r,n){const a=this.cloneDeep(e),i=this.transformState(t),o={},s={};return this.map(a,((e,t)=>{i[e]||(s[e]=t)})),this.map(i,((e,t)=>{const r=a[e];if(r){const n=t.map((e=>e.presence_ref)),a=r.map((e=>e.presence_ref)),i=t.filter((e=>a.indexOf(e.presence_ref)<0)),c=r.filter((e=>n.indexOf(e.presence_ref)<0));i.length>0&&(o[e]=i),c.length>0&&(s[e]=c)}else o[e]=t})),this.syncDiff(a,{joins:o,leaves:s},r,n)}static syncDiff(e,t,r,n){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(a,((t,n)=>{var a;const i=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(n),i.length>0){const r=e[t].map((e=>e.presence_ref)),n=i.filter((e=>r.indexOf(e.presence_ref)<0));e[t].unshift(...n)}r(t,i,n)})),this.map(i,((t,r)=>{let a=e[t];if(!a)return;const i=r.map((e=>e.presence_ref));a=a.filter((e=>i.indexOf(e.presence_ref)<0)),e[t]=a,n(t,a,r),0===a.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((r=>t(r,e[r])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,r)=>{const n=e[r];return t[r]="metas"in n?n.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):n,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(We||(We={}));const Xe=function(e,t){var r;const n=null!==(r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((r,a)=>(r[a]=Ze(a,e,t,n),r)),{})},Ze=(e,t,r,n)=>{const a=t.find((t=>t.name===e)),i=null===a||void 0===a?void 0:a.type,o=r[e];return i&&!n.includes(i)?et(i,o):tt(o)},et=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return it(t,r)}switch(e){case We.bool:return rt(t);case We.float4:case We.float8:case We.int2:case We.int4:case We.int8:case We.numeric:case We.oid:return nt(t);case We.json:case We.jsonb:return at(t);case We.timestamp:return ot(t);case We.abstime:case We.date:case We.daterange:case We.int4range:case We.int8range:case We.money:case We.reltime:case We.text:case We.time:case We.timestamptz:case We.timetz:case We.tsrange:case We.tstzrange:default:return tt(t)}},tt=e=>e,rt=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},nt=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},at=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},it=(e,t)=>{if("string"!==typeof e)return e;const r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;const i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(a){n=i?i.split(","):[]}return n.map((e=>et(t,e)))}return e},ot=e=>"string"===typeof e?e.replace(" ","T"):e;var st,ct,lt;!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(st||(st={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes"}(ct||(ct={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(lt||(lt={}));class ut{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},r=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=ze.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new Qe(this,qe.join,this.params,this.timeout),this.rejoinTimer=new Ye((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=ze.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=ze.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=ze.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=ze.errored,this.rejoinTimer.scheduleTimeout())})),this._on(qe.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new Je(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:i}}=this.params;this._onError((t=>e&&e("CHANNEL_ERROR",t))),this._onClose((()=>e&&e("CLOSED")));const o={},s={broadcast:a,presence:i,postgres_changes:null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map((e=>e.filter)))&&void 0!==n?n:[]};this.socket.accessToken&&(o.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:s},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(t=>{let{postgres_changes:r}=t;var n;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0!==r){const t=this.bindings.postgres_changes,a=null!==(n=null===t||void 0===t?void 0:t.length)&&void 0!==n?n:0,i=[];for(let n=0;n<a;n++){const a=t[n],{filter:{event:o,schema:s,table:c,filter:l}}=a,u=r&&r[n];if(!u||u.event!==o||u.schema!==s||u.table!==c||u.filter!==l)return this.unsubscribe(),void(e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},a),{id:u.id}))}return this.bindings.postgres_changes=i,void(e&&e("SUBSCRIBED"))}e&&e("SUBSCRIBED")})).receive("error",(t=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{e&&e("TIMED_OUT")}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise((r=>{var n,a,i;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(a=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===a?void 0:a.broadcast)||void 0===i?void 0:i.ack)||r("ok"),o.receive("ok",(()=>r("ok"))),o.receive("timeout",(()=>r("timed out")))}));{const{event:i,payload:o}=e,s={method:"POST",headers:{apikey:null!==(r=this.socket.accessToken)&&void 0!==r?r:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(n=t.timeout)&&void 0!==n?n:this.timeout)).ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=ze.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(qe.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((r=>{const n=new Qe(this,qe.leave,{},e);n.receive("ok",(()=>{t(),r("ok")})).receive("timeout",(()=>{t(),r("timed out")})).receive("error",(()=>{r("error")})),n.send(),this._canPush()||n.trigger("ok",{})}))}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,r){const n=new AbortController,a=setTimeout((()=>n.abort()),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),i}_push(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let n=new Qe(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,a;const i=e.toLocaleLowerCase(),{close:o,error:s,leave:c,join:l}=qe;if(r&&[o,s,c,l].indexOf(i)>=0&&r!==this._joinRef())return;let u=this._onMessage(i,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter((e=>{var t,r,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===i})).map((e=>e.callback(u,r))):null===(a=this.bindings[i])||void 0===a||a.filter((e=>{var r,n,a,o,s,c;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,o=null===(r=e.filter)||void 0===r?void 0:r.event;return i&&(null===(n=t.ids)||void 0===n?void 0:n.includes(i))&&("*"===o||(null===o||void 0===o?void 0:o.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const r=null===(s=null===(o=null===e||void 0===e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===s?void 0:s.toLocaleLowerCase();return"*"===r||r===(null===(c=null===t||void 0===t?void 0:t.event)||void 0===c?void 0:c.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i})).map((e=>{if("object"===typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:n,type:a,errors:i}=e,o={schema:t,table:r,commit_timestamp:n,eventType:a,new:{},old:{},errors:i};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,r)}))}_isClosed(){return this.state===ze.closed}_isJoined(){return this.state===ze.joined}_isJoining(){return this.state===ze.joining}_isLeaving(){return this.state===ze.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,r){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter((e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&ut.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(qe.close,{},e)}_onError(e){this._on(qe.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ze.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Xe(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Xe(e.columns,e.old_record)),t}}const ht=()=>{};class dt{constructor(e,t){var n;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=Be,this.params={},this.timeout=1e4,this.transport=He.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=ht,this.conn=null,this.sendBuffer=[],this.serializer=new $e,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.t.bind(r,526,23)).then((e=>{let{default:r}=e;return r(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint="".concat(e,"/").concat(Ke.websocket),(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.transport)&&(this.transport=t.transport),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const a=null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey;a&&(this.accessToken=a),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ye((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case je.connecting:return Ge.Connecting;case je.open:return Ge.Open;case je.closing:return Ge.Closing;default:return Ge.Closed}}isConnected(){return this.connectionState()===Ge.Open}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const r=new ut("realtime:".concat(e),t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:n,ref:a}=e,i=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push","".concat(t," ").concat(r," (").concat(a,")"),n),this.isConnected()?i():this.sendBuffer.push(i)}setAuth(e){this.accessToken=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(qe.access_token,{access_token:e})}))}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:r,payload:n,ref:a}=e;(a&&a===this.pendingHeartbeatRef||r===(null===n||void 0===n?void 0:n.type))&&(this.pendingHeartbeatRef=null),this.log("receive","".concat(n.status||""," ").concat(t," ").concat(r," ").concat(a&&"("+a+")"||""),n),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(r,n,a))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}_onConnOpen(){this.log("transport","connected to ".concat(this._endPointURL())),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this._sendHeartbeat()),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(qe.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return"".concat(e).concat(r).concat(n)}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class ft extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function pt(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class gt extends ft{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class mt extends ft{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var vt=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};const yt=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.t.bind(r,526,23)).then((e=>{let{default:r}=e;return r(...t)}))}:fetch),function(){return t(...arguments)}};var bt=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};const Tt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),wt=(e,t)=>bt(void 0,void 0,void 0,(function*(){const n=yield vt(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(r.t.bind(r,526,23))).Response:Response}));e instanceof n?e.json().then((r=>{t(new gt(Tt(r),e.status||500))})).catch((e=>{t(new mt(Tt(e),e))})):t(new mt(Tt(e),e))})),_t=(e,t,r,n)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};function Et(e,t,r,n,a,i){return bt(this,void 0,void 0,(function*(){return new Promise(((o,s)=>{e(r,_t(t,n,a,i)).then((e=>{if(!e.ok)throw e;return(null===n||void 0===n?void 0:n.noResolveJson)?e:e.json()})).then((e=>o(e))).catch((e=>wt(e,s)))}))}))}function Ct(e,t,r,n){return bt(this,void 0,void 0,(function*(){return Et(e,"GET",t,r,n)}))}function kt(e,t,r,n,a){return bt(this,void 0,void 0,(function*(){return Et(e,"POST",t,n,a,r)}))}function St(e,t,r,n,a){return bt(this,void 0,void 0,(function*(){return Et(e,"DELETE",t,n,a,r)}))}var At=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};const It={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Rt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ot{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=r,this.fetch=yt(n)}uploadOrUpdate(e,t,r,n){return At(this,void 0,void 0,(function*(){try{let a;const i=Object.assign(Object.assign({},Rt),n),o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});"undefined"!==typeof Blob&&r instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),a.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(a=r,a.append("cacheControl",i.cacheControl)):(a=r,o["cache-control"]="max-age=".concat(i.cacheControl),o["content-type"]=i.contentType);const s=this._removeEmptyFolders(t),c=this._getFinalPath(s),l=yield this.fetch("".concat(this.url,"/object/").concat(c),Object.assign({method:e,body:a,headers:o},(null===i||void 0===i?void 0:i.duplex)?{duplex:i.duplex}:{}));if(l.ok)return{data:{path:s},error:null};return{data:null,error:yield l.json()}}catch(a){if(pt(a))return{data:null,error:a};throw a}}))}upload(e,t,r){return At(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,r)}))}uploadToSignedUrl(e,t,r,n){return At(this,void 0,void 0,(function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),o=new URL(this.url+"/object/upload/sign/".concat(i));o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Rt.upsert},n),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,i["cache-control"]="max-age=".concat(t.cacheControl),i["content-type"]=t.contentType);const s=yield this.fetch(o.toString(),{method:"PUT",body:e,headers:i});if(s.ok)return{data:{path:a},error:null};return{data:null,error:yield s.json()}}catch(s){if(pt(s))return{data:null,error:s};throw s}}))}createSignedUploadUrl(e){return At(this,void 0,void 0,(function*(){try{let t=this._getFinalPath(e);const r=yield kt(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(t),{},{headers:this.headers}),n=new URL(this.url+r.url),a=n.searchParams.get("token");if(!a)throw new ft("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:a},error:null}}catch(t){if(pt(t))return{data:null,error:t};throw t}}))}update(e,t,r){return At(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,r)}))}move(e,t){return At(this,void 0,void 0,(function*(){try{return{data:yield kt(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}}))}copy(e,t){return At(this,void 0,void 0,(function*(){try{return{data:{path:(yield kt(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}}))}createSignedUrl(e,t,r){return At(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e),a=yield kt(this.fetch,"".concat(this.url,"/object/sign/").concat(n),Object.assign({expiresIn:t},(null===r||void 0===r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const i=(null===r||void 0===r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return a={signedUrl:encodeURI("".concat(this.url).concat(a.signedURL).concat(i))},{data:a,error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}}))}createSignedUrls(e,t,r){return At(this,void 0,void 0,(function*(){try{const n=yield kt(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),a=(null===r||void 0===r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return{data:n.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(a)):null}))),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}}))}download(e,t){return At(this,void 0,void 0,(function*(){const r="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),a=n?"?".concat(n):"";try{const t=this._getFinalPath(e),n=yield Ct(this.fetch,"".concat(this.url,"/").concat(r,"/").concat(t).concat(a),{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(i){if(pt(i))return{data:null,error:i};throw i}}))}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==a&&n.push(a);const i="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==o&&n.push(o);let s=n.join("&");return""!==s&&(s="?".concat(s)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(i,"/public/").concat(r).concat(s))}}}remove(e){return At(this,void 0,void 0,(function*(){try{return{data:yield St(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(pt(t))return{data:null,error:t};throw t}}))}list(e,t,r){return At(this,void 0,void 0,(function*(){try{const n=Object.assign(Object.assign(Object.assign({},It),t),{prefix:e||""});return{data:yield kt(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),n,{headers:this.headers},r),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}}))}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e)}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const Nt={"X-Client-Info":"storage-js/".concat("2.5.4")};var xt=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};class Pt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},Nt),t),this.fetch=yt(r)}listBuckets(){return xt(this,void 0,void 0,(function*(){try{return{data:yield Ct(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(pt(e))return{data:null,error:e};throw e}}))}getBucket(e){return xt(this,void 0,void 0,(function*(){try{return{data:yield Ct(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if(pt(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return xt(this,void 0,void 0,(function*(){try{return{data:yield kt(this.fetch,"".concat(this.url,"/bucket"),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}}))}updateBucket(e,t){return xt(this,void 0,void 0,(function*(){try{const r=yield function(e,t,r,n,a){return bt(this,void 0,void 0,(function*(){return Et(e,"PUT",t,n,a,r)}))}(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:r,error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}}))}emptyBucket(e){return xt(this,void 0,void 0,(function*(){try{return{data:yield kt(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if(pt(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return xt(this,void 0,void 0,(function*(){try{return{data:yield St(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(pt(t))return{data:null,error:t};throw t}}))}}class Mt extends Pt{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new Ot(this.url,this.headers,e,this.fetch)}}let Lt="";Lt="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Dt={"X-Client-Info":"supabase-js-".concat(Lt,"/").concat("2.38.4")};var Ft=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};const Ut=e=>{let t;return t=e||("undefined"===typeof fetch?xe():fetch),function(){return t(...arguments)}},Ht=(e,t,r)=>{const n=Ut(r),a="undefined"===typeof Headers?Ne.Headers:Headers;return(r,i)=>Ft(void 0,void 0,void 0,(function*(){var o;const s=null!==(o=yield t())&&void 0!==o?o:e;let c=new a(null===i||void 0===i?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization","Bearer ".concat(s)),n(r,Object.assign(Object.assign({},i),{headers:c}))}))};const Bt=()=>"undefined"!==typeof document,jt={tested:!1,writable:!1},zt=()=>{if(!Bt())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(jt.tested)return jt.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),jt.tested=!0,jt.writable=!0}catch(t){jt.tested=!0,jt.writable=!1}return jt.writable};function qt(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach(((e,r)=>{t[r]=e}))}catch(n){}return r.searchParams.forEach(((e,r)=>{t[r]=e})),t}const Kt=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(r.t.bind(r,526,23)).then((e=>{let{default:r}=e;return r(...t)}))}:fetch),function(){return t(...arguments)}},Gt=e=>"object"===typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"===typeof e.json,Vt=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Wt=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(n){return r}},Yt=async(e,t)=>{await e.removeItem(t)};class $t{constructor(){this.promise=new $t.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Qt(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r,n,a,i,o,s,c,l="",u=0;for(e=e.replace("-","+").replace("_","/");u<e.length;)i=t.indexOf(e.charAt(u++)),o=t.indexOf(e.charAt(u++)),s=t.indexOf(e.charAt(u++)),c=t.indexOf(e.charAt(u++)),r=i<<2|o>>4,n=(15&o)<<4|s>>2,a=(3&s)<<6|c,l+=String.fromCharCode(r),64!=s&&0!=n&&(l+=String.fromCharCode(n)),64!=c&&0!=a&&(l+=String.fromCharCode(a));return l}(r))}function Jt(e){return("0"+e.toString(16)).substr(-2)}function Xt(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,Jt).join("")}async function Zt(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}$t.promiseConstructor=Promise;class er extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function tr(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class rr extends er{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class nr extends er{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ar extends er{constructor(e,t,r){super(e),this.name=t,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ir extends ar{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class or extends ar{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class sr extends ar{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class cr extends ar{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lr extends ar{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ur extends ar{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function hr(e){return tr(e)&&"AuthRetryableFetchError"===e.name}var dr=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r};const fr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pr=[502,503,504];async function gr(e){if(!Gt(e))throw new ur(fr(e),0);if(pr.includes(e.status))throw new ur(fr(e),e.status);let t;try{t=await e.json()}catch(r){throw new nr(fr(r),r)}throw new rr(fr(t),e.status||500)}const mr=(e,t,r,n)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function vr(e,t,r,n){var a;const i=Object.assign({},null===n||void 0===n?void 0:n.headers);(null===n||void 0===n?void 0:n.jwt)&&(i.Authorization="Bearer ".concat(n.jwt));const o=null!==(a=null===n||void 0===n?void 0:n.query)&&void 0!==a?a:{};(null===n||void 0===n?void 0:n.redirectTo)&&(o.redirect_to=n.redirectTo);const s=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await async function(e,t,r,n,a,i){const o=mr(t,n,a,i);let s;try{s=await e(r,o)}catch(c){throw console.error(c),new ur(fr(c),0)}s.ok||await gr(s);if(null===n||void 0===n?void 0:n.noResolveJson)return s;try{return await s.json()}catch(c){await gr(c)}}(e,t,r+s,{headers:i,noResolveJson:null===n||void 0===n?void 0:n.noResolveJson},{},null===n||void 0===n?void 0:n.body);return(null===n||void 0===n?void 0:n.xform)?null===n||void 0===n?void 0:n.xform(c):{data:Object.assign({},c),error:null}}function yr(e){var t;let r=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function br(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Tr(e){return{data:e,error:null}}function wr(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,o=dr(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},user:Object.assign({},o)},error:null}}function _r(e){return e}var Er=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r};class Cr{constructor(e){let{url:t="",headers:r={},fetch:n}=e;this.url=t,this.headers=r,this.fetch=Kt(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await vr(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(tr(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await vr(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:br})}catch(r){if(tr(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Er(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null===r||void 0===r?void 0:r.newEmail,delete n.newEmail),await vr(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:n,headers:this.headers,xform:wr,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(tr(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await vr(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:br})}catch(t){if(tr(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,a,i,o,s;try{const c={nextPage:null,lastPage:0,total:0},l=await vr(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==a?a:""},xform:_r});if(l.error)throw l.error;const u=await l.json(),h=null!==(i=l.headers.get("x-total-count"))&&void 0!==i?i:0,d=null!==(s=null===(o=l.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==s?s:[];return d.length>0&&(d.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);c["".concat(r,"Page")]=t})),c.total=parseInt(h)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(c){if(tr(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await vr(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:br})}catch(t){if(tr(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await vr(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:br})}catch(r){if(tr(r))return{data:{user:null},error:r};throw r}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await vr(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:br})}catch(r){if(tr(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await vr(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(tr(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await vr(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(tr(t))return{data:null,error:t};throw t}}}const kr="2.57.0",Sr={"X-Client-Info":"gotrue-js/".concat(kr)},Ar={getItem:e=>zt()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{zt()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{zt()&&globalThis.localStorage.removeItem(e)}};function Ir(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}globalThis&&zt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug");class Rr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Or={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Sr,flowType:"implicit",debug:!1},Nr=3e4;async function xr(e,t,r){return await r()}class Pr{constructor(e){var t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Pr.nextInstanceID,Pr.nextInstanceID+=1,this.instanceID>0&&Bt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Or),e);if(this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Cr({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Kt(r.fetch),this.lock=r.lock||xr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:zt()?this.storage=Ar:(this.memoryStorage={},this.storage=Ir(this.memoryStorage)):(this.memoryStorage={},this.storage=Ir(this.memoryStorage)),Bt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",n)}null===(t=this.broadcastChannel)||void 0===t||t.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger("GoTrueClient@".concat(this.instanceID," (").concat(kr,") ").concat((new Date).toISOString()),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){try{const e=!!Bt()&&await this._isPKCEFlow();if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:r}=await this._getSessionFromURL(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),await this._removeSession(),{error:r};const{session:n,redirectType:a}=t;return this._debug("#_initialize()","detected session in URL",n,"redirect type",a),await this._saveSession(n),setTimeout((async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return tr(e)?{error:e}:{error:new nr("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var t,r,n;try{let a;if(await this._removeSession(),"email"in e){const{email:r,password:n,options:i}=e;let o=null,s=null;if("pkce"===this.flowType){const e=Xt();await Vt(this.storage,"".concat(this.storageKey,"-code-verifier"),e),o=await Zt(e),s=e===o?"plain":"s256"}a=await vr(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null===i||void 0===i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken},code_challenge:o,code_challenge_method:s},xform:yr})}else{if(!("phone"in e))throw new sr("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:o}=e;a=await vr(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:i,data:null!==(r=null===o||void 0===o?void 0:o.data)&&void 0!==r?r:{},channel:null!==(n=null===o||void 0===o?void 0:o.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken}},xform:yr})}}const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const s=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:c,session:s},error:null}}catch(a){if(tr(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if(await this._removeSession(),"email"in e){const{email:r,password:n,options:a}=e;t=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:yr})}else{if(!("phone"in e))throw new sr("You must provide either an email or phone number and a password");{const{phone:r,password:n,options:a}=e;t=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:yr})}}const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:{user:r.user,session:r.session},error:n}):{data:{user:null,session:null},error:new or}}catch(t){if(tr(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,a;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Wt(this.storage,"".concat(this.storageKey,"-code-verifier")),{data:r,error:n}=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:yr});return await Yt(this.storage,"".concat(this.storageKey,"-code-verifier")),n?{data:{user:null,session:null},error:n}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:n}):{data:{user:null,session:null},error:new or}}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:r,token:n,access_token:a,nonce:i}=e,o=await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:r,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:yr}),{data:s,error:c}=o;return c?{data:{user:null,session:null},error:c}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:c}):{data:{user:null,session:null},error:new or}}catch(t){if(tr(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,a,i;try{if(await this._removeSession(),"email"in e){const{email:n,options:a}=e;let i=null,o=null;if("pkce"===this.flowType){const e=Xt();await Vt(this.storage,"".concat(this.storageKey,"-code-verifier"),e),i=await Zt(e),o=e===i?"plain":"s256"}const{error:s}=await vr(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:n,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(r=null===a||void 0===a?void 0:a.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:i,code_challenge_method:o},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:t,options:r}=e,{data:o,error:s}=await vr(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(n=null===r||void 0===r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(a=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},channel:null!==(i=null===r||void 0===r?void 0:r.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null===o||void 0===o?void 0:o.message_id},error:s}}throw new sr("You must provide either an email or phone number.")}catch(o){if(tr(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let n,a;"email_change"!==e.type&&"phone_change"!==e.type&&await this._removeSession(),"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:i,error:o}=await vr(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:yr});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const s=i.session,c=i.user;return(null===s||void 0===s?void 0:s.access_token)&&(await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:c,session:s},error:null}}catch(n){if(tr(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{await this._removeSession();let a=null,i=null;if("pkce"===this.flowType){const e=Xt();await Vt(this.storage,"".concat(this.storageKey,"-code-verifier"),e),a=await Zt(e),i=e===a?"plain":"s256"}return await vr(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:Tr})}catch(a){if(tr(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ir;const{error:n}=await vr(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}}))}catch(e){if(tr(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{"email_change"!=e.type&&"phone_change"!=e.type&&await this._removeSession();const t="".concat(this.url,"/resend");if("email"in e){const{email:r,type:n,options:a}=e,{error:i}=await vr(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:r,type:n,options:a}=e,{data:i,error:o}=await vr(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:o}}throw new sr("You must provide either an email or phone number and a type")}catch(t){if(tr(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock("lock:".concat(this.storageKey),e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Wt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()","session has".concat(r?"":" not"," expired"),"expires_at",e.expires_at),!r)return{data:{session:e},error:null};const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,(async()=>await this._getUser())))}async _getUser(e){try{return e?await vr(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:br}):await this._useSession((async e=>{var t,r;const{data:n,error:a}=e;if(a)throw a;return await vr(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(r=null===(t=n.session)||void 0===t?void 0:t.access_token)&&void 0!==r?r:void 0,xform:br})}))}catch(t){if(tr(t))return{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async r=>{const{data:n,error:a}=r;if(a)throw a;if(!n.session)throw new ir;const i=n.session;let o=null,s=null;if("pkce"===this.flowType&&null!=e.email){const e=Xt();await Vt(this.storage,"".concat(this.storageKey,"-code-verifier"),e),o=await Zt(e),s=e===o?"plain":"s256"}const{data:c,error:l}=await vr(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:s}),jwt:i.access_token,xform:br});if(l)throw l;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}))}catch(r){if(tr(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Qt(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ir;const t=Date.now()/1e3;let r=t,n=!0,a=null;const i=Qt(e.access_token);if(i.exp&&(r=i.exp,n=r<=t),n){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:n,error:i}=await this._getUser(e.access_token);if(i)throw i;a={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(tr(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var r;if(!e){const{data:n,error:a}=t;if(a)throw a;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new ir;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(tr(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!Bt())throw new cr("No browser detected.");if("implicit"===this.flowType&&!this._isImplicitGrantFlow())throw new cr("Not a valid implicit grant flow url.");if("pkce"==this.flowType&&!e)throw new lr("Not a valid PKCE flow url.");const t=qt(window.location.href);if(e){if(!t.code)throw new lr("No code detected.");const{data:e,error:r}=await this._exchangeCodeForSession(t.code);if(r)throw r;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:e.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new cr(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:r,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:o,expires_at:s,token_type:c}=t;if(!a||!o||!i||!c)throw new cr("No session defined in URL");const l=Math.round(Date.now()/1e3),u=parseInt(o);let h=l+u;s&&(h=parseInt(s));const d=h-l;1e3*d<=Nr&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(d,"s, should have been closer to ").concat(u,"s"));const f=h-u;l-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,h,l):l-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",f,h,l);const{data:p,error:g}=await this._getUser(a);if(g)throw g;const m={provider_token:r,provider_refresh_token:n,access_token:a,expires_in:u,expires_at:h,refresh_token:i,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:t.type},error:null}}catch(t){if(tr(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=qt(window.location.href);return!(!Bt()||!e.access_token&&!e.error_description)}async _isPKCEFlow(){const e=qt(window.location.href),t=await Wt(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var r;const{data:n,error:a}=t;if(a)return{error:a};const i=null===(r=n.session)||void 0===r?void 0:r.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return tr(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Yt(this.storage,"".concat(this.storageKey,"-code-verifier")),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession((async t=>{var r,n;try{const{data:{session:n},error:a}=t;if(a)throw a;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(a){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,n=null;if("pkce"===this.flowType){const e=Xt();await Vt(this.storage,"".concat(this.storageKey,"-code-verifier"),e),r=await Zt(e),n=e===r?"plain":"s256"}try{return await vr(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(tr(a))return{data:null,error:a};throw a}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const a=Date.now();return await(r=async r=>(await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*r),this._debug(t,"refreshing attempt",r),await vr(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:yr})),n=(e,t,r)=>r&&r.error&&hr(r.error)&&Date.now()+200*(e+1)-a<Nr,new Promise(((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await r(i);if(!n(i,null,t))return void e(t)}catch(a){if(!n(i,a))return void t(a)}})()})))}catch(a){if(this._debug(t,"error",a),tr(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var r,n}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Bt()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Wt(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r))return this._debug(t,"session is not valid"),void(null!==r&&await this._removeSession());const n=Math.round(Date.now()/1e3),a=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)<n+10;if(this._debug(t,"session has".concat(a?"":" not"," expired with margin of ").concat(10,"s")),a){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),hr(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(t,"error",r),void console.error(r)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ir;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(n,"begin");try{this.refreshingDeferred=new $t;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new ir;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(a){if(this._debug(n,"error",a),tr(a)){const e={session:null,error:a};return null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n="#_notifyAllSubscribers(".concat(e,")");this._debug(n,"begin",t,"broadcast = ".concat(r));try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],a=Array.from(this.stateChangeEmitters.values()).map((async r=>{try{await r.callback(e,t)}catch(a){n.push(a)}}));if(await Promise.all(a),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await this._persistSession(e)}_persistSession(e){return this._debug("#_persistSession()",e),Vt(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Yt(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Bt()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Nr);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*r.expires_at-t)/Nr);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(n," ticks, a tick lasts ").concat(Nr,"ms, refresh threshold is ").concat(3," ticks")),n<=3&&await this._callRefreshToken(r.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof Rr))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Bt()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t){const r=["provider=".concat(encodeURIComponent(e))];if((null===t||void 0===t?void 0:t.redirectTo)&&r.push("redirect_to=".concat(encodeURIComponent(t.redirectTo))),(null===t||void 0===t?void 0:t.scopes)&&r.push("scopes=".concat(encodeURIComponent(t.scopes))),"pkce"===this.flowType){const e=Xt();await Vt(this.storage,"".concat(this.storageKey,"-code-verifier"),e);const t=await Zt(e),n=e===t?"plain":"s256";this._debug("PKCE","code verifier","".concat(e.substring(0,5),"..."),"code challenge",t,"method",n);const a=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(t)),code_challenge_method:"".concat(encodeURIComponent(n))});r.push(a.toString())}if(null===t||void 0===t?void 0:t.queryParams){const e=new URLSearchParams(t.queryParams);r.push(e.toString())}return"".concat(this.url,"/authorize?").concat(r.join("&"))}async _unenroll(e){try{return await this._useSession((async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await vr(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token})}))}catch(t){if(tr(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var r,n;const{data:a,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:s}=await vr(this.fetch,"POST","".concat(this.url,"/factors"),{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:null===(r=null===a||void 0===a?void 0:a.session)||void 0===r?void 0:r.access_token});return s?{data:null,error:s}:((null===(n=null===o||void 0===o?void 0:o.totp)||void 0===n?void 0:n.qr_code)&&(o.totp.qr_code="data:image/svg+xml;utf-8,".concat(o.totp.qr_code)),{data:o,error:null})}))}catch(t){if(tr(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var r;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:o}=await vr(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})}))}catch(t){if(tr(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await vr(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{headers:this.headers,jwt:null===(r=null===n||void 0===n?void 0:n.session)||void 0===r?void 0:r.access_token})}))}catch(t){if(tr(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null===e||void 0===e?void 0:e.factors)||[],n=r.filter((e=>"totp"===e.factor_type&&"verified"===e.status));return{data:{all:r,totp:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,r;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(n.access_token);let o=null;i.aal&&(o=i.aal);let s=o;(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==r?r:[]).length>0&&(s="aal2");return{data:{currentLevel:o,nextLevel:s,currentAuthenticationMethods:i.amr||[]},error:null}}))))}}Pr.nextInstanceID=0;class Mr extends Pr{constructor(e){super(e)}}var Lr=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};const Dr={headers:Dt},Fr={schema:"public"},Ur={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Hr={};class Br{constructor(e,t,r){var n,a,i,o,s,c,l,u;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const h=e.replace(/\/$/,"");this.realtimeUrl="".concat(h,"/realtime/v1").replace(/^http/i,"ws"),this.authUrl="".concat(h,"/auth/v1"),this.storageUrl="".concat(h,"/storage/v1"),this.functionsUrl="".concat(h,"/functions/v1");const d="sb-".concat(new URL(this.authUrl).hostname.split(".")[0],"-auth-token"),f=function(e,t){const{db:r,auth:n,realtime:a,global:i}=e,{db:o,auth:s,realtime:c,global:l}=t;return{db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},s),n),realtime:Object.assign(Object.assign({},c),a),global:Object.assign(Object.assign({},l),i)}}(null!==r&&void 0!==r?r:{},{db:Fr,realtime:Hr,auth:Object.assign(Object.assign({},Ur),{storageKey:d}),global:Dr});this.storageKey=null!==(a=null===(n=f.auth)||void 0===n?void 0:n.storageKey)&&void 0!==a?a:"",this.headers=null!==(o=null===(i=f.global)||void 0===i?void 0:i.headers)&&void 0!==o?o:{},this.auth=this._initSupabaseAuthClient(null!==(s=f.auth)&&void 0!==s?s:{},this.headers,null===(c=f.global)||void 0===c?void 0:c.fetch),this.fetch=Ht(t,this._getAccessToken.bind(this),null===(l=f.global)||void 0===l?void 0:l.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},f.realtime)),this.rest=new Ue("".concat(h,"/rest/v1"),{headers:this.headers,schema:null===(u=f.db)||void 0===u?void 0:u.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Oe(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Mt(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return this.rest.rpc(e,t,r)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Lr(this,void 0,void 0,(function*(){const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,r){let{autoRefreshToken:n,persistSession:a,detectSessionInUrl:i,storage:o,storageKey:s,flowType:c,debug:l}=e;const u={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Mr({url:this.authUrl,headers:Object.assign(Object.assign({},u),t),storageKey:s,autoRefreshToken:n,persistSession:a,detectSessionInUrl:i,storage:o,flowType:c,debug:l,fetch:r})}_initRealtimeClient(e){return new dt(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.realtime.setAuth(null!==r&&void 0!==r?r:null),this.changedAccessToken=r)}}const jr=((e,t,r)=>new Br(e,t,r))("https://ejgdplrjgnbwghgjkxlg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVqZ2RwbHJqZ25id2doZ2preGxnIiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTg5MTc0ODMsImV4cCI6MjAxNDQ5MzQ4M30.cxDoo5RXA4-sVZiywv6hGAL-1xfn3lrvJpEpiN04jhQ"),zr=jr,qr={scopes:["profile","user.read","email","offline_access","openid"]};function Kr(e){return be({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"title",attr:{},child:[]},{tag:"path",attr:{d:"M21.53 4.306v15.363q0 .807-.472 1.433-.472.627-1.253.85l-6.888 1.974q-.136.037-.29.055-.156.019-.293.019-.396 0-.72-.105-.321-.106-.656-.292l-4.505-2.544q-.248-.137-.391-.366-.143-.23-.143-.515 0-.434.304-.738.304-.305.739-.305h5.831V4.964l-4.38 1.563q-.533.187-.856.658-.322.472-.322 1.03v8.078q0 .496-.248.912-.25.416-.683.651l-2.072 1.13q-.286.148-.571.148-.497 0-.844-.347-.348-.347-.348-.844V6.563q0-.62.33-1.19.328-.571.874-.881L11.07.285q.248-.136.534-.21.285-.075.57-.075.211 0 .38.031.166.031.364.093l6.888 1.899q.384.11.7.329.317.217.547.52.23.305.353.67.125.367.125.764zm-1.588 15.363V4.306q0-.273-.16-.478-.163-.204-.423-.28l-3.388-.93q-.397-.111-.794-.23-.397-.117-.794-.216v19.68l4.976-1.427q.26-.074.422-.28.161-.204.161-.477z"}}]})(e)}function Gr(e){return be({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}}]})(e)}var Vr=r(184);function Wr(e){let{msalinstance:r,openLogin:n,setOpenLogin:a,setUser:i,setUserAzure:o}=e;const[s,c]=(0,t.useState)();var l;(0,t.useEffect)((()=>{!async function(){const{data:e}=await zr.from("admin").select();c(e)}()}),[n]);const u=async()=>{try{l=await r.loginPopup(qr),await async function(e){if(console.log(e),s)for(let t=0;t<s.length;t++)if(s[t].adminEmail=e.username){i(s),o(l);const{data:e,error:t}=await zr.from("admin").update({adminName:l.account.name}).eq("adminEmail",l.account.username).select()}}(l.account)}catch(e){console.error("Authentication error",e)}};return n?(0,Vr.jsx)("div",{id:"main",className:"fixed inset-0 items-center justify-center place-content-center \r bg-opacity-10 backdrop-blur-md flex font-lato w-full z-100 ",children:(0,Vr.jsxs)("div",{id:"main2",className:"shadow-[#0000009f] shadow-md  rounded-md  ",children:[(0,Vr.jsxs)("div",{id:"header",className:" relative rounded-t-lg  px-3 h-8 overflow-hidden flex justify-between items-center bg-[#3C91E6]",children:[(0,Vr.jsx)("h1",{children:"Login"}),(0,Vr.jsx)("button",{onClick:()=>a(!n),children:(0,Vr.jsx)(Gr,{})})]}),(0,Vr.jsx)("div",{id:"body",className:" bg-white h-32 ",children:(0,Vr.jsxs)("button",{className:"bg-[#ED4627] rounded-full w-60 items-center flex",onClick:()=>u(),children:[(0,Vr.jsx)(Kr,{}),"Office 365 Login"]})}),(0,Vr.jsx)("div",{id:"footer",className:"  relative rounded-b-lg  px-3 pt- pb-3  overflow-hidden flex justify-between items-center bg-[#3C91E6] "})]})}):null}function Yr(e){let{setOpenMenu:r,openMenu:n,msalinstance:a,setUser:i,userAzure:o,setUserAzure:s,user:c}=e;const[l,u]=(0,t.useState)(!1);return console.log(c),(0,Vr.jsxs)("div",{id:"Nav",className:"overflow-y-hidden h-[75px] w-full bg-[#3C91E6] flex items-center justify-between font-lato absolute top-0 left-0 z-0",children:[(0,Vr.jsxs)("div",{id:"brand",className:"font-bold flex items-center text-black sticky top-0 left-0 bg-[#3C91E6] box-content",children:[(0,Vr.jsx)("img",{className:"h-20 ",src:Ce,alt:""}),(0,Vr.jsx)("h1",{className:"text-[24px] mr-6",children:"ADMECO"}),(0,Vr.jsx)("button",{onClick:()=>r(!n),children:(0,Vr.jsx)(Ee,{id:"icon iconmenu",className:"text-[20px] hover:text-[#F9F9F9] ".concat(null!=o?"":"hidden")})})]}),(0,Vr.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer mr-4",children:[(0,Vr.jsx)("div",{className:"flex items-center gap-1 opacity-90 md:text-base text-[11px]",children:(0,Vr.jsx)("h1",{children:"ex name"})}),(0,Vr.jsx)("div",{onClick:()=>u(!l),className:"md:h-10 md:w-10 h-8 w-8 rounded-full text-sm hover:ring-2 hover:ring-white ",children:(0,Vr.jsx)(Wr,{msalinstance:a,setOpenLogin:u,openLogin:l,setUser:i,setUserAzure:s})})]})]})}function $r(){return $r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$r.apply(this,arguments)}function Qr(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Jr=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];new Map;const Xr=n.startTransition;function Zr(e){let{basename:r,children:n,future:a,window:i}=e,o=t.useRef();var s;null==o.current&&(o.current=(void 0===(s={window:i,v5Compat:!0})&&(s={}),f((function(e,t){let{pathname:r="/",search:n="",hash:a=""}=d(e.location.hash.substr(1));return r.startsWith("/")||r.startsWith(".")||(r="/"+r),u("",{pathname:r,search:n,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let r=e.document.querySelector("base"),n="";if(r&&r.getAttribute("href")){let t=e.location.href,r=t.indexOf("#");n=-1===r?t:t.slice(0,r)}return n+"#"+("string"===typeof t?t:h(t))}),(function(e,t){c("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),s)));let l=o.current,[p,g]=t.useState({action:l.action,location:l.location}),{v7_startTransition:m}=a||{},v=t.useCallback((e=>{m&&Xr?Xr((()=>g(e))):g(e)}),[g,m]);return t.useLayoutEffect((()=>l.listen(v)),[l,v]),t.createElement(he,{basename:r,children:n,location:p.location,navigationType:p.action,navigator:l})}const en="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,tn=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rn=t.forwardRef((function(e,r){let n,{onClick:a,relative:i,reloadDocument:o,replace:c,state:l,target:u,to:d,preventScrollReset:f,unstable_viewTransition:p}=e,g=Qr(e,Jr),{basename:m}=t.useContext(q),v=!1;if("string"===typeof d&&tn.test(d)&&(n=d,en))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),r=R(t.pathname,m);t.origin===e.origin&&null!=r?d=r+t.search+t.hash:v=!0}catch(T){}let y=function(e,r){let{relative:n}=void 0===r?{}:r;W()||s(!1);let{basename:a,navigator:i}=t.useContext(q),{hash:o,pathname:c,search:l}=X(e,{relative:n}),u=c;return"/"!==a&&(u="/"===c?a:P([a,c])),i.createHref({pathname:u,search:l,hash:o})}(d,{relative:i}),b=function(e,r){let{target:n,replace:a,state:i,preventScrollReset:o,relative:s,unstable_viewTransition:c}=void 0===r?{}:r,l=J(),u=Y(),d=X(e,{relative:s});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let r=void 0!==a?a:h(u)===h(d);l(e,{replace:r,state:i,preventScrollReset:o,relative:s,unstable_viewTransition:c})}}),[u,l,d,a,i,n,e,o,s,c])}(d,{replace:c,state:l,target:u,preventScrollReset:f,relative:i,unstable_viewTransition:p});return t.createElement("a",$r({},g,{href:n||y,onClick:v||o?a:function(e){a&&a(e),e.defaultPrevented||b(e)},ref:r,target:u}))}));var nn,an;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(nn||(nn={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(an||(an={}));function on(e){return be({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"7",height:"9",x:"3",y:"3",rx:"1"}},{tag:"rect",attr:{width:"7",height:"5",x:"14",y:"3",rx:"1"}},{tag:"rect",attr:{width:"7",height:"9",x:"14",y:"12",rx:"1"}},{tag:"rect",attr:{width:"7",height:"5",x:"3",y:"16",rx:"1"}}]})(e)}function sn(e){return be({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M172,156a12,12,0,0,1-12,12H96a12,12,0,0,1,0-24h64A12,12,0,0,1,172,156Zm-12-52H96a12,12,0,0,0,0,24h64a12,12,0,0,0,0-24Zm60-56V216a20,20,0,0,1-20,20H56a20,20,0,0,1-20-20V48A20,20,0,0,1,56,28H90.53a51.88,51.88,0,0,1,74.94,0H200A20,20,0,0,1,220,48ZM128,36a28,28,0,0,0-27.71,24h55.42A28,28,0,0,0,128,36Zm68,16H178.59A52.13,52.13,0,0,1,180,64v8a12,12,0,0,1-12,12H88A12,12,0,0,1,76,72V64a52.13,52.13,0,0,1,1.41-12H60V212H196Z"}}]})(e)}function cn(e){return be({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M210.78,39.25l-130.25-23A16,16,0,0,0,62,29.23l-29.75,169a16,16,0,0,0,13,18.53l130.25,23a16,16,0,0,0,18.54-13l29.75-169A16,16,0,0,0,210.78,39.25ZM135.5,131.56a8,8,0,0,1-7.87,6.61,8.27,8.27,0,0,1-1.4-.12l-41.5-7.33A8,8,0,0,1,87.52,115L129,122.29A8,8,0,0,1,135.5,131.56Zm47-24.18a8,8,0,0,1-7.86,6.61,7.55,7.55,0,0,1-1.41-.13l-83-14.65a8,8,0,0,1,2.79-15.76l83,14.66A8,8,0,0,1,182.53,107.38Zm5.55-31.52a8,8,0,0,1-7.87,6.61,8.36,8.36,0,0,1-1.4-.12l-83-14.66a8,8,0,1,1,2.78-15.75l83,14.65A8,8,0,0,1,188.08,75.86Z"}}]})(e)}function ln(e){return be({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M448 160H320V128H448v32zM48 64C21.5 64 0 85.5 0 112v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zM448 352v32H192V352H448zM48 288c-26.5 0-48 21.5-48 48v64c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V336c0-26.5-21.5-48-48-48H48z"}}]})(e)}function un(e){return be({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M128 64c0-35.3 28.7-64 64-64H352V128c0 17.7 14.3 32 32 32H512V448c0 35.3-28.7 64-64 64H192c-35.3 0-64-28.7-64-64V336H302.1l-39 39c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l80-80c9.4-9.4 9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l39 39H128V64zm0 224v48H24c-13.3 0-24-10.7-24-24s10.7-24 24-24H128zM512 128H384V0L512 128z"}}]})(e)}function hn(e){let{user:r}=e;const[n,a]=(0,t.useState)(!1);return(0,Vr.jsx)("div",{id:"sidebar",className:"top-0 left-0S bg-[#EEEEEE] -z-10 h-full mt-16 pt-1 font-lato",children:(0,Vr.jsx)("div",{className:"side",children:(0,Vr.jsxs)("ul",{id:"sideMenuTop",className:"w-100% mt-[51px]",children:[r.role=(0,Vr.jsx)(rn,{to:"/",className:"",children:(0,Vr.jsxs)("li",{id:"active",className:"h-9 bg-[#F9F9F9] items-center ml-2 p-3 mr-[2px] flex rounded-full mb-3 hover:text-[#3C91E6]",children:[(0,Vr.jsx)(on,{id:"icon dashboard",className:""}),(0,Vr.jsx)("h1",{className:"ml-4",children:" Dashboard"})]})}),r.role=(0,Vr.jsx)(rn,{to:"/Progress",className:"",children:(0,Vr.jsxs)("li",{id:"active",className:"h-9 bg-[#F9F9F9] items-center ml-2 p-3 mr-[2px] rounded-full  mb-3 flex hover:text-[#3C91E6]",children:[(0,Vr.jsx)(ln,{id:"icon Progress",className:""}),(0,Vr.jsx)("h1",{className:"ml-4",children:" Progress"})]})}),(0,Vr.jsx)(rn,{to:"/Import",className:" ",children:(0,Vr.jsxs)("li",{id:"active",className:"h-9 bg-[#F9F9F9]  items-center ml-2 p-3 mr-[2px] rounded-full mb-3 flex hover:text-[#3C91E6]",children:[(0,Vr.jsx)(un,{id:"icon Import",className:""}),(0,Vr.jsx)("h1",{className:"ml-4",children:" import"})]})}),r.role=(0,Vr.jsxs)("button",{id:"active",className:"h-9 bg-[#F9F9F9] items-center  rounded-full w-[97%] mx-2 mb-3 flex hover:text-[#3C91E6]",onClick:()=>a((e=>!e)),children:[(0,Vr.jsx)(cn,{id:"icon Logs",className:"ml-4"}),(0,Vr.jsx)("h1",{className:"ml-4",children:"Logs"}),n?(0,Vr.jsx)(_e,{}):(0,Vr.jsx)(we,{})]}),n&&(0,Vr.jsxs)(Vr.Fragment,{children:[(0,Vr.jsx)(rn,{to:"/Activity",className:"",children:(0,Vr.jsxs)("li",{id:"active",className:"h-9 bg-[#F9F9F9] items-center ml-2 p-3 mr-[2px] rounded-full mb-3 flex hover:text-[#3C91E6]",children:[(0,Vr.jsx)(sn,{id:"icon Activity",className:""}),(0,Vr.jsx)("h1",{className:"ml-4",children:" Activity"})]})})," ",(0,Vr.jsx)(rn,{to:"/Login",className:"",children:(0,Vr.jsxs)("li",{id:"active",className:"h-9 bg-[#F9F9F9] items-center ml-2 p-3 mr-[2px] rounded-full mb-3 flex hover:text-[#3C91E6]",children:[(0,Vr.jsx)(sn,{id:"icon Activity",className:""}),(0,Vr.jsx)("h1",{className:"ml-4",children:" user role creation"})]})})]}),(0,Vr.jsxs)("li",{id:"active",className:"h-9 bg-[#F9F9F9] items-center ml-2 p-3 mr-[2px] rounded-full mb-3 flex hover:text-[#3C91E6]",children:[(0,Vr.jsx)(sn,{id:"icon Activity",className:""}),(0,Vr.jsx)("h1",{className:"ml-4",children:" logout"})]})]})})})}function dn(e){return be({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M10.707 17.707 16.414 12l-5.707-5.707-1.414 1.414L13.586 12l-4.293 4.293z"}}]})(e)}function fn(e){return be({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M11 7h2v7h-2zm0 8h2v2h-2z"}},{tag:"path",attr:{d:"m21.707 7.293-5-5A.996.996 0 0 0 16 2H8a.996.996 0 0 0-.707.293l-5 5A.996.996 0 0 0 2 8v8c0 .266.105.52.293.707l5 5A.996.996 0 0 0 8 22h8c.266 0 .52-.105.707-.293l5-5A.996.996 0 0 0 22 16V8a.996.996 0 0 0-.293-.707zM20 15.586 15.586 20H8.414L4 15.586V8.414L8.414 4h7.172L20 8.414v7.172z"}}]})(e)}function pn(e){return be({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M9.5 12c2.206 0 4-1.794 4-4s-1.794-4-4-4-4 1.794-4 4 1.794 4 4 4zm1.5 1H8c-3.309 0-6 2.691-6 6v1h15v-1c0-3.309-2.691-6-6-6z"}},{tag:"path",attr:{d:"M16.604 11.048a5.67 5.67 0 0 0 .751-3.44c-.179-1.784-1.175-3.361-2.803-4.44l-1.105 1.666c1.119.742 1.8 1.799 1.918 2.974a3.693 3.693 0 0 1-1.072 2.986l-1.192 1.192 1.618.475C18.951 13.701 19 17.957 19 18h2c0-1.789-.956-5.285-4.396-6.952z"}}]})(e)}function gn(e){return be({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zm9.954 3H2.545c-.3 0-.545.224-.545.5v1c0 .276.244.5.545.5h10.91c.3 0 .545-.224.545-.5v-1c0-.276-.244-.5-.546-.5zM6 10a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1H6z"}}]})(e)}function mn(){return(0,Vr.jsxs)("div",{id:"main",className:"  pt-9 pb-28 px-5 font-lato mt-7 max-h-screen overflow-y-auto fixed w-[100%]",children:[(0,Vr.jsx)("div",{id:"headTitle",className:"flex items-center justify-between gap-16 flex-wrap",children:(0,Vr.jsxs)("div",{id:"container left",children:[(0,Vr.jsx)("h1",{className:"text-4xl font-semibold mb-5 text-black",children:"Dashboard"}),(0,Vr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vr.jsx)("div",{className:"text-black",children:(0,Vr.jsx)(rn,{to:"/",children:"Dashboard"})}),(0,Vr.jsx)("div",{children:(0,Vr.jsx)(dn,{id:"icon iconchevronRight",className:""})})]})]})}),(0,Vr.jsxs)("div",{id:"container info",className:"grid  lg:grid-cols-4 gap-24 mt-[5%] ml-6",children:[(0,Vr.jsxs)("div",{className:"items-center flex gap-5 w-[80.5%]",children:[(0,Vr.jsx)("div",{id:"box info",className:"p-3 bg-red-500   rounded-2xl",children:(0,Vr.jsx)(fn,{id:"icon iconError",className:"  text-white text-6xl"})}),(0,Vr.jsxs)("div",{children:[(0,Vr.jsx)("h1",{className:"font-bold text-2xl",children:"20"}),(0,Vr.jsx)("p",{className:"whitespace-nowrap",children:"New Failed Student"})]})]}),(0,Vr.jsxs)("div",{className:"items-center flex gap-5 w-[80.5%]",children:[(0,Vr.jsx)("div",{id:"box info",className:"p-3 bg-green-700   rounded-2xl",children:(0,Vr.jsx)(pn,{id:"icon iconError",className:"  text-white text-6xl"})}),(0,Vr.jsxs)("div",{children:[(0,Vr.jsx)("h1",{className:"font-bold text-2xl",children:"30"}),(0,Vr.jsx)("p",{children:"Online"})]})]}),(0,Vr.jsxs)("div",{className:"items-center flex gap-5 w-[80.5%]",children:[(0,Vr.jsx)("div",{id:"box info",className:"p-3 bg-yellow-400   rounded-2xl",children:(0,Vr.jsx)(pn,{id:"icon iconError",className:"  text-white text-6xl"})}),(0,Vr.jsxs)("div",{children:[(0,Vr.jsx)("h1",{className:"font-bold text-2xl",children:"5"}),(0,Vr.jsx)("p",{className:"whitespace-nowrap",children:"Busy User"})]})]})]}),(0,Vr.jsxs)("div",{id:"table data",className:"flex  gap-6 mt-[68px] ml-6 text-black overflow-y",children:[(0,Vr.jsxs)("div",{id:"order",className:"basis-[52%]",children:[(0,Vr.jsx)("div",{id:"head",className:"  mb-8",children:(0,Vr.jsx)("h1",{className:"text-2xl mr-auto font-semibold ",children:"Progress"})}),(0,Vr.jsxs)("table",{className:"w-full border-collapse",children:[(0,Vr.jsx)("thead",{children:(0,Vr.jsxs)("tr",{className:"border-b-[1px]",children:[(0,Vr.jsx)("th",{className:"pb-1 pl-8 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Student Name"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Date Progress"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Status"})]})}),(0,Vr.jsxs)("tbody",{className:"",children:[(0,Vr.jsxs)("tr",{className:" hover:bg-[#eee]",children:[(0,Vr.jsx)("td",{className:"p-7  ",children:(0,Vr.jsx)("p",{className:"pl-1",children:"Ron Jericho manzano"})}),(0,Vr.jsx)("td",{children:"28-09-2023"}),(0,Vr.jsx)("td",{children:(0,Vr.jsx)("span",{className:"status Passed",children:"Passed"})})]}),(0,Vr.jsxs)("tr",{className:" hover:bg-[#eee]",children:[(0,Vr.jsx)("td",{className:"p-7",children:(0,Vr.jsx)("p",{className:"pl-1",children:"Vincent Baliuag"})}),(0,Vr.jsx)("td",{children:"28-09-2023"}),(0,Vr.jsx)("td",{children:(0,Vr.jsx)("span",{className:"status passed",children:"passed"})})]}),(0,Vr.jsxs)("tr",{className:" hover:bg-[#eee]",children:[(0,Vr.jsx)("td",{className:" p-7",children:(0,Vr.jsx)("p",{className:"pl-1",children:"Alto Alexander"})}),(0,Vr.jsx)("td",{children:"28-09-2023"}),(0,Vr.jsx)("td",{children:(0,Vr.jsx)("span",{className:"status passed",children:"passed"})})]}),(0,Vr.jsxs)("tr",{className:"  hover:bg-[#eee]",children:[(0,Vr.jsx)("td",{className:"p-7",children:(0,Vr.jsx)("p",{className:"pl-1",children:"Ceejay Fajardo"})}),(0,Vr.jsx)("td",{children:"28-09-2023"}),(0,Vr.jsx)("td",{children:(0,Vr.jsx)("span",{className:"status passed",children:"passed"})})]})]})]})]}),(0,Vr.jsx)("div",{id:"Activity",className:"basis-[45%] text-black overflow-y",children:(0,Vr.jsxs)("div",{id:"order",className:" ",children:[(0,Vr.jsx)("div",{id:"head",className:"flex mb-7",children:(0,Vr.jsx)("h1",{className:"text-2xl  font-semibold ",children:"Activity"})}),(0,Vr.jsxs)("div",{className:"  border-collapse ",children:[(0,Vr.jsx)("thead",{children:(0,Vr.jsxs)("tr",{className:"border-b-[1px]  flex  gap-[150px]",children:[(0,Vr.jsx)("th",{className:"pb-1 pl-8 text-sm text-left bottom-1 border-solid border-[#eee]",children:"UserName"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"TimeClicked"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Status"})]})}),(0,Vr.jsxs)("ul",{className:"mt-2 ",children:[(0,Vr.jsxs)("li",{className:"border-x-2 mb-5 bg-[#eee] rounded-lg px-6 py-6  flex gap-[95px]",children:[(0,Vr.jsxs)("div",{className:"flex items-center",children:[(0,Vr.jsx)(gn,{className:"text-[#ff0000]"}),(0,Vr.jsx)("h1",{className:"ml-4",children:"teacher name"})]}),(0,Vr.jsx)("h1",{children:"November 15, 2023 2:08 AM"}),(0,Vr.jsx)("h1",{children:"imported a report"})]}),(0,Vr.jsxs)("li",{className:"border-x-2 mb-5 bg-[#eee] rounded-lg px-6 py-6  flex gap-20",children:[(0,Vr.jsxs)("div",{className:"flex items-center",children:[(0,Vr.jsx)(gn,{className:"text-[#ff0000]"}),(0,Vr.jsx)("h1",{className:"ml-4",children:"teacher name"})]}),(0,Vr.jsx)("h1",{children:"November 15, 2023 2:08 AM"}),(0,Vr.jsx)("h1",{children:"imported a report"})]}),(0,Vr.jsxs)("li",{className:"border-x-2 mb-5 bg-[#eee] rounded-lg px-6 py-6  flex gap-20",children:[(0,Vr.jsxs)("div",{className:"flex items-center",children:[(0,Vr.jsx)(gn,{className:"text-[#ff0000]"}),(0,Vr.jsx)("h1",{className:"ml-4",children:"teacher name"})]}),(0,Vr.jsx)("h1",{children:"November 15, 2023 2:08 AM"}),(0,Vr.jsx)("h1",{children:"imported a report"})]}),(0,Vr.jsxs)("li",{className:"border-x-2 mb-5 bg-[#eee] rounded-lg px-6 py-6  flex gap-20",children:[(0,Vr.jsxs)("div",{className:"flex items-center",children:[(0,Vr.jsx)(gn,{className:"text-[#ff0000]"}),(0,Vr.jsx)("h1",{className:"ml-4",children:"teacher name"})]}),(0,Vr.jsx)("h1",{children:"November 15, 2023 2:08 AM"}),(0,Vr.jsx)("h1",{children:"imported a report"})]})]})]})]})})]})]})}function vn(){return(0,Vr.jsxs)("div",{id:"main",className:" pt-9 pb-28 px-5 font-lato mt-7 max-h-full overflow-y-auto   w-full",children:[(0,Vr.jsx)("div",{id:"headTitle",className:" items-center gap-16 ",children:(0,Vr.jsxs)("div",{id:"container left",children:[(0,Vr.jsx)("h1",{className:"text-4xl font-semibold mb-5 text-black",children:"Progress"}),(0,Vr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vr.jsx)(rn,{to:"/",className:"hover:text-[#3C91E6]",children:"Home"}),(0,Vr.jsx)(dn,{id:"icon iconchevronRight",className:""}),(0,Vr.jsx)(rn,{to:"/Progress",className:"hover:text-[#3C91E6]",children:"Progress"})]})]})}),(0,Vr.jsx)("div",{id:"table data",className:" mt-[68px] ml-6 text-black",children:(0,Vr.jsxs)("div",{id:"order",className:" basis-[75%]",children:[(0,Vr.jsx)("h1",{className:"text-2xl mr-auto mb-8 font-semibold ",children:"Progress"}),(0,Vr.jsxs)("table",{className:"w-full border-collapse",children:[(0,Vr.jsx)("thead",{children:(0,Vr.jsxs)("tr",{className:"border-b-[1px]",children:[(0,Vr.jsx)("th",{className:"pb-1 pl-10 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Student Name"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Term"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Date Progress"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Status"})]})}),(0,Vr.jsxs)("tbody",{className:"",children:[(0,Vr.jsxs)("tr",{className:" px-10 hover:bg-[#eee]",children:[(0,Vr.jsx)("td",{className:"p-7  ",children:(0,Vr.jsx)("p",{className:"pl-1",children:"Ron Jericho manzano"})}),(0,Vr.jsx)("td",{children:"Midterm"}),(0,Vr.jsx)("td",{children:"28-09-2023"}),(0,Vr.jsx)("td",{children:(0,Vr.jsx)("span",{className:"status Passed",children:"Passed"})})]}),(0,Vr.jsxs)("tr",{className:"h-24 hover:bg-[#eee]",children:[(0,Vr.jsx)("td",{className:"p-7",children:(0,Vr.jsx)("p",{className:"pl-1",children:"Vincent Baliuag"})}),(0,Vr.jsx)("td",{children:"Prelim"}),(0,Vr.jsx)("td",{children:"28-09-2023"}),(0,Vr.jsx)("td",{children:(0,Vr.jsx)("span",{className:"status Failure",children:"Failure"})})]}),(0,Vr.jsxs)("tr",{className:" hover:bg-[#eee]",children:[(0,Vr.jsx)("td",{className:" p-7",children:(0,Vr.jsx)("p",{className:"pl-1",children:"Alto Alexander"})}),(0,Vr.jsx)("td",{children:"Finals"}),(0,Vr.jsx)("td",{children:"28-09-2023"}),(0,Vr.jsx)("td",{children:(0,Vr.jsx)("span",{className:"status Improving",children:"Improving"})})]}),(0,Vr.jsxs)("tr",{className:"  hover:bg-[#eee]",children:[(0,Vr.jsx)("td",{className:"p-7",children:(0,Vr.jsx)("p",{className:"pl-1",children:"Ceejay Fajardo"})}),(0,Vr.jsx)("td",{children:"Midterm"}),(0,Vr.jsx)("td",{children:"28-09-2023"}),(0,Vr.jsx)("td",{children:(0,Vr.jsx)("span",{className:"status Failure",children:"Failure"})})]})]})]})]})})]})}function yn(){return(0,Vr.jsxs)("div",{id:"main",className:"  pt-9 pb-28 px-5 font-lato mt-7 max-h-full overflow-y-auto  w-full",children:[(0,Vr.jsx)("div",{id:"headTitle",className:"flex items-center justify-between gap-16 flex-wrap",children:(0,Vr.jsxs)("div",{id:"container left",children:[(0,Vr.jsx)("h1",{className:"text-4xl font-semibold mb-5 text-black",children:"Activity"}),(0,Vr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vr.jsx)(rn,{to:"/",className:"hover:text-[#3C91E6]",children:"Home"}),(0,Vr.jsx)(dn,{id:"icon iconchevronRight",className:""}),(0,Vr.jsx)(rn,{to:"/Activity",className:"hover:text-[#3C91E6]",children:"Activity"})]})]})}),(0,Vr.jsx)("div",{id:"table data",className:" mt-[68px] ml-6 text-black",children:(0,Vr.jsxs)("div",{id:"order",className:"",children:[(0,Vr.jsx)("h1",{className:"text-2xl mr-auto mb-8 font-semibold ",children:"Activity"}),(0,Vr.jsxs)("table",{className:"w-full border-collapse",children:[(0,Vr.jsx)("thead",{children:(0,Vr.jsxs)("tr",{className:"border-b-[1px]",children:[(0,Vr.jsx)("th",{className:"pb-1 pl-10 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Student Name"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Date Progress"}),(0,Vr.jsx)("th",{className:"pb-1 text-sm text-left bottom-1 border-solid border-[#eee]",children:"Status"})]})}),(0,Vr.jsxs)("tbody",{className:"mt-2",children:[(0,Vr.jsxs)("tr",{className:"border-x-2 mb-5 bg-[#eee] rounded-lg px-6 py-6  flex  ",children:[(0,Vr.jsxs)("td",{className:"flex items-center  ",children:[(0,Vr.jsx)(gn,{className:"text-[#ff0000]"}),(0,Vr.jsx)("p",{className:"ml-4",children:"teacher name"})]}),(0,Vr.jsx)("td",{children:"November 15, 2023 2:08 AM"}),(0,Vr.jsx)("td",{children:"imported a report"})]}),(0,Vr.jsxs)("tr",{className:"border-x-2 mb-5 bg-[#eee] rounded-lg px-6 py-6  flex  ",children:[(0,Vr.jsxs)("td",{className:"flex items-center  ",children:[(0,Vr.jsx)(gn,{className:"text-[#ff0000]"}),(0,Vr.jsx)("p",{className:"ml-4",children:"teacher name"})]}),(0,Vr.jsx)("td",{children:"November 15, 2023 2:08 AM"}),(0,Vr.jsx)("td",{children:"imported a report"})]}),(0,Vr.jsxs)("tr",{className:"border-x-2 mb-5 bg-[#eee] rounded-lg px-6 py-6  flex  ",children:[(0,Vr.jsxs)("td",{className:"flex items-center  ",children:[(0,Vr.jsx)(gn,{className:"text-[#ff0000]"}),(0,Vr.jsx)("p",{className:"ml-4",children:"teacher name"})]}),(0,Vr.jsx)("td",{children:"November 15, 2023 2:08 AM"}),(0,Vr.jsx)("td",{children:"imported a report"})]}),(0,Vr.jsxs)("tr",{className:"border-x-2 mb-5 bg-[#eee] rounded-lg px-6 py-6  flex  ",children:[(0,Vr.jsxs)("td",{className:"flex items-center  ",children:[(0,Vr.jsx)(gn,{className:"text-[#ff0000]"}),(0,Vr.jsx)("p",{className:"ml-4",children:"teacher name"})]}),(0,Vr.jsx)("td",{children:"November 15, 2023 2:08 AM"}),(0,Vr.jsx)("td",{children:"imported a report"})]})]})]})]})})]})}var bn={version:"0.18.5"},Tn=1200,wn=1252,_n=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],En={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Cn=function(e){-1!=_n.indexOf(e)&&(wn=En[0]=e)};var kn=function(e){Tn=e,Cn(e)};function Sn(){kn(1200),Cn(1252)}function An(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function In(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Rn,On=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?In(e.slice(2)):65279==t?e.slice(1):e},Nn=function(e){return String.fromCharCode(e)},xn=function(e){return String.fromCharCode(e)};var Pn=null,Mn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ln(e){for(var t="",r=0,n=0,a=0,i=0,o=0,s=0,c=0,l=0;l<e.length;)i=(r=e.charCodeAt(l++))>>2,o=(3&r)<<4|(n=e.charCodeAt(l++))>>4,s=(15&n)<<2|(a=e.charCodeAt(l++))>>6,c=63&a,isNaN(n)?s=c=64:isNaN(a)&&(c=64),t+=Mn.charAt(i)+Mn.charAt(o)+Mn.charAt(s)+Mn.charAt(c);return t}function Dn(e){var t="",r=0,n=0,a=0,i=0,o=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)r=Mn.indexOf(e.charAt(c++))<<2|(i=Mn.indexOf(e.charAt(c++)))>>4,t+=String.fromCharCode(r),n=(15&i)<<4|(o=Mn.indexOf(e.charAt(c++)))>>2,64!==o&&(t+=String.fromCharCode(n)),a=(3&o)<<6|(s=Mn.indexOf(e.charAt(c++))),64!==s&&(t+=String.fromCharCode(a));return t}var Fn=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Un=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Hn(e){return Fn?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Bn(e){return Fn?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var jn=function(e){return Fn?Un(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function zn(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qn(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qn(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Kn=Fn?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:Un(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var Gn=/\u0000/g,Vn=/[\u0001-\u0006]/g;function Wn(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Yn(e,t){var r=""+e;return r.length>=t?r:ni("0",t-r.length)+r}function $n(e,t){var r=""+e;return r.length>=t?r:ni(" ",t-r.length)+r}function Qn(e,t){var r=""+e;return r.length>=t?r:r+ni(" ",t-r.length)}var Jn=Math.pow(2,32);function Xn(e,t){return e>Jn||e<-Jn?function(e,t){var r=""+Math.round(e);return r.length>=t?r:ni("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:ni("0",t-r.length)+r}(Math.round(e),t)}function Zn(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var ea=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ta=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var ra={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},na={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},aa={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ia(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,s=0,c=1,l=0,u=0,h=Math.floor(a);l<t&&(s=(h=Math.floor(a))*o+i,u=h*l+c,!(a-h<5e-8));)a=1/(a-h),i=o,o=s,c=l,l=u;if(u>t&&(l>t?(u=c,s=i):(u=l,s=o)),!r)return[0,n*s,u];var d=Math.floor(n*s/u);return[d,n*s-d*u,u]}function oa(e,t,r){if(e>2958465||e<0)return null;var n=0|e,a=Math.floor(86400*(e-n)),i=0,o=[],s={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,86400==++a&&(s.T=a=0,++n,++s.D)),60===n)o=r?[1317,10,29]:[1900,2,29],i=3;else if(0===n)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(c,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=a%60,a=Math.floor(a/60),s.M=a%60,a=Math.floor(a/60),s.H=a,s.q=i,s}var sa=new Date(1899,11,31,0,0,0),ca=sa.getTime(),la=new Date(1900,2,1,0,0,0);function ua(e,t){var r=e.getTime();return t?r-=1262304e5:e>=la&&(r+=864e5),(r-(ca+6e4*(e.getTimezoneOffset()-sa.getTimezoneOffset())))/864e5}function ha(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function da(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=ha(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=ha(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),ha(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function fa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):da(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Ma(14,ua(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function pa(e,t,r,n){var a,i="",o=0,s=0,c=r.y,l=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:a=c%100,l=2;break;default:a=c%1e4,l=4}break;case 109:switch(t.length){case 1:case 2:a=r.m,l=t.length;break;case 3:return ta[r.m-1][1];case 5:return ta[r.m-1][0];default:return ta[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,l=t.length;break;case 3:return ea[r.q][0];default:return ea[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(s=n>=2?3===n?1e3:100:1===n?10:1,(o=Math.round(s*(r.S+r.u)))>=60*s&&(o=0),"s"===t?0===o?"0":""+o/s:(i=Yn(o,2+n),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):Yn(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=3===t.length?1:2;break;case 101:a=c,l=1}return l>0?Yn(a,l):""}function ga(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var ma=/%/g;function va(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+va(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a)).indexOf("e")){var o=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ya=/# (\?+)( ?)\/( ?)(\d+)/;var ba=/^#*0*\.([0#]+)/,Ta=/\).*[0#]/,wa=/\(###\) ###\\?-####/;function _a(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Ea(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ca(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function ka(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Ta)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ka("n",n,r):"("+ka("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Ia(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(ma,""),a=t.length-n.length;return Ia(e,n,r*Math.pow(10,2*a))+ni("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return va(t,r);if(36===t.charCodeAt(0))return"$"+ka(e,t.substr(" "==t.charAt(1)?2:1),r);var a,i,o,s,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+Xn(c,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Xn(r,0))&&(a=""),a.length>t.length?a:_a(t.substr(0,t.length-a.length))+a;if(i=t.match(ya))return function(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,s=n;return r+(0===i?"":""+i)+" "+(0===o?ni(" ",e[1].length+1+e[4].length):$n(o,e[1].length)+e[2]+"/"+e[3]+Yn(s,e[4].length))}(i,c,l);if(t.match(/^#+0+$/))return l+Xn(c,t.length-t.indexOf("0"));if(i=t.match(ba))return a=Ea(r,i[1].length).replace(/^([^\.]+)$/,"$1."+_a(i[1])).replace(/\.$/,"."+_a(i[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+ni("0",_a(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+Ea(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+ga(Xn(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ka(e,t,-r):ga(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,i[1].length)))+"."+Yn(Ca(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ka(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wn(ka(e,t.replace(/[\\-]/g,""),r)),o=0,Wn(Wn(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return o<a.length?a.charAt(o++):"0"===e?"0":""})));if(t.match(wa))return"("+(a=ka(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),s=ia(c,Math.pow(10,o)-1,!1),a=""+l," "==(u=Ia("n",i[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Qn(s[2],o)).length<i[4].length&&(u=_a(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l+((s=ia(c,Math.pow(10,o)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?$n(s[1],o)+i[2]+"/"+i[3]+Qn(s[2],o):ni(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Xn(r,0),t.length<=a.length?a:_a(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,d=t.length-a.length-h;return _a(t.substr(0,h)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=Ca(r,i[1].length),r<0?"-"+ka(e,t,-r):ga(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Yn(0,3-e.length):"")+e}))+"."+Yn(o,i[1].length);switch(t){case"###,##0.00":return ka(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=ga(Xn(c,0));return"0"!==f?l+f:"";case"###,###.00":return ka(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ka(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Sa(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Sa(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a)).match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Aa(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Ta)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Aa("n",n,r):"("+Aa("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Ia(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(ma,""),a=t.length-n.length;return Ia(e,n,r*Math.pow(10,2*a))+ni("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return Sa(t,r);if(36===t.charCodeAt(0))return"$"+Aa(e,t.substr(" "==t.charAt(1)?2:1),r);var a,i,o,s,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+Yn(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,0===r&&(a=""),a.length>t.length?a:_a(t.substr(0,t.length-a.length))+a;if(i=t.match(ya))return function(e,t,r){return r+(0===t?"":""+t)+ni(" ",e[1].length+2+e[4].length)}(i,c,l);if(t.match(/^#+0+$/))return l+Yn(c,t.length-t.indexOf("0"));if(i=t.match(ba))return a=(a=(""+r).replace(/^([^\.]+)$/,"$1."+_a(i[1])).replace(/\.$/,"."+_a(i[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+ni("0",_a(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+ga(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Aa(e,t,-r):ga(""+r)+"."+ni("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Aa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wn(Aa(e,t.replace(/[\\-]/g,""),r)),o=0,Wn(Wn(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return o<a.length?a.charAt(o++):"0"===e?"0":""})));if(t.match(wa))return"("+(a=Aa(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),s=ia(c,Math.pow(10,o)-1,!1),a=""+l," "==(u=Ia("n",i[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Qn(s[2],o)).length<i[4].length&&(u=_a(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l+((s=ia(c,Math.pow(10,o)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?$n(s[1],o)+i[2]+"/"+i[3]+Qn(s[2],o):ni(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:_a(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,d=t.length-a.length-h;return _a(t.substr(0,h)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Aa(e,t,-r):ga(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Yn(0,3-e.length):"")+e}))+"."+Yn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=ga(""+c);return"0"!==f?l+f:"";default:if(t.match(/\.[0#?]*$/))return Aa(e,t.slice(0,t.lastIndexOf(".")),r)+_a(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ia(e,t,r){return(0|r)===r?Aa(e,t,r):ka(e,t,r)}var Ra=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Oa(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Zn(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(Ra))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Na=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xa(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function Pa(e,t){var r=function(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var i=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,i];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var o=r[0].match(Na),s=r[1].match(Na);return xa(t,o)?[n,r[0]]:xa(t,s)?[n,r[1]]:[n,r[null!=o&&null!=s?2:1]]}return[n,i]}function Ma(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:ra)[e])&&(n=r.table&&r.table[na[e]]||ra[na[e]]),null==n&&(n=aa[e]||"General")}if(Zn(n,0))return fa(t,r);t instanceof Date&&(t=ua(t,r.date1904));var a=Pa(n,t);if(Zn(a[1]))return fa(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var a,i,o,s=[],c="",l=0,u="",h="t",d="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!Zn(e,l))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(c="";34!==(o=e.charCodeAt(++l))&&l<e.length;)c+=String.fromCharCode(o);s[s.length]={t:"t",v:c},++l;break;case"\\":var f=e.charAt(++l),p="("===f||")"===f?f:"t";s[s.length]={t:p,v:f},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:t},++l;break;case"B":case"b":if("1"===e.charAt(l+1)||"2"===e.charAt(l+1)){if(null==a&&null==(a=oa(t,r,"2"===e.charAt(l+1))))return"";s[s.length]={t:"X",v:e.substr(l,2)},h=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=oa(t,r)))return"";for(c=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)c+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=d),s[s.length]={t:u,v:c},h=u;break;case"A":case"a":case"\u4e0a":var g={t:u,v:u};if(null==a&&(a=oa(t,r)),"A/P"===e.substr(l,3).toUpperCase()?(null!=a&&(g.v=a.H>=12?"P":"A"),g.t="T",d="h",l+=3):"AM/PM"===e.substr(l,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"PM":"AM"),g.t="T",l+=5,d="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(l,5).toUpperCase()?(null!=a&&(g.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),g.t="T",l+=5,d="h"):(g.t="t",++l),null==a&&"T"===g.t)return"";s[s.length]=g,h=u;break;case"[":for(c=u;"]"!==e.charAt(l++)&&l<e.length;)c+=e.charAt(l);if("]"!==c.slice(-1))throw'unterminated "[" block: |'+c+"|";if(c.match(Ra)){if(null==a&&null==(a=oa(t,r)))return"";s[s.length]={t:"Z",v:c.toLowerCase()},h=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",Oa(e)||(s[s.length]={t:"t",v:c}));break;case".":if(null!=a){for(c=u;++l<e.length&&"0"===(u=e.charAt(l));)c+=u;s[s.length]={t:"s",v:c};break}case"0":case"#":for(c=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)c+=u;s[s.length]={t:"n",v:c};break;case"?":for(c=u;e.charAt(++l)===u;)c+=u;s[s.length]={t:u,v:c},h=u;break;case"*":++l," "!=e.charAt(l)&&"*"!=e.charAt(l)||++l;break;case"(":case")":s[s.length]={t:1===n?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)c+=e.charAt(l);s[s.length]={t:"D",v:c};break;case" ":s[s.length]={t:u,v:u},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++l}var m,v=0,y=0;for(l=s.length-1,h="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=d,h="h",v<1&&(v=1);break;case"s":(m=s[l].v.match(/\.0+$/))&&(y=Math.max(y,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=s[l].t;break;case"m":"s"===h&&(s[l].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[l].v.match(/[Hh]/)&&(v=1),v<2&&s[l].v.match(/[Mm]/)&&(v=2),v<3&&s[l].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,T="";for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=pa(s[l].t.charCodeAt(0),s[l].v,a,y),s[l].t="t";break;case"n":case"?":for(b=l+1;null!=s[b]&&("?"===(u=s[b].t)||"D"===u||(" "===u||"t"===u)&&null!=s[b+1]&&("?"===s[b+1].t||"t"===s[b+1].t&&"/"===s[b+1].v)||"("===s[l].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===s[b].v||" "===s[b].v&&null!=s[b+1]&&"?"==s[b+1].t));)s[l].v+=s[b].v,s[b]={v:"",t:";"},++b;T+=s[l].v,l=b-1;break;case"G":s[l].t="t",s[l].v=fa(t,r)}var w,_,E="";if(T.length>0){40==T.charCodeAt(0)?(w=t<0&&45===T.charCodeAt(0)?-t:t,_=Ia("n",T,w)):(_=Ia("n",T,w=t<0&&n>1?-t:t),w<0&&s[0]&&"t"==s[0].t&&(_=_.substr(1),s[0].v="-"+s[0].v)),b=_.length-1;var C=s.length;for(l=0;l<s.length;++l)if(null!=s[l]&&"t"!=s[l].t&&s[l].v.indexOf(".")>-1){C=l;break}var k=s.length;if(C===s.length&&-1===_.indexOf("E")){for(l=s.length-1;l>=0;--l)null!=s[l]&&-1!=="n?".indexOf(s[l].t)&&(b>=s[l].v.length-1?(b-=s[l].v.length,s[l].v=_.substr(b+1,s[l].v.length)):b<0?s[l].v="":(s[l].v=_.substr(0,b+1),b=-1),s[l].t="t",k=l);b>=0&&k<s.length&&(s[k].v=_.substr(0,b+1)+s[k].v)}else if(C!==s.length&&-1===_.indexOf("E")){for(b=_.indexOf(".")-1,l=C;l>=0;--l)if(null!=s[l]&&-1!=="n?".indexOf(s[l].t)){for(i=s[l].v.indexOf(".")>-1&&l===C?s[l].v.indexOf(".")-1:s[l].v.length-1,E=s[l].v.substr(i+1);i>=0;--i)b>=0&&("0"===s[l].v.charAt(i)||"#"===s[l].v.charAt(i))&&(E=_.charAt(b--)+E);s[l].v=E,s[l].t="t",k=l}for(b>=0&&k<s.length&&(s[k].v=_.substr(0,b+1)+s[k].v),b=_.indexOf(".")+1,l=C;l<s.length;++l)if(null!=s[l]&&(-1!=="n?(".indexOf(s[l].t)||l===C)){for(i=s[l].v.indexOf(".")>-1&&l===C?s[l].v.indexOf(".")+1:0,E=s[l].v.substr(0,i);i<s[l].v.length;++i)b<_.length&&(E+=_.charAt(b++));s[l].v=E,s[l].t="t",k=l}}}for(l=0;l<s.length;++l)null!=s[l]&&"n?".indexOf(s[l].t)>-1&&(w=n>1&&t<0&&l>0&&"-"===s[l-1].v?-t:t,s[l].v=Ia(s[l].t,s[l].v,w),s[l].t="t");var S="";for(l=0;l!==s.length;++l)null!=s[l]&&(S+=s[l].v);return S}(a[1],t,r,a[0])}function La(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=ra[r]){if(ra[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return ra[t]=e,t}function Da(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',ra=e}var Fa={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ua=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Ha=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var i=[];for(n=1;16!=n;++n)i[n-1]="undefined"!==typeof Int32Array?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return i}(t),n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],c=r[5],l=r[6],u=r[7],h=r[8],d=r[9],f=r[10],p=r[11],g=r[12],m=r[13],v=r[14];return e.table=t,e.bstr=function(e,r){for(var n=-1^r,a=0,i=e.length;a<i;)n=n>>>8^t[255&(n^e.charCodeAt(a++))];return~n},e.buf=function(e,r){for(var y=-1^r,b=e.length-15,T=0;T<b;)y=v[e[T++]^255&y]^m[e[T++]^y>>8&255]^g[e[T++]^y>>16&255]^p[e[T++]^y>>>24]^f[e[T++]]^d[e[T++]]^h[e[T++]]^u[e[T++]]^l[e[T++]]^c[e[T++]]^s[e[T++]]^o[e[T++]]^i[e[T++]]^a[e[T++]]^n[e[T++]]^t[e[T++]];for(b+=15;T<b;)y=y>>>8^t[255&(y^e[T++])];return~y},e.str=function(e,r){for(var n=-1^r,a=0,i=e.length,o=0,s=0;a<i;)(o=e.charCodeAt(a++))<128?n=n>>>8^t[255&(n^o)]:o<2048?n=(n=n>>>8^t[255&(n^(192|o>>6&31))])>>>8^t[255&(n^(128|63&o))]:o>=55296&&o<57344?(o=64+(1023&o),s=1023&e.charCodeAt(a++),n=(n=(n=(n=n>>>8^t[255&(n^(240|o>>8&7))])>>>8^t[255&(n^(128|o>>2&63))])>>>8^t[255&(n^(128|s>>6&15|(3&o)<<4))])>>>8^t[255&(n^(128|63&s))]):n=(n=(n=n>>>8^t[255&(n^(224|o>>12&15))])>>>8^t[255&(n^(128|o>>6&63))])>>>8^t[255&(n^(128|63&o))];return~n},e}(),Ba=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function i(e){Lo(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),a=e.read_shift(2),i=e.l+a,o={};if(21589===n)1&(r=e.read_shift(1))&&(o.mtime=e.read_shift(4)),a>5&&(2&r&&(o.atime=e.read_shift(4)),4&r&&(o.ctime=e.read_shift(4))),o.mtime&&(o.mt=new Date(1e3*o.mtime));e.l=i,t[n]=o}return t}function o(){return e||(e={})}function s(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=_(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(Fn&&Buffer.isBuffer(e)?e.toString("binary"):_(e)).split("\r\n"),a=0,i="";for(a=0;a<n.length;++a)if(i=n[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),r||(r=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),i.slice(0,r.length)!=r););var o=(n[1]||"").match(/boundary="(.*?)"/);if(!o)throw new Error("MAD cannot find boundary");var s="--"+(o[1]||""),c=[],l=[],u={FileIndex:c,FullPaths:l};d(u);var h,f=0;for(a=0;a<n.length;++a){var p=n[a];p!==s&&p!==s+"--"||(f++&&le(u,n.slice(h,a),r),h=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,a,i,o,s,f=512,p=[],g=e.slice(0,512);Lo(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(r=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&Lo(g=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,r);var T=g.read_shift(4,"i");if(3===r&&0!==T)throw new Error("# Directory Sectors: Expected 0 saw "+T);g.l+=4,i=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),o=g.read_shift(4,"i"),n=g.read_shift(4,"i"),s=g.read_shift(4,"i"),a=g.read_shift(4,"i");for(var w=-1,E=0;E<109&&!((w=g.read_shift(4,"i"))<0);++E)p[E]=w;var C=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],a=1;a<r;++a)n[a-1]=e.slice(a*t,(a+1)*t);return n[r-1]=e.slice(r*t),n}(e,f);l(s,a,C,f,p);var k=function(e,t,r,n){var a=e.length,i=[],o=[],s=[],c=[],l=n-1,u=0,h=0,d=0,f=0;for(u=0;u<a;++u)if(s=[],(d=u+t)>=a&&(d-=a),!o[d]){c=[];var p=[];for(h=d;h>=0;){p[h]=!0,o[h]=!0,s[s.length]=h,c.push(e[h]);var g=r[Math.floor(4*h/n)];if(n<4+(f=4*h&l))throw new Error("FAT boundary crossed: "+h+" 4 "+n);if(!e[g])break;if(p[h=Ao(e[g],f)])break}i[d]={nodes:s,data:to([c])}}return i}(C,i,p,f);k[i].name="!Directory",n>0&&o!==v&&(k[o].name="!MiniFAT"),k[p[0]].name="!FAT",k.fat_addrs=p,k.ssz=f;var S=[],A=[],I=[];!function(e,t,r,n,a,i,o,s){for(var l,d=0,f=n.length?2:0,p=t[e].data,g=0,m=0;g<p.length;g+=128){var y=p.slice(g,g+128);Lo(y,64),m=y.read_shift(2),l=no(y,0,m-f),n.push(l);var b={name:l,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=h(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=h(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(d=b.start,a>0&&d!==v&&(t[d].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(r,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:d!==v&&b.start!==v&&t[d]&&(b.content=c(b,t[d].data,(t[s]||{}).data))),b.content&&Lo(b.content,0),i[l]=b,o.push(b)}}(i,k,C,S,n,{},A,o),function(e,t,r){for(var n=0,a=0,i=0,o=0,s=0,c=r.length,l=[],u=[];n<c;++n)l[n]=u[n]=n,t[n]=r[n];for(;s<u.length;++s)a=e[n=u[s]].L,i=e[n].R,o=e[n].C,l[n]===n&&(-1!==a&&l[a]!==a&&(l[n]=l[a]),-1!==i&&l[i]!==i&&(l[n]=l[i])),-1!==o&&(l[o]=n),-1!==a&&n!=l[n]&&(l[a]=l[n],u.lastIndexOf(a)<s&&u.push(a)),-1!==i&&n!=l[n]&&(l[i]=l[n],u.lastIndexOf(i)<s&&u.push(i));for(n=1;n<c;++n)l[n]===n&&(-1!==i&&l[i]!==i?l[n]=l[i]:-1!==a&&l[a]!==a&&(l[n]=l[a]));for(n=1;n<c;++n)if(0!==e[n].type){if((s=n)!=l[s])do{s=l[s],t[n]=t[s]+"/"+t[n]}while(0!==s&&-1!==l[s]&&s!=l[s]);l[n]=-1}for(t[0]+="/",n=1;n<c;++n)2!==e[n].type&&(t[n]+="/")}(A,I,S),S.shift();var R={FileIndex:A,FullPaths:I};return t&&t.raw&&(R.raw={header:b,sectors:C}),R}function c(e,t,r){for(var n=e.start,a=e.size,i=[],o=n;r&&a>0&&o>=0;)i.push(t.slice(o*m,o*m+m)),a-=m,o=Ao(r,4*o);return 0===i.length?Fo(0):Kn(i).slice(0,e.size)}function l(e,t,r,n,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var o=r[e],s=(n>>>2)-1;if(!o)return;for(var c=0;c<s&&(i=Ao(o,4*c))!==v;++c)a.push(i);l(Ao(o,n-4),t-1,r,n,a)}}function u(e,t,r,n,a){var i=[],o=[];a||(a=[]);var s=n-1,c=0,l=0;for(c=t;c>=0;){a[c]=!0,i[i.length]=c,o.push(e[c]);var u=r[Math.floor(4*c/n)];if(n<4+(l=4*c&s))throw new Error("FAT boundary crossed: "+c+" 4 "+n);if(!e[u])break;c=Ao(e[u],l)}return{nodes:i,data:to([o])}}function h(e,t){return new Date(1e3*(So(e,t+4)/1e7*Math.pow(2,32)+So(e,t)/1e7-11644473600))}function d(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(Ba.find(e,"/"+t))return;var r=Fo(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){d(e);for(var a=!1,i=!1,o=e.FullPaths.length-1;o>=0;--o){var s=e.FileIndex[o];switch(s.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(s.R*s.L*s.C)&&(a=!0),s.R>-1&&s.L>-1&&s.R==s.L&&(a=!0);break;default:a=!0}}if(a||t){var c=new Date(1987,1,19),l=0,u=Object.create?Object.create(null):{},h=[];for(o=0;o<e.FullPaths.length;++o)u[e.FullPaths[o]]=!0,0!==e.FileIndex[o].type&&h.push([e.FullPaths[o],e.FileIndex[o]]);for(o=0;o<h.length;++o){var f=r(h[o][0]);(i=u[f])||(h.push([f,{name:n(f).replace("/",""),type:1,clsid:T,ct:c,mt:c,content:null}]),u[f]=!0)}for(h.sort((function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),a=0,i=0,o=Math.min(r.length,n.length);a<o;++a){if(i=r[a].length-n[a].length)return i;if(r[a]!=n[a])return r[a]<n[a]?-1:1}return r.length-n.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],o=0;o<h.length;++o)e.FullPaths[o]=h[o][0],e.FileIndex[o]=h[o][1];for(o=0;o<h.length;++o){var p=e.FileIndex[o],g=e.FullPaths[o];if(p.name=n(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||T,0===o)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(l=o+1;l<h.length&&r(e.FullPaths[l])!=g;++l);for(p.C=l>=h.length?-1:l,l=o+1;l<h.length&&r(e.FullPaths[l])!=r(g);++l);p.R=l>=h.length?-1:l,p.type=1}else r(e.FullPaths[o+1]||"")==r(g)&&(p.R=o+1),p.type=2}}}function p(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],i=e.FullPaths[0],o=i,s=e.FileIndex[0],c=1;c<e.FullPaths.length;++c)if(o=e.FullPaths[c].slice(i.length),(s=e.FileIndex[c]).size&&s.content&&"\x01Sh33tJ5"!=o){o=o.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var l=s.content,u=Fn&&Buffer.isBuffer(l)?l.toString("binary"):_(l),h=0,d=Math.min(1024,u.length),f=0,p=0;p<=d;++p)(f=u.charCodeAt(p))>=32&&f<128&&++h;var g=h>=4*d/5;a.push(n),a.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+o),a.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),a.push("Content-Type: "+oe(s,o)),a.push(""),a.push(g?ce(u):se(u))}return a.push(n+"--\r\n"),a.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],i=[],o=Fo(1),s=r.compression?8:0,c=0;0;var l=0,u=0,h=0,d=0,f=e.FullPaths[0],p=f,g=e.FileIndex[0],m=[],v=0;for(l=1;l<e.FullPaths.length;++l)if(p=e.FullPaths[l].slice(f.length),(g=e.FileIndex[l]).size&&g.content&&"\x01Sh33tJ5"!=p){var y=h,b=Fo(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),m[d]=Ha.buf(g.content,0);var T=g.content;8==s&&(T=E(T)),(o=Fo(30)).write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,c),o.write_shift(2,s),g.mt?a(o,g.mt):o.write_shift(4,0),o.write_shift(-4,8&c?0:m[d]),o.write_shift(4,8&c?0:T.length),o.write_shift(4,8&c?0:g.content.length),o.write_shift(2,b.length),o.write_shift(2,0),h+=o.length,n.push(o),h+=b.length,n.push(b),h+=T.length,n.push(T),8&c&&((o=Fo(12)).write_shift(-4,m[d]),o.write_shift(4,T.length),o.write_shift(4,g.content.length),h+=o.l,n.push(o)),(o=Fo(46)).write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,c),o.write_shift(2,s),o.write_shift(4,0),o.write_shift(-4,m[d]),o.write_shift(4,T.length),o.write_shift(4,g.content.length),o.write_shift(2,b.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,y),v+=o.l,i.push(o),v+=b.length,i.push(b),++d}return o=Fo(22),o.write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,d),o.write_shift(2,d),o.write_shift(4,v),o.write_shift(4,h),o.write_shift(2,0),Kn([Kn(n),Kn(i),o])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var a=e.FileIndex[n];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:r+=i+511>>9)}}for(var o=e.FullPaths.length+3>>2,s=t+127>>7,c=(t+7>>3)+r+o+s,l=c+127>>7,u=l<=109?0:Math.ceil((l-109)/127);c+l+u+127>>7>l;)u=++l<=109?0:Math.ceil((l-109)/127);var h=[1,u,l,s,o,r,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),i=Fo(n[7]<<9),o=0,s=0;for(o=0;o<8;++o)i.write_shift(1,b[o]);for(o=0;o<8;++o)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),o=0;o<3;++o)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,n[2]),i.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:v),i.write_shift(4,n[3]),i.write_shift(-4,n[1]?n[0]-1:v),i.write_shift(4,n[1]),o=0;o<109;++o)i.write_shift(-4,o<n[2]?n[1]+o:-1);if(n[1])for(s=0;s<n[1];++s){for(;o<236+127*s;++o)i.write_shift(-4,o<n[2]?n[1]+o:-1);i.write_shift(-4,s===n[1]-1?v:s+1)}var c=function(e){for(s+=e;o<s-1;++o)i.write_shift(-4,o+1);e&&(++o,i.write_shift(-4,v))};for(s=o=0,s+=n[1];o<s;++o)i.write_shift(-4,w.DIFSECT);for(s+=n[2];o<s;++o)i.write_shift(-4,w.FATSECT);c(n[3]),c(n[4]);for(var l=0,u=0,h=e.FileIndex[0];l<e.FileIndex.length;++l)(h=e.FileIndex[l]).content&&((u=h.content.length)<4096||(h.start=s,c(u+511>>9)));for(c(n[6]+7>>3);511&i.l;)i.write_shift(-4,w.ENDOFCHAIN);for(s=o=0,l=0;l<e.FileIndex.length;++l)(h=e.FileIndex[l]).content&&(!(u=h.content.length)||u>=4096||(h.start=s,c(u+63>>6)));for(;511&i.l;)i.write_shift(-4,w.ENDOFCHAIN);for(o=0;o<n[4]<<2;++o){var d=e.FullPaths[o];if(d&&0!==d.length){h=e.FileIndex[o],0===o&&(h.start=h.size?h.start-1:v);var p=0===o&&r.root||h.name;if(u=2*(p.length+1),i.write_shift(64,p,"utf16le"),i.write_shift(2,u),i.write_shift(1,h.type),i.write_shift(1,h.color),i.write_shift(-4,h.L),i.write_shift(-4,h.R),i.write_shift(-4,h.C),h.clsid)i.write_shift(16,h.clsid,"hex");else for(l=0;l<4;++l)i.write_shift(4,0);i.write_shift(4,h.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,h.start),i.write_shift(4,h.size),i.write_shift(4,0)}else{for(l=0;l<17;++l)i.write_shift(4,0);for(l=0;l<3;++l)i.write_shift(4,-1);for(l=0;l<12;++l)i.write_shift(4,0)}}for(o=1;o<e.FileIndex.length;++o)if((h=e.FileIndex[o]).size>=4096)if(i.l=h.start+1<<9,Fn&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+511&-512;else{for(l=0;l<h.size;++l)i.write_shift(1,h.content[l]);for(;511&l;++l)i.write_shift(1,0)}for(o=1;o<e.FileIndex.length;++o)if((h=e.FileIndex[o]).size>0&&h.size<4096)if(Fn&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+63&-64;else{for(l=0;l<h.size;++l)i.write_shift(1,h.content[l]);for(;63&l;++l)i.write_shift(1,0)}if(Fn)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var g,m=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],T="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:T,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function E(e){return g?g.deflateRawSync(e):Y(e)}var C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function A(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var I="undefined"!==typeof Uint8Array,R=I?new Uint8Array(256):[],O=0;O<256;++O)R[O]=A(O);function N(e,t){var r=R[255&e];return t<=8?r>>>8-t:(r=r<<8|R[e>>8&255],t<=16?r>>>16-t:(r=r<<8|R[e>>16&255])>>>24-t)}function x(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function M(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function L(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function D(e,t,r){var n=7&t,a=t>>>3,i=(1<<r)-1,o=e[a]>>>n;return r<8-n?o&i:(o|=e[a+1]<<8-n,r<16-n?o&i:(o|=e[a+2]<<16-n,r<24-n?o&i:(o|=e[a+3]<<24-n)&i))}function F(e,t,r){var n=7&t,a=t>>>3;return n<=5?e[a]|=(7&r)<<n:(e[a]|=r<<n&255,e[a+1]=(7&r)>>8-n),t+3}function U(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function H(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function B(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function j(e,t){var r=e.length,n=2*r>t?2*r:t+5,a=0;if(r>=t)return e;if(Fn){var i=Bn(n);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(I){var o=new Uint8Array(n);if(o.set)o.set(e);else for(;a<r;++a)o[a]=e[a];return o}return e.length=n,e}function z(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function q(e,t,r){var n=1,a=0,i=0,o=0,s=0,c=e.length,l=I?new Uint16Array(32):z(32);for(i=0;i<32;++i)l[i]=0;for(i=c;i<r;++i)e[i]=0;c=e.length;var u=I?new Uint16Array(c):z(c);for(i=0;i<c;++i)l[a=e[i]]++,n<a&&(n=a),u[i]=0;for(l[0]=0,i=1;i<=n;++i)l[i+16]=s=s+l[i-1]<<1;for(i=0;i<c;++i)0!=(s=e[i])&&(u[i]=l[s+16]++);var h=0;for(i=0;i<c;++i)if(0!=(h=e[i]))for(s=N(u[i],n)>>n-h,o=(1<<n+4-h)-1;o>=0;--o)t[s|o<<h]=15&h|i<<4;return n}var K=I?new Uint16Array(512):z(512),G=I?new Uint16Array(32):z(32);if(!I){for(var V=0;V<512;++V)K[V]=0;for(V=0;V<32;++V)G[V]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);q(e,G,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);q(r,K,288)}();var W=function(){for(var e=I?new Uint8Array(32768):[],t=0,r=0;t<S.length-1;++t)for(;r<S[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=I?new Uint8Array(259):[];for(t=0,r=0;t<k.length-1;++t)for(;r<k[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),a=r+n==e.length;for(t.write_shift(1,+a),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var a=0,i=0,o=I?new Uint16Array(32768):[];i<t.length;){var s=Math.min(65535,t.length-i);if(s<10){for(7&(a=F(r,a,+!(i+s!=t.length)))&&(a+=8-(7&a)),r.l=a/8|0,r.write_shift(2,s),r.write_shift(2,65535&~s);s-- >0;)r[r.l++]=t[i++];a=8*r.l}else{a=F(r,a,+!(i+s!=t.length)+2);for(var c=0;s-- >0;){var l=t[i],u=-1,h=0;if((u=o[c=32767&(c<<5^l)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+h]==t[i+h]&&h<250;)++h;if(h>2){(l=n[h])<=22?a=H(r,a,R[l+1]>>1)-1:(H(r,a,3),H(r,a+=5,R[l-23]>>5),a+=3);var d=l<8?0:l-4>>2;d>0&&(B(r,a,h-k[l]),a+=d),l=e[i-u],a=H(r,a,R[l]>>3),a-=3;var f=l<4?0:l-2>>1;f>0&&(B(r,a,i-u-S[l]),a+=f);for(var p=0;p<h;++p)o[c]=32767&i,c=32767&(c<<5^t[i]),++i;s-=h-1}else l<=143?l+=48:a=U(r,a,1),a=H(r,a,R[l]),o[c]=32767&i,++i}a=H(r,a,0)-1}}return r.l=(a+7)/8|0,r.l}(t,r)}}();function Y(e){var t=Fo(50+Math.floor(1.1*e.length)),r=W(e,t);return t.slice(0,r)}var $=I?new Uint16Array(32768):z(32768),Q=I?new Uint16Array(32768):z(32768),J=I?new Uint16Array(128):z(128),X=1,Z=1;function ee(e,t){var r=M(e,t)+257,n=M(e,t+=5)+1,a=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var i=0,o=I?new Uint8Array(19):z(19),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=1,l=I?new Uint8Array(8):z(8),u=I?new Uint8Array(8):z(8),h=o.length,d=0;d<a;++d)o[C[d]]=i=P(e,t),c<i&&(c=i),l[i]++,t+=3;var f=0;for(l[0]=0,d=1;d<=c;++d)u[d]=f=f+l[d-1]<<1;for(d=0;d<h;++d)0!=(f=o[d])&&(s[d]=u[f]++);var p=0;for(d=0;d<h;++d)if(0!=(p=o[d])){f=R[s[d]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)J[f|g<<p]=7&p|d<<3}var m=[];for(c=1;m.length<r+n;)switch(t+=7&(f=J[L(e,t)]),f>>>=3){case 16:for(i=3+x(e,t),t+=2,f=m[m.length-1];i-- >0;)m.push(f);break;case 17:for(i=3+P(e,t),t+=3;i-- >0;)m.push(0);break;case 18:for(i=11+L(e,t),t+=7;i-- >0;)m.push(0);break;default:m.push(f),c<f&&(c=f)}var v=m.slice(0,r),y=m.slice(r);for(d=r;d<286;++d)v[d]=0;for(d=n;d<30;++d)y[d]=0;return X=q(v,$,286),Z=q(y,Q,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[Hn(t),2];for(var r=0,n=0,a=Bn(t||1<<18),i=0,o=a.length>>>0,s=0,c=0;0==(1&n);)if(n=P(e,r),r+=3,n>>>1!=0)for(n>>1==1?(s=9,c=5):(r=ee(e,r),s=X,c=Z);;){!t&&o<i+32767&&(o=(a=j(a,i+32767)).length);var l=D(e,r,s),u=n>>>1==1?K[l]:$[l];if(r+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var d=i+k[u];h>0&&(d+=D(e,r,h),r+=h),l=D(e,r,c),r+=15&(u=n>>>1==1?G[l]:Q[l]);var f=(u>>>=4)<4?0:u-2>>1,p=S[u];for(f>0&&(p+=D(e,r,f),r+=f),!t&&o<d&&(o=(a=j(a,d+100)).length);i<d;)a[i]=a[i-p],++i}}else{7&r&&(r+=8-(7&r));var g=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,g>0)for(!t&&o<i+g&&(o=(a=j(a,i+g)).length);g-- >0;)a[i++]=e[r>>>3],r+=8}return t?[a,r+7>>>3]:[a.slice(0,i),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;Lo(r,0);var n={FileIndex:[],FullPaths:[]};d(n,{root:t.root});for(var a=r.length-4;(80!=r[a]||75!=r[a+1]||5!=r[a+2]||6!=r[a+3])&&a>=0;)--a;r.l=a+4,r.l+=4;var o=r.read_shift(2);r.l+=6;var s=r.read_shift(4);for(r.l=s,a=0;a<o;++a){r.l+=20;var c=r.read_shift(4),l=r.read_shift(4),u=r.read_shift(2),h=r.read_shift(2),f=r.read_shift(2);r.l+=8;var p=r.read_shift(4),g=i(r.slice(r.l+u,r.l+u+h));r.l+=u+h+f;var m=r.l;r.l=p+4,ae(r,c,l,n,g),r.l=m}return n}function ae(e,t,r,n,a){e.l+=2;var o=e.read_shift(2),s=e.read_shift(2),c=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,a=31&r,i=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(i-1),n.setDate(a);var o=31&t,s=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(s),n.setSeconds(o<<1),n}(e);if(8257&o)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var l=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),d=e.read_shift(2),f="",p=0;p<h;++p)f+=String.fromCharCode(e[e.l++]);if(d){var m=i(e.slice(e.l,e.l+d));(m[21589]||{}).mt&&(c=m[21589].mt),((a||{})[21589]||{}).mt&&(c=a[21589].mt)}e.l+=d;var v=e.slice(e.l,e.l+l);switch(s){case 8:v=function(e,t){if(!g)return te(e,t);var r=new(0,g.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var y=!1;8&o&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),l=e.read_shift(4),u=e.read_shift(4)),l!=t&&re(y,"Bad compressed size: "+t+" != "+l),u!=r&&re(y,"Bad uncompressed size: "+r+" != "+u),ue(n,f,v,{unsafe:!0,mt:c})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function oe(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&ie[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&ie[n[1]]?ie[n[1]]:"application/octet-stream"}function se(e){for(var t=Ln(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function ce(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<n.length;++a){var i=n[a];if(0!=i.length)for(var o=0;o<i.length;){var s=76,c=i.slice(o,o+s);"="==c.charAt(s-1)?s--:"="==c.charAt(s-2)?s-=2:"="==c.charAt(s-3)&&(s-=3),c=i.slice(o,o+s),(o+=s)<i.length&&(c+="="),r.push(c)}else r.push("")}return r.join("\r\n")}function le(e,t,r){for(var n,a="",i="",o="",s=0;s<10;++s){var c=t[s];if(!c||c.match(/^\s*$/))break;var l=c.match(/^(.*?):\s*([^\s].*)$/);if(l)switch(l[1].toLowerCase()){case"content-location":a=l[2].trim();break;case"content-type":o=l[2].trim();break;case"content-transfer-encoding":i=l[2].trim()}}switch(++s,i.toLowerCase()){case"base64":n=jn(Dn(t.slice(s).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return jn(t.join("\r\n"))}(t.slice(s));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,a.slice(r.length),n,{unsafe:!0});o&&(u.ctype=o)}function ue(e,t,r,a){var i=a&&a.unsafe;i||d(e);var o=!i&&Ba.find(e,t);if(!o){var s=e.FullPaths[0];t.slice(0,s.length)==s?s=t:("/"!=s.slice(-1)&&(s+="/"),s=(s+t).replace("//","/")),o={name:n(t),type:2},e.FileIndex.push(o),e.FullPaths.push(s),i||Ba.utils.cfb_gc(e)}return o.content=r,o.size=r?r.length:0,a&&(a.CLSID&&(o.clsid=a.CLSID),a.mt&&(o.mt=a.mt),a.ct&&(o.ct=a.ct)),o}return t.find=function(e,t){var r=e.FullPaths.map((function(e){return e.toUpperCase()})),n=r.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=r[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),o=!0===a?r.indexOf(i):n.indexOf(i);if(-1!==o)return e.FileIndex[o];var s=!i.match(Vn);for(i=i.replace(Gn,""),s&&(i=i.replace(Vn,"!")),o=0;o<r.length;++o){if((s?r[o].replace(Vn,"!"):r[o]).replace(Gn,"")==i)return e.FileIndex[o];if((s?n[o].replace(Vn,"!"):n[o]).replace(Gn,"")==i)return e.FileIndex[o]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||Fn&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return o(),s(e.readFileSync(t),r)}(t,r);case"base64":return s(jn(Dn(t)),r);case"binary":return s(jn(t),r)}return s(t,r)},t.parse=s,t.write=function(t,r){var n=p(t,r);switch(r&&r.type||"buffer"){case"file":return o(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:_(n);case"base64":return Ln("string"==typeof n?n:_(n));case"buffer":if(Fn)return Buffer.isBuffer(n)?n:Un(n);case"array":return"string"==typeof n?jn(n):n}return n},t.writeFile=function(t,r,n){o();var a=p(t,n);e.writeFileSync(r,a)},t.utils={cfb_new:function(e){var t={};return d(t,e),t},cfb_add:ue,cfb_del:function(e,t){d(e);var r=Ba.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){d(e);var a=Ba.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=n(r),e.FullPaths[i]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Ro,CheckField:Mo,prep_blob:Lo,bconcat:Kn,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(r){console.error("cannot use native zlib: "+(r.message||r))}},_deflateRaw:Y,_inflateRaw:te,consts:w},t}();let ja;function za(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function qa(e){for(var t=[],r=za(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Ka=new Date(1899,11,30,0,0,0);function Ga(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(Ka.getTime()+6e4*(e.getTimezoneOffset()-Ka.getTimezoneOffset())))/864e5}var Va=new Date,Wa=Ka.getTime()+6e4*(Va.getTimezoneOffset()-Ka.getTimezoneOffset()),Ya=Va.getTimezoneOffset();function $a(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Wa),t.getTimezoneOffset()!==Ya&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Ya)),t}function Qa(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(a[i],10)}return t}var Ja=new Date("2017-02-19T19:06:09.000Z"),Xa=isNaN(Ja.getFullYear())?new Date("2/19/17"):Ja,Za=2017==Xa.getFullYear();function ei(e,t){var r=new Date(e);if(Za)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==Xa.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function ti(e,t){if(Fn&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Bi(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Bi(In(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Bi(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Bi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return r[e]||e}))}catch(i){}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ri(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ri(e[r]));return t}function ni(e,t){for(var r="";r.length<t;)r+=e;return r}function ai(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(n))?t:t/r):t/r}var ii=["january","february","march","april","may","june","july","august","september","october","november","december"];function oi(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==ii.indexOf(o))return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}var si=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var a=t.split(r),i=[a[0]],o=1;o<a.length;++o)i.push(n),i.push(a[o]);return i}}();function ci(e){return e?e.content&&e.type?ti(e.content,!0):e.data?On(e.data):e.asNodeBuffer&&Fn?On(e.asNodeBuffer().toString("binary")):e.asBinary?On(e.asBinary()):e._data&&e._data.getContent?On(ti(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function li(e){if(!e)return null;if(e.data)return An(e.data);if(e.asNodeBuffer&&Fn)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?An(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ui(e,t){for(var r=e.FullPaths||za(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function hi(e,t){var r=ui(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function di(e,t,r){if(!r)return(n=hi(e,t))&&".bin"===n.name.slice(-4)?li(n):ci(n);var n;if(!t)return null;try{return di(e,t)}catch(a){return null}}function fi(e,t,r){if(!r)return ci(hi(e,t));if(!t)return null;try{return fi(e,t)}catch(n){return null}}function pi(e,t,r){if(!r)return li(hi(e,t));if(!t)return null;try{return pi(e,t)}catch(n){return null}}function gi(e){for(var t=e.FullPaths||za(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function mi(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=Fn?Un(r):function(e){for(var t=[],r=0,n=e.length+250,a=Hn(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|63&o;else if(o>=55296&&o<57344){o=64+(1023&o);var s=1023&e.charCodeAt(++i);a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|s>>6&15|(3&o)<<4,a[r++]=128|63&s}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|63&o;r>n&&(t.push(a.slice(0,r)),r=0,a=Hn(65535),n=65530)}return t.push(a.slice(0,r)),Kn(t)}(r),Ba.utils.cfb_add(e,t,n);Ba.utils.cfb_add(e,t,r)}else e.file(t,r)}function vi(e,t){switch(t.type){case"base64":return Ba.read(e,{type:"base64"});case"binary":return Ba.read(e,{type:"binary"});case"buffer":case"array":return Ba.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function yi(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var a=n.shift();".."===a?r.pop():"."!==a&&r.push(a)}return r.join("/")}var bi='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Ti=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,wi=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,_i=bi.match(wi)?wi:/<[^>]*>/g,Ei=/<\w*:/,Ci=/<(\/?)\w+:/;function ki(e,t,r){for(var n={},a=0,i=0;a!==e.length&&(32!==(i=e.charCodeAt(a))&&10!==i&&13!==i);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(Ti),s=0,c="",l=0,u="",h="",d=1;if(o)for(l=0;l!=o.length;++l){for(h=o[l],i=0;i!=h.length&&61!==h.charCodeAt(i);++i);for(u=h.slice(0,i).trim();32==h.charCodeAt(i+1);)++i;for(d=34==(a=h.charCodeAt(i+1))||39==a?1:0,c=h.slice(i+1+d,h.length-d),s=0;s!=u.length&&58!==u.charCodeAt(s);++s);if(s===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,r||(n[u.toLowerCase()]=c);else{var f=(5===s&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(s+1);if(n[f]&&"ext"==u.slice(s-3,s))continue;n[f]=c,r||(n[f.toLowerCase()]=c)}}return n}function Si(e){return e.replace(Ci,"<$1")}var Ai={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ii=qa(Ai),Ri=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(-1==i)return a.replace(e,(function(e,t){return Ai[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}}(),Oi=/[&<>'"]/g;var Ni=/[\u0000-\u001f]/g;function xi(e){return(e+"").replace(Oi,(function(e){return Ii[e]})).replace(/\n/g,"<br/>").replace(Ni,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var Pi=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function Mi(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Li(e){for(var t="",r=0,n=0,a=0,i=0,o=0,s=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(a=e.charCodeAt(r++),n>191&&n<224?(o=(31&n)<<6,o|=63&a,t+=String.fromCharCode(o)):(i=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&i):(s=((7&n)<<18|(63&a)<<12|(63&i)<<6|63&(o=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(1023&s)))));return t}function Di(e){var t,r,n,a=Hn(2*e.length),i=1,o=0,s=0;for(r=0;r<e.length;r+=i)i=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),i=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),i=3):(i=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(a[o++]=255&s,a[o++]=s>>>8,s=0),a[o++]=t%256,a[o++]=t>>>8;return a.slice(0,o).toString("ucs2")}function Fi(e){return Un(e,"binary").toString("utf8")}var Ui="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Hi=Fn&&(Fi(Ui)==Li(Ui)&&Fi||Di(Ui)==Li(Ui)&&Di)||Li,Bi=Fn?function(e){return Un(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},ji=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),zi=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),qi=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Ki=/<\/?(?:vt:)?variant>/g,Gi=/<(?:vt:)([^>]*)>([\s\S]*)</;function Vi(e,t){var r=ki(e),n=e.match(qi(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach((function(e){var t=e.replace(Ki,"").match(Gi);t&&a.push({v:Hi(t[2]),t:t[1]})})),a}var Wi=/(^\s|\s$|\n)/;function Yi(e){return za(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function $i(e,t,r){return"<"+e+(null!=r?Yi(r):"")+(null!=t?(t.match(Wi)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Qi(e){if(Fn&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Hi(zn(qn(e)));throw new Error("Bad input format: expected Buffer or string")}var Ji=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Xi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Zi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var eo=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,a=e[0][r].length;n<a;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},to=Fn?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:Un(e)}))):eo(e)}:eo,ro=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Co(e,a)));return n.join("").replace(Gn,"")},no=Fn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Gn,""):ro(e,t,r)}:ro,ao=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},io=Fn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ao(e,t,r)}:ao,oo=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Eo(e,a)));return n.join("")},so=Fn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):oo(e,t,r)}:oo,co=function(e,t){var r=So(e,t);return r>0?so(e,t+4,t+4+r-1):""},lo=co,uo=function(e,t){var r=So(e,t);return r>0?so(e,t+4,t+4+r-1):""},ho=uo,fo=function(e,t){var r=2*So(e,t);return r>0?so(e,t+4,t+4+r-1):""},po=fo,go=function(e,t){var r=So(e,t);return r>0?no(e,t+4,t+4+r):""},mo=go,vo=function(e,t){var r=So(e,t);return r>0?so(e,t+4,t+4+r):""},yo=vo,bo=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==n?0==a?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}(e,t)},To=bo,wo=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function _o(){no=function(e,t,r){return Rn.utils.decode(1200,e.slice(t,r)).replace(Gn,"")},so=function(e,t,r){return Rn.utils.decode(65001,e.slice(t,r))},lo=function(e,t){var r=So(e,t);return r>0?Rn.utils.decode(wn,e.slice(t+4,t+4+r-1)):""},ho=function(e,t){var r=So(e,t);return r>0?Rn.utils.decode(Tn,e.slice(t+4,t+4+r-1)):""},po=function(e,t){var r=2*So(e,t);return r>0?Rn.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},mo=function(e,t){var r=So(e,t);return r>0?Rn.utils.decode(1200,e.slice(t+4,t+4+r)):""},yo=function(e,t){var r=So(e,t);return r>0?Rn.utils.decode(65001,e.slice(t+4,t+4+r)):""}}Fn&&(lo=function(e,t){if(!Buffer.isBuffer(e))return co(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},ho=function(e,t){if(!Buffer.isBuffer(e))return uo(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},po=function(e,t){if(!Buffer.isBuffer(e))return fo(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},mo=function(e,t){if(!Buffer.isBuffer(e))return go(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},yo=function(e,t){if(!Buffer.isBuffer(e))return vo(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},To=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):bo(e,t)},wo=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Rn&&_o();var Eo=function(e,t){return e[t]},Co=function(e,t){return 256*e[t+1]+e[t]},ko=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},So=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ao=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Io=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ro(e,t){var r,n,a,i,o,s,c="",l=[];switch(t){case"dbcs":if(s=this.l,Fn&&Buffer.isBuffer(this))c=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)c+=String.fromCharCode(Co(this,s)),s+=2;e*=2;break;case"utf8":c=so(this,this.l,this.l+e);break;case"utf16le":e*=2,c=no(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Rn)return Ro.call(this,e,"dbcs");c=Rn.utils.decode(Tn,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":c=lo(this,this.l),e=4+So(this,this.l);break;case"lpstr-cp":c=ho(this,this.l),e=4+So(this,this.l);break;case"lpwstr":c=po(this,this.l),e=4+2*So(this,this.l);break;case"lpp4":e=4+So(this,this.l),c=mo(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+So(this,this.l),c=yo(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,c="";0!==(a=Eo(this,this.l+e++));)l.push(Nn(a));c=l.join("");break;case"_wstr":for(e=0,c="";0!==(a=Co(this,this.l+e));)l.push(Nn(a)),e+=2;e+=2,c=l.join("");break;case"dbcs-cont":for(c="",s=this.l,o=0;o<e;++o){if(this.lens&&-1!==this.lens.indexOf(s))return a=Eo(this,s),this.l=s+1,i=Ro.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),l.join("")+i;l.push(Nn(Co(this,s))),s+=2}c=l.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Rn){c=Rn.utils.decode(Tn,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(c="",s=this.l,o=0;o!=e;++o){if(this.lens&&-1!==this.lens.indexOf(s))return a=Eo(this,s),this.l=s+1,i=Ro.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),l.join("")+i;l.push(Nn(Eo(this,s))),s+=1}c=l.join("");break;default:switch(e){case 1:return r=Eo(this,this.l),this.l++,r;case 2:return r=("i"===t?ko:Co)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?Ao:Io)(this,this.l),this.l+=4,r):(n=So(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?To(this,this.l):To([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:c=io(this,this.l,e)}}return this.l+=e,c}var Oo=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},No=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},xo=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Po(e,t,r){var n=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)xo(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if("sbcs"===r){if("undefined"!==typeof Rn&&874==wn)for(a=0;a!=t.length;++a){var i=Rn.utils.encode(wn,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);n=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,Oo(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?0==o?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var s=0;s<=5;++s,i/=256)e[r+s]=255&i;e[r+6]=(15&a)<<4|15&i,e[r+7]=a>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,No(this,t,this.l)}}return this.l+=n,this}function Mo(e,t){var r=io(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Lo(e,t){e.l=t,e.read_shift=Ro,e.chk=Mo,e.write_shift=Po}function Do(e,t){e.l+=t}function Fo(e){var t=Hn(e);return Lo(t,0),t}function Uo(e,t,r){if(e){var n,a,i;Lo(e,e.l||0);for(var o=e.length,s=0,c=0;e.l<o;){128&(s=e.read_shift(1))&&(s=(127&s)+((127&e.read_shift(1))<<7));var l=ed[s]||ed[65535];for(i=127&(n=e.read_shift(1)),a=1;a<4&&128&n;++a)i+=(127&(n=e.read_shift(1)))<<7*a;c=e.l+i;var u=l.f&&l.f(e,i,r);if(e.l=c,t(u,l,s))return}}}function Ho(){var e=[],t=Fn?256:2048,r=function(e){var t=Fo(e);return Lo(t,0),t},n=r(t),a=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},i=function(e){return n&&e<n.length-n.l?n:(a(),n=r(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(n=e).l&&(n.l=n.length),i(t)},end:function(){return a(),Kn(e)},_bufs:e}}function Bo(e,t,r){var n=ri(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function jo(e,t,r){var n=ri(e);return n.s=Bo(n.s,t.s,r),n.e=Bo(n.e,t.s,r),n}function zo(e,t){if(e.cRel&&e.c<0)for(e=ri(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ri(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=$o(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function qo(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?zo(e.s,t.biff)+":"+zo(e.e,t.biff):(e.s.rRel?"":"$")+Go(e.s.r)+":"+(e.e.rRel?"":"$")+Go(e.e.r):(e.s.cRel?"":"$")+Wo(e.s.c)+":"+(e.e.cRel?"":"$")+Wo(e.e.c)}function Ko(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Go(e){return""+(e+1)}function Vo(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Wo(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Yo(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function $o(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Qo(e){var t=e.indexOf(":");return-1==t?{s:Yo(e),e:Yo(e)}:{s:Yo(e.slice(0,t)),e:Yo(e.slice(t+1))}}function Jo(e,t){return"undefined"===typeof t||"number"===typeof t?Jo(e.s,e.e):("string"!==typeof e&&(e=$o(e)),"string"!==typeof t&&(t=$o(t)),e==t?e:e+":"+t)}function Xo(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Zo(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Ma(e.z,r?Ga(t):t)}catch(n){}try{return e.w=Ma((e.XF||{}).numFmtId||(r?14:0),r?Ga(t):t)}catch(n){return""+t}}function es(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Ns[e.v]||e.v:Zo(e,void 0==t?e.v:t))}function ts(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function rs(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense;null!=Pn&&null==a&&(a=Pn);var i=e||(a?[]:{}),o=0,s=0;if(i&&null!=n.origin){if("number"==typeof n.origin)o=n.origin;else{var c="string"==typeof n.origin?Yo(n.origin):n.origin;o=c.r,s=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Xo(i["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),-1==o&&(l.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if("undefined"!==typeof t[h][d]){var f={v:t[h][d]},p=o+h,g=s+d;if(l.s.r>p&&(l.s.r=p),l.s.c>g&&(l.s.c=g),l.e.r<p&&(l.e.r=p),l.e.c<g&&(l.e.c=g),!t[h][d]||"object"!==typeof t[h][d]||Array.isArray(t[h][d])||t[h][d]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[h][d][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else{if(!n.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||ra[14],n.cellDates?(f.t="d",f.w=Ma(f.z,Ga(f.v))):(f.t="n",f.v=Ga(f.v),f.w=Ma(f.z,f.v))):f.t="s";else f=t[h][d];if(a)i[p]||(i[p]=[]),i[p][g]&&i[p][g].z&&(f.z=i[p][g].z),i[p][g]=f;else{var m=$o({c:g,r:p});i[m]&&i[m].z&&(f.z=i[m].z),i[m]=f}}}return l.s.c<1e7&&(i["!ref"]=Jo(l)),i}function ns(e,t){return rs(null,e,t)}function as(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function is(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function os(e,t){var r=e.l,n=e.read_shift(1),a=as(e),i=[],o={t:a,h:a};if(0!==(1&n)){for(var s=e.read_shift(4),c=0;c!=s;++c)i.push(is(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var ss=os;function cs(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ls(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var us=as;function hs(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var ds=as,fs=hs;function ps(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var a=0===n?To([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Ao(t,0)>>2;return r?a/100:a}function gs(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ms=gs;function vs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ys(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var bs=2,Ts=3,ws=12,_s=80,Es=81,Cs=[_s,Es],ks={1:{n:"CodePage",t:bs},2:{n:"Category",t:_s},3:{n:"PresentationFormat",t:_s},4:{n:"ByteCount",t:Ts},5:{n:"LineCount",t:Ts},6:{n:"ParagraphCount",t:Ts},7:{n:"SlideCount",t:Ts},8:{n:"NoteCount",t:Ts},9:{n:"HiddenCount",t:Ts},10:{n:"MultimediaClipCount",t:Ts},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:_s},15:{n:"Company",t:_s},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:Ts},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:Ts,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:_s},27:{n:"ContentStatus",t:_s},28:{n:"Language",t:_s},29:{n:"Version",t:_s},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Ss={1:{n:"CodePage",t:bs},2:{n:"Title",t:_s},3:{n:"Subject",t:_s},4:{n:"Author",t:_s},5:{n:"Keywords",t:_s},6:{n:"Comments",t:_s},7:{n:"Template",t:_s},8:{n:"LastAuthor",t:_s},9:{n:"RevNumber",t:_s},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:Ts},15:{n:"WordCount",t:Ts},16:{n:"CharCount",t:Ts},17:{n:"Thumbnail",t:71},18:{n:"Application",t:_s},19:{n:"DocSecurity",t:Ts},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},As={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Is=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Rs(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var Os=ri(Rs([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Ns={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xs={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ps={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var Ms={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ls(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ds(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(_i)||[]).forEach((function(e){var a=ki(e);if("<Relationship"===a[0]){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o="External"===a.TargetMode?a.Target:yi(a.Target,t);r[o]=i,n[a.Id]=i}})),r["!id"]=n,r}var Fs="application/vnd.oasis.opendocument.spreadsheet";var Us=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Hs=function(){for(var e=new Array(Us.length),t=0;t<Us.length;++t){var r=Us[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Bs(e){var t={};e=Hi(e);for(var r=0;r<Us.length;++r){var n=Us[r],a=e.match(Hs[r]);null!=a&&a.length>0&&(t[n[1]]=Ri(a[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=ei(t[n[1]]))}return t}var js=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function zs(e,t,r,n){var a=[];if("string"==typeof e)a=Vi(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map((function(e){return{v:e}})));var o="string"==typeof t?Vi(t,n).map((function(e){return e.v})):t,s=0,c=0;if(o.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(s,s+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=c,r.DefinedNames=o.slice(s,s+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(s,s+c)}s+=c}}var qs=/<[^>]+>[^<]*/g;var Ks,Gs={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Vs(e,t,r){Ks||(Ks=qa(Gs)),e[t=Ks[t]||t]=r}function Ws(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Ys(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function $s(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Qs(e,t,r){return 31===t?$s(e):Ys(e,0,r)}function Js(e,t,r){return Qs(e,t,!1===r?0:4)}function Xs(e){var t=e.l,r=tc(e,Es);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,tc(e,Ts)]}function Zs(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,1200===t?"utf16le":"utf8").replace(Gn,"").replace(Vn,"!"),1200===t&&o%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function ec(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function tc(e,t,r){var n,a=e.read_shift(2),i=r||{};if(e.l+=2,t!==ws&&a!==t&&-1===Cs.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(t===ws?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return Ys(e,0,4).replace(Gn,"");case 31:return $s(e);case 64:return Ws(e);case 65:return ec(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Js(e,a,!i.raw).replace(Gn,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Qs(e,t,0)}(e,a).replace(Gn,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Xs(e));return r}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Gn,""),e.l-a&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Gn,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function rc(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0,s=0,c=-1,l={};for(o=0;o!=a;++o){var u=e.read_shift(4),h=e.read_shift(4);i[o]=[u,h+r]}i.sort((function(e,t){return e[1]-t[1]}));var d={};for(o=0;o!=a;++o){if(e.l!==i[o][1]){var f=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=i[o][1]&&(e.l=i[o][1],f=!1)}if((!t||0==o)&&e.l<=i[o][1]&&(f=!1,e.l=i[o][1]),f)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var p=t[i[o][0]];if(d[p.n]=tc(e,p.t,{raw:!0}),"version"===p.p&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(65535&d[p.n])).slice(-4)),"CodePage"==p.n)switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:kn(s=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(1===i[o][0]){if(s=d.CodePage=tc(e,bs),kn(s),-1!==c){var g=e.l;e.l=i[c][1],l=Zs(e,s),e.l=g}}else if(0===i[o][0]){if(0===s){c=o,e.l=i[o+1][1];continue}l=Zs(e,s)}else{var m,v=l[i[o][0]];switch(e[e.l]){case 65:e.l+=4,m=ec(e);break;case 30:case 31:e.l+=4,m=Js(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=ic(e,4);break;case 64:e.l+=4,m=ei(Ws(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[v]=m}}return e.l=r+n,d}function nc(e,t,r){var n=e.content;if(!n)return{};Lo(n,0);var a,i,o,s,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),u=n.read_shift(16);if(u!==Ba.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=n.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),s=n.read_shift(4),1===a&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);2===a&&(o=n.read_shift(16),c=n.read_shift(4));var h,d=rc(n,t),f={SystemIdentifier:l};for(var p in d)f[p]=d[p];if(f.FMTID=i,1===a)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);try{h=rc(n,null)}catch(g){}for(p in h)f[p]=h[p];return f.FMTID=[i,o],f}function ac(e,t){return e.read_shift(t),null}function ic(e,t){return 1===e.read_shift(t)}function oc(e){return e.read_shift(2,"u")}function sc(e,t){return function(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}(e,t,oc)}function cc(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=Tn;(r&&r.biff>=8&&(Tn=1200),r&&8!=r.biff)?12==r.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return Tn=i,o}function lc(e){var t=Tn;Tn=1200;var r,n=e.read_shift(2),a=e.read_shift(1),i=4&a,o=8&a,s=1+(1&a),c=0,l={};o&&(c=e.read_shift(2)),i&&(r=e.read_shift(4));var u=2==s?"dbcs-cont":"sbcs-cont",h=0===n?"":e.read_shift(n,u);return o&&(e.l+=4*c),i&&(e.l+=r),l.t=h,o||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Tn=t,l}function uc(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function hc(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):uc(e,n,r)}function dc(e,t,r){if(r.biff>5)return hc(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function fc(e,t){var r=e.read_shift(16);switch(16,r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Gn,"");return n&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(a>>1,"utf16le").replace(Gn,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function pc(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(Gn,""):""}function gc(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function mc(e,t){var r=gc(e);return r[3]=0,r}function vc(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function yc(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function bc(e){return[e.read_shift(2),ps(e)]}function Tc(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function wc(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var _c=wc;function Ec(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Cc(e){e.l+=2,e.l+=e.read_shift(2)}var kc={0:Cc,4:Cc,5:Cc,6:Cc,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:Cc,9:Cc,10:Cc,11:Cc,12:Cc,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:Cc,15:Cc,16:Cc,17:Cc,18:Cc,19:Cc,20:Cc,21:Ec};function Sc(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ac(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var a=e.read_shift(2);return r&&2==r.biff&&(n=1-(a>>15),a&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},a]}var Ic=dc;function Rc(e,t,r){var n=e.l+t,a=8!=r.biff&&r.biff?2:4,i=e.read_shift(a),o=e.read_shift(a),s=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:s},e:{r:o,c:c}}}function Oc(e,t,r){var n=vc(e);2!=r.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=a,n.t=!0===a||!1===a?"b":"e",n}var Nc=function(e,t,r){return 0===t?"":dc(e,0,r)};function xc(e,t,r){var n,a=e.read_shift(2),i={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=cc(e,0,r),i=e.read_shift(2);if(i!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}(e,t-2,r)),i.body=n||e.read_shift(t-2),"string"===typeof n&&(i.Name=n),i}var Pc=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Mc(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(r&&2==r.biff?1:2),c=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),c=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var l=uc(e,o,r);32&a&&(l=Pc[l.charCodeAt(0)]);var u=n-e.l;r&&2==r.biff&&--u;var h=n!=e.l&&0!==s&&u>0?function(e,t,r,n){var a,i=e.l+t,o=Su(e,n,r);i!==e.l&&(a=ku(e,i-e.l,o,r));return[o,a]}(e,u,r,s):[];return{chKey:i,Name:l,itab:c,rgce:h}}function Lc(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=cc(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);0!==i--;)n.push(yc(e,r.biff,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Dc(e,t,r){var n=_c(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,xu(e,t,r)]}var Fc={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Uc(e,t,r){if(!r.cellStyles)return Do(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),c=e.read_shift(2);2==n&&(e.l+=2);var l={s:a,e:i,w:o,ixfe:s,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}var Hc=vc,Bc=sc,jc=hc;var zc=[2,3,48,49,131,139,140,245],qc=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=qa({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var a=ns(function(t,r){var n=[],a=Hn(1);switch(r.type){case"base64":a=jn(Dn(t));break;case"binary":a=jn(t);break;case"buffer":case"array":a=t}Lo(a,0);var i=a.read_shift(1),o=!!(136&i),s=!1,c=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:s=!0,o=!0;break;case 140:c=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var l=0,u=521;2==i&&(l=a.read_shift(2)),a.l+=3,2!=i&&(l=a.read_shift(4)),l>1048576&&(l=1e6),2!=i&&(u=a.read_shift(2));var h=a.read_shift(2),d=r.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(d=e[a[a.l]]),a.l+=1,a.l+=2),c&&(a.l+=36);for(var f=[],p={},g=Math.min(a.length,2==i?521:u-10-(s?264:0)),m=c?32:11;a.l<g&&13!=a[a.l];)switch((p={}).name=Rn.utils.decode(d,a.slice(a.l,a.l+m)).replace(/[\u0000\r\n].*$/g,""),a.l+=m,p.type=String.fromCharCode(a.read_shift(1)),2==i||c||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==i&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&f.push(p),2!=i&&(a.l+=c?13:14),p.type){case"B":s&&8==p.len||!r.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(n[0]=[],y=0;y!=f.length;++y)n[0][y]=f[y].name;for(;l-- >0;)if(42!==a[a.l])for(++a.l,n[++v]=[],y=0,y=0;y!=f.length;++y){var b=a.slice(a.l,a.l+f[y].len);a.l+=f[y].len,Lo(b,0);var T=Rn.utils.decode(d,b);switch(f[y].type){case"C":T.trim().length&&(n[v][y]=T.replace(/\s+$/,""));break;case"D":8===T.length?n[v][y]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):n[v][y]=T;break;case"F":n[v][y]=parseFloat(T.trim());break;case"+":case"I":n[v][y]=c?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":n[v][y]=!0;break;case"N":case"F":n[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));n[v][y]="##MEMO##"+(c?parseInt(T.trim(),10):b.read_shift(4));break;case"N":(T=T.replace(/\u0000/g,"").trim())&&"."!=T&&(n[v][y]=+T||0);break;case"@":n[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":n[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":n[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[v][y]=-b.read_shift(-8,"f");break;case"B":if(s&&8==f[y].len){n[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else a.l+=h;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=f,n}(t,n),n);return a["!cols"]=n.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete n.DBF,a}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return ts(r(e,t),t)}catch(n){if(t&&t.WTF)throw n}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var a=r||{};if(+a.codepage>=0&&kn(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=Ho(),o=Wd(e,{header:1,raw:!0,cellDates:!0}),s=o[0],c=o.slice(1),l=e["!cols"]||[],u=0,h=0,d=0,f=1;for(u=0;u<s.length;++u)if(((l[u]||{}).DBF||{}).name)s[u]=l[u].DBF.name,++d;else if(null!=s[u]){if(++d,"number"===typeof s[u]&&(s[u]=s[u].toString(10)),"string"!==typeof s[u])throw new Error("DBF Invalid column name "+s[u]+" |"+typeof s[u]+"|");if(s.indexOf(s[u])!==u)for(h=0;h<1024;++h)if(-1==s.indexOf(s[u]+"_"+h)){s[u]+="_"+h;break}}var p=Xo(e["!ref"]),g=[],m=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var y="",b="",T=0,w=[];for(h=0;h<c.length;++h)null!=c[h][u]&&w.push(c[h][u]);if(0!=w.length&&null!=s[u]){for(h=0;h<w.length;++h){switch(typeof w[h]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=w[h]instanceof Date?"D":"C"}T=Math.max(T,String(w[h]).length),y=y&&y!=b?"C":b}T>250&&(T=250),"C"==(b=((l[u]||{}).DBF||{}).type)&&l[u].DBF.len>T&&(T=l[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=l[u].DBF.dec,T=l[u].DBF.len),m[u]="C"==y||"N"==b?T:n[y]||0,f+=m[u],g[u]=y}else g[u]="?"}var _=i.next(32);for(_.write_shift(4,318902576),_.write_shift(4,c.length),_.write_shift(2,296+32*d),_.write_shift(2,f),u=0;u<4;++u)_.write_shift(4,0);for(_.write_shift(4,0|(+t[wn]||3)<<8),u=0,h=0;u<s.length;++u)if(null!=s[u]){var E=i.next(32),C=(s[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,C,"sbcs"),E.write_shift(1,"?"==g[u]?"C":g[u],"sbcs"),E.write_shift(4,h),E.write_shift(1,m[u]||n[g[u]]||0),E.write_shift(1,v[u]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),h+=m[u]||n[g[u]]||0}var k=i.next(264);for(k.write_shift(4,13),u=0;u<65;++u)k.write_shift(4,0);for(u=0;u<c.length;++u){var S=i.next(f);for(S.write_shift(1,0),h=0;h<s.length;++h)if(null!=s[h])switch(g[h]){case"L":S.write_shift(1,null==c[u][h]?63:c[u][h]?84:70);break;case"B":S.write_shift(8,c[u][h]||0,"f");break;case"N":var A="0";for("number"==typeof c[u][h]&&(A=c[u][h].toFixed(v[h]||0)),d=0;d<m[h]-A.length;++d)S.write_shift(1,32);S.write_shift(1,A,"sbcs");break;case"D":c[u][h]?(S.write_shift(4,("0000"+c[u][h].getFullYear()).slice(-4),"sbcs"),S.write_shift(2,("00"+(c[u][h].getMonth()+1)).slice(-2),"sbcs"),S.write_shift(2,("00"+c[u][h].getDate()).slice(-2),"sbcs")):S.write_shift(8,"00000000","sbcs");break;case"C":var I=String(null!=c[u][h]?c[u][h]:"").slice(0,m[h]);for(S.write_shift(1,I,"sbcs"),d=0;d<m[h]-I.length;++d)S.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),Kc=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+za(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?xn(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:xn(n)};function a(e,a){var i,o=e.split(/[\n\r]+/),s=-1,c=-1,l=0,u=0,h=[],d=[],f=null,p={},g=[],m=[],v=[],y=0;for(+a.codepage>=0&&kn(+a.codepage);l!==o.length;++l){y=0;var b,T=o[l].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),w=T.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),_=w[0];if(T.length>0)switch(_){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&d.push(T.slice(3).replace(/;;/g,";"));break;case"C":var E=!1,C=!1,k=!1,S=!1,A=-1,I=-1;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"A":case"G":break;case"X":c=parseInt(w[u].slice(1))-1,C=!0;break;case"Y":for(s=parseInt(w[u].slice(1))-1,C||(c=0),i=h.length;i<=s;++i)h[i]=[];break;case"K":'"'===(b=w[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(ai(b))?isNaN(oi(b).getDate())||(b=ei(b)):(b=ai(b),null!==f&&Oa(f)&&(b=$a(b))),"undefined"!==typeof Rn&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=Rn.utils.decode(a.codepage,b)),E=!0;break;case"E":S=!0;var R=eu(w[u].slice(1),{r:s,c:c});h[s][c]=[h[s][c],R];break;case"S":k=!0,h[s][c]=[h[s][c],"S5S"];break;case"R":A=parseInt(w[u].slice(1))-1;break;case"C":I=parseInt(w[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+T)}if(E&&(h[s][c]&&2==h[s][c].length?h[s][c][0]=b:h[s][c]=b,f=null),k){if(S)throw new Error("SYLK shared formula cannot have own formula");var O=A>-1&&h[A][I];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");h[s][c][1]=nu(O[1],{r:s-A,c:c-I})}break;case"F":var N=0;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"X":c=parseInt(w[u].slice(1))-1,++N;break;case"Y":for(s=parseInt(w[u].slice(1))-1,i=h.length;i<=s;++i)h[i]=[];break;case"M":y=parseInt(w[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=d[parseInt(w[u].slice(1))];break;case"W":for(v=w[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),m[i-1]=0===y?{hidden:!0}:{wch:y},Rl(m[i-1]);break;case"C":m[c=parseInt(w[u].slice(1))-1]||(m[c]={});break;case"R":g[s=parseInt(w[u].slice(1))-1]||(g[s]={}),y>0?(g[s].hpt=y,g[s].hpx=xl(y)):0===y&&(g[s].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+T)}N<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+T)}}return g.length>0&&(p["!rows"]=g),m.length>0&&(p["!cols"]=m),a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),[h,p]}function i(e,t){var r=function(e,t){switch(t.type){case"base64":return a(Dn(e),t);case"binary":return a(e,t);case"buffer":return a(Fn&&Buffer.isBuffer(e)?e.toString("binary"):zn(e),t);case"array":return a(ti(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],i=r[1],o=ns(n,t);return za(i).forEach((function(e){o[e]=i[e]})),o}function o(e,t,r,n){var a="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+ru(e.f,{r:r,c:n}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return ts(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var r,n,a=["ID;PWXL;N;E"],i=[],s=Xo(e["!ref"]),c=Array.isArray(e),l="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=a,e["!cols"].forEach((function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Cl(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=kl(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)}))),e["!rows"]&&function(e,t){t.forEach((function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*Nl(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))}))}(a,e["!rows"]),a.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var u=s.s.r;u<=s.e.r;++u)for(var h=s.s.c;h<=s.e.c;++h){var d=$o({r:u,c:h});(r=c?(e[u]||[])[h]:e[d])&&(null!=r.v||r.f&&!r.F)&&i.push(o(r,0,u,h))}return a.join(l)+l+i.join(l)+l+"E"+l}}}(),Gc=function(){function e(e,t){for(var r=e.split("\n"),n=-1,a=-1,i=0,o=[];i!==r.length;++i)if("BOT"!==r[i].trim()){if(!(n<0)){for(var s=r[i].trim().split(","),c=s[0],l=s[1],u=r[++i]||"";1&(u.match(/["]/g)||[]).length&&i<r.length-1;)u+="\n"+r[++i];switch(u=u.trim(),+c){case-1:if("BOT"===u){o[++n]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?o[n][a]=!0:"FALSE"===u?o[n][a]=!1:isNaN(ai(l))?isNaN(oi(l).getDate())?o[n][a]=l:o[n][a]=ei(l):o[n][a]=ai(l),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),o[n][a++]=""!==u?u:null}if("EOD"===u)break}}else o[++n]=[],a=0;return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}function t(t,r){return ns(function(t,r){switch(r.type){case"base64":return e(Dn(t),r);case"binary":return e(t,r);case"buffer":return e(Fn&&Buffer.isBuffer(t)?t.toString("binary"):zn(t),r);case"array":return e(ti(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}return{to_workbook:function(e,r){return ts(t(e,r),r)},to_sheet:t,from_sheet:function(){var e=function(e,t,r,n,a){e.push(t),e.push(r+","+n),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,a=[],i=Xo(r["!ref"]),o=Array.isArray(r);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var s=i.s.r;s<=i.e.r;++s){t(a,-1,0,"BOT");for(var c=i.s.c;c<=i.e.c;++c){var l=$o({r:s,c:c});if(n=o?(r[s]||[])[c]:r[l])switch(n.t){case"n":var u=n.w;u||null==n.v||(u=n.v),null==u?n.f&&!n.F?t(a,1,0,"="+n.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=Ma(n.z||ra[14],Ga(ei(n.v)))),t(a,0,n.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),Vc=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return ns(function(e,t){for(var r=e.split("\n"),n=-1,a=-1,i=0,o=[];i!==r.length;++i){var s=r[i].trim().split(":");if("cell"===s[0]){var c=Yo(s[1]);if(o.length<=c.r)for(n=o.length;n<=c.r;++n)o[n]||(o[n]=[]);switch(n=c.r,a=c.c,s[2]){case"t":o[n][a]=s[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":o[n][a]=+s[3];break;case"vtf":var l=s[s.length-1];case"vtc":"nl"===s[3]?o[n][a]=!!+s[4]:o[n][a]=+s[4],"vtf"==s[2]&&(o[n][a]=[o[n][a],l])}}}return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}(e,t),t)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(t){if(!t||!t["!ref"])return"";for(var r,n=[],a=[],i="",o=Qo(t["!ref"]),s=Array.isArray(t),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l)if(i=$o({r:c,c:l}),(r=s?(t[c]||[])[l]:t[i])&&null!=r.v&&"z"!==r.t){switch(a=["cell",i,"t"],r.t){case"s":case"str":a.push(e(r.v));break;case"n":r.f?(a[2]="vtf",a[3]="n",a[4]=r.v,a[5]=e(r.f)):(a[2]="v",a[3]=r.v);break;case"b":a[2]="vt"+(r.f?"f":"c"),a[3]="nl",a[4]=r.v?"1":"0",a[5]=e(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=Ga(ei(r.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=r.w||Ma(r.z||ra[14],u);break;case"e":continue}n.push(a.join(":"))}return n.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,r){return ts(t(e,r),r)},to_sheet:t,from_sheet:function(e){return[r,n,a,n,o(e),i].join("\n")}}}(),Wc=function(){function e(e,t,r,n,a){a.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(ai(e))?isNaN(oi(e).getDate())?t[r][n]=e:t[r][n]=ei(e):t[r][n]=ai(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},a=!1,i=0,o=0;i<e.length;++i)34==(o=e.charCodeAt(i))?a=!a:!a&&o in t&&(n[o]=(n[o]||0)+1);for(i in o=[],n)Object.prototype.hasOwnProperty.call(n,i)&&o.push([n[i],i]);if(!o.length)for(i in n=r)Object.prototype.hasOwnProperty.call(n,i)&&o.push([n[i],i]);return o.sort((function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]})),t[o.pop()[1]]||44}function a(e,t){var r=t||{},a="";null!=Pn&&null==r.dense&&(r.dense=Pn);var i=r.dense?[]:{},o={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=n(e.slice(0,1024)):a=r&&r.FS?r.FS:n(e.slice(0,1024));var s=0,c=0,l=0,u=0,h=0,d=a.charCodeAt(0),f=!1,p=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=r.dateNF?function(e){var t="number"==typeof e?ra[e]:e;return t=t.replace(Ua,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function v(){var t=e.slice(u,h),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(l=ai(t)))if(!isNaN(oi(t).getDate())||m&&t.match(m)){n.z=r.dateNF||ra[14];var a=0;m&&t.match(m)&&(t=function(e,t,r){var n=-1,a=-1,i=-1,o=-1,s=-1,c=-1;(t.match(Ua)||[]).forEach((function(e,t){var l=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=l;break;case"d":i=l;break;case"h":o=l;break;case"s":c=l;break;case"m":o>=0?s=l:a=l}})),c>=0&&-1==s&&a>=0&&(s=a,a=-1);var l=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==l.length&&(l="0"+l),8==l.length&&(l="20"+l);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==o&&-1==s&&-1==c?l:-1==n&&-1==a&&-1==i?u:l+"T"+u}(0,r.dateNF,t.match(m)||[]),a=1),r.cellDates?(n.t="d",n.v=ei(t,a)):(n.t="n",n.v=Ga(ei(t,a))),!1!==r.cellText&&(n.w=Ma(n.z,n.v instanceof Date?Ga(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=l;if("z"==n.t||(r.dense?(i[s]||(i[s]=[]),i[s][c]=n):i[$o({c:c,r:s})]=n),u=h+1,g=e.charCodeAt(u),o.e.c<c&&(o.e.c=c),o.e.r<s&&(o.e.r=s),p==d)++c;else if(c=0,++s,r.sheetRows&&r.sheetRows<=s)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===g&&(f=!f);break;case d:case 10:case 13:if(!f&&v())break e}return h-u>0&&v(),i["!ref"]=Jo(o),i}function i(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,r):ns(function(t,r){var n=r||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),o=i.length-1;o>=0&&0===i[o].length;)--o;for(var s=10,c=0,l=0;l<=o;++l)-1==(c=i[l].indexOf(" "))?c=i[l].length:c++,s=Math.max(s,c);for(l=0;l<=o;++l){a[l]=[];var u=0;for(e(i[l].slice(0,s).trim(),a,l,u,n),u=1;u<=(i[l].length-s)/10+1;++u)e(i[l].slice(s+10*(u-1),s+10*u).trim(),a,l,u,n)}return n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}(t,r),r):a(t,r)}function o(e,t){var r="",n="string"==t.type?[0,0,0,0]:zd(e,t);switch(t.type){case"base64":r=Dn(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Rn?Rn.utils.decode(t.codepage,e):Fn&&Buffer.isBuffer(e)?e.toString("binary"):zn(e);break;case"array":r=ti(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=Hi(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Hi(r):"binary"==t.type&&"undefined"!==typeof Rn&&t.codepage&&(r=Rn.utils.decode(t.codepage,Rn.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?Vc.to_sheet("string"==t.type?r:Hi(r),t):i(r,t)}return{to_workbook:function(e,t){return ts(o(e,t),t)},to_sheet:o,from_sheet:function(e){for(var t,r=[],n=Xo(e["!ref"]),a=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){for(var o=[],s=n.s.c;s<=n.e.c;++s){var c=$o({r:i,c:s});if((t=a?(e[i]||[])[s]:e[c])&&null!=t.v){for(var l=(t.w||(es(t),t.w)||"").slice(0,10);l.length<10;)l+=" ";o.push(l+(0===s?" ":""))}else o.push("          ")}r.push(o.join(""))}return r.join("\n")}}}();var Yc=function(){function e(e,t,r){if(e){Lo(e,e.l||0);for(var n=r.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=n[a]||n[65535],o=e.read_shift(2),s=e.l+o,c=i.f&&i.f(e,o,r);if(e.l=s,t(c,i,a))return}}}function t(t,r){if(!t)return t;var n=r||{};null!=Pn&&null==n.dense&&(n.dense=Pn);var a=n.dense?[]:{},i="Sheet1",o="",s=0,c={},l=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},d=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=v,e(t,(function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:h=e;break;case 204:e&&(o=e);break;case 222:o=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||ra[14],n.cellDates&&(e[1].t="d",e[1].v=$a(e[1].v))),n.qpro&&e[3]>s&&(a["!ref"]=Jo(h),c[i]=a,l.push(i),a=n.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i=o||"Sheet"+(s+1),o="");var u=n.dense?(a[e[0].r]||[])[e[0].c]:a[$o(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[$o(e[0])]=e[1]}}),n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=y,14==t[2]&&(n.qpro=!0,t.l=0),e(t,(function(e,t,r){switch(r){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(a["!ref"]=Jo(h),c[i]=a,l.push(i),a=n.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i="Sheet"+(s+1)),d>0&&e[0].r>=d)break;n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[$o(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==s&&(i=e[1])}}),n)}if(a["!ref"]=Jo(h),c[o||i]=a,l.push(o||i),!u.length)return{SheetNames:l,Sheets:c};for(var f={},p=[],g=0;g<u.length;++g)c[l[g]]?(p.push(u[g]||l[g]),f[u[g]]=c[u[g]]||c[l[g]]):(p.push(u[g]),f[u[g]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var a=e.l+t,i=r(e,0,n);if(i[1].t="s",20768==n.vers){e.l++;var o=e.read_shift(1);return i[1].v=e.read_shift(o,"utf8"),i}return n.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,r){var n=Fo(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var a=0;a<n.length;++a){var i=r.charCodeAt(a);n.write_shift(1,i>=128?95:i)}return n.write_shift(1,0),n}function i(e,t,r){var n=Fo(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function o(e,t,r){var n=Fo(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function s(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?Wo(t):Go(t))}var c={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},l=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,r,n){var a=Fo(6+n.length);a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<n.length;++i){var o=n.charCodeAt(i);a.write_shift(1,o>=128?95:o)}return a.write_shift(1,0),a}function d(e,t){var r=u(e),n=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===n&&3221225472===a?(r[1].t="e",r[1].v=15):0===n&&3489660928===a?(r[1].t="e",r[1].v=42):r[1].v=0,r;var o=32768&i;return i=(32767&i)-16446,r[1].v=(1-2*o)*(a*Math.pow(2,i+32)+n*Math.pow(2,i)),r}function f(e,t,r,n){var a=Fo(14);if(a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),0==n)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,o=0,s=0,c=0;return n<0&&(o=1,n=-n),s=0|Math.log2(n),0==(2147483648&(c=(n/=Math.pow(2,s-31))>>>0))&&(++s,c=(n/=2)>>>0),n-=c,c|=2147483648,c>>>=0,i=(n*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,c),s+=16383+(o?32768:0),a.write_shift(2,s),a}function p(e,t){var r=u(e),n=e.read_shift(8,"f");return r[1].v=n,r}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var r=Fo(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var a=e.charCodeAt(n);r[r.l++]=a>127?95:a}return r[r.l++]=0,r}var v={0:{n:"BOF",f:oc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var a=e.l+t,i=r(e,0,n);if(i[1].v=e.read_shift(8,"f"),n.qpro)e.l=a;else{var o=e.read_shift(2);!function(e,t){Lo(e,0);var r=[],n=0,a="",i="",o="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:r.push(e.read_shift(8,"f"));break;case 1:i=s(t[0].c,e.read_shift(2),!0),a=s(t[0].r,e.read_shift(2),!1),r.push(i+a);break;case 2:var d=s(t[0].c,e.read_shift(2),!0),f=s(t[0].r,e.read_shift(2),!1);i=s(t[0].c,e.read_shift(2),!0),a=s(t[0].r,e.read_shift(2),!1),r.push(d+f+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);r.push('"'+p.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:u=r.pop(),o=r.pop(),r.push(["AND","OR"][h-20]+"("+o+","+u+")");break;default:if(h<32&&l[h])u=r.pop(),o=r.pop(),r.push(o+l[h]+u);else{if(!c[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(n=c[h][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+r.join("|")+"|");var g=r.slice(-n);r.length-=n,r.push(c[h][0]+"("+g.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+o),i),e.l+=o}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=u(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:d},24:{n:"NUMBER18",f:function(e,t){var r=u(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=d(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var a=e.read_shift(2);if(14e3==a){for(r[a]=[0,""],r[a][0]=e.read_shift(2);e[e.l];)r[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=u(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var r=p(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&kn(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=Ho(),s=Xo(e["!ref"]),c=Array.isArray(e),l=[];rd(n,0,function(e){var t=Fo(2);return t.write_shift(2,e),t}(1030)),rd(n,6,function(e){var t=Fo(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(s));for(var u=Math.min(s.e.r,8191),h=s.s.r;h<=u;++h)for(var d=Go(h),f=s.s.c;f<=s.e.c;++f){h===s.s.r&&(l[f]=Wo(f));var p=l[f]+d,g=c?(e[h]||[])[f]:e[p];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?rd(n,13,i(h,f,g.v)):rd(n,14,o(h,f,g.v));else rd(n,15,a(h,f,es(g).slice(0,239)))}return rd(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&kn(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=Ho();rd(n,0,function(e){var t=Fo(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,a=0,i=0;i<e.SheetNames.length;++i){var o=e.SheetNames[i],s=e.Sheets[o];if(s&&s["!ref"]){++a;var c=Qo(s["!ref"]);r<c.e.r&&(r=c.e.r),n<c.e.c&&(n=c.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,a),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&rd(n,27,m(e.SheetNames[a],i++));var o=0;for(a=0;a<e.SheetNames.length;++a){var s=e.Sheets[e.SheetNames[a]];if(s&&s["!ref"]){for(var c=Xo(s["!ref"]),l=Array.isArray(s),u=[],d=Math.min(c.e.r,8191),p=c.s.r;p<=d;++p)for(var g=Go(p),v=c.s.c;v<=c.e.c;++v){p===c.s.r&&(u[v]=Wo(v));var y=u[v]+g,b=l?(s[p]||[])[v]:s[y];if(b&&"z"!=b.t)if("n"==b.t)rd(n,23,f(p,v,o,b.v));else rd(n,22,h(p,v,o,es(b).slice(0,239)))}++o}}return rd(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(jn(Dn(e)),r);case"binary":return t(jn(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var $c=function(){var e=ji("t"),t=ji("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var a={t:"s",v:Ri(n[1])},i=r.match(t);return i&&(a.s=function(e){var t={},r=e.match(_i),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=ki(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;t.cp=En[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==i[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}(i[1])),a}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(a).map(r).filter((function(e){return e.v}))}}(),Qc=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Jc=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Xc=/<(?:\w+:)?r>/,Zc=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function el(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ri(Hi(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Hi(e),r&&(n.h=xi(n.t))):e.match(Xc)&&(n.r=Hi(e),n.t=Ri(Hi((e.replace(Zc,"").match(Jc)||[]).join("").replace(_i,""))),r&&(n.h=Qc($c(n.r)))),n):{t:""}}var tl=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,rl=/<(?:\w+:)?(?:si|sstItem)>/g,nl=/<\/(?:\w+:)?(?:si|sstItem)>/;function al(e){if("undefined"!==typeof Rn)return Rn.utils.encode(wn,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function il(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function ol(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function sl(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=il(e,4),t.U=il(e,4),t.W=il(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function cl(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=36==n.Flags;break;case 26625:a=4==n.Flags;break;case 0:a=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function ll(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function ul(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:cl(e,t),v:ll(e,e.length-e.l)}}function hl(){throw new Error("File is password-protected: ECMA-376 Extensible")}function dl(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(_i,(function(e){var r=ki(e);switch(Si(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){n[e]=r[e]}));break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}})),n}function fl(e){var t,r,n=0,a=al(e),i=a.length+1;for((t=Hn(i))[0]=a.length,r=1;r!=i;++r)t[r]=a[r-1];for(r=i-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var pl=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(a){for(var i,o,s,c=al(a),l=function(e){for(var n=t[e.length-1],a=104,i=e.length-1;i>=0;--i)for(var o=e[i],s=0;7!=s;++s)64&o&&(n^=r[a]),o*=2,--a;return n}(c),u=c.length,h=Hn(16),d=0;16!=d;++d)h[d]=0;for(1===(1&u)&&(i=l>>8,h[u]=n(e[0],i),--u,i=255&l,o=c[c.length-1],h[u]=n(o,i));u>0;)i=l>>8,h[--u]=n(c[u],i),i=255&l,h[--u]=n(c[u],i);for(u=15,s=15-c.length;s>0;)i=l>>8,h[u]=n(e[s],i),--s,i=255&l,h[--u]=n(c[u],i),--u,--s;return h}}(),gl=function(e){var t=0,r=pl(e);return function(e){var n=function(e,t,r,n,a){var i,o;for(a||(a=t),n||(n=pl(e)),i=0;i!=t.length;++i)o=t[i],o=255&((o^=n[r])>>5|o<<3),a[i]=o,++r;return[a,r,n]}("",e,t,r);return t=n[1],n[0]}};function ml(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=il(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=il(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=cl(e,a),t-=a,r.EncryptionVerifier=ll(e,t),r}(e,t),n}var vl=function(){function e(e,r){switch(r.type){case"base64":return t(Dn(e),r);case"binary":return t(e,r);case"buffer":return t(Fn&&Buffer.isBuffer(e)?e.toString("binary"):zn(e),r);case"array":return t(ti(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach((function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,i=/\\\w+\b/g,o=0,s=-1;n=i.exec(e);){if("\\cell"===n[0]){var c=e.slice(o,i.lastIndex-n[0].length);if(" "==c[0]&&(c=c.slice(1)),++s,c.length){var l={v:c,t:"s"};Array.isArray(r)?r[t][s]=l:r[$o({r:t,c:s})]=l}}o=i.lastIndex}s>a.e.c&&(a.e.c=s)})),r["!ref"]=Jo(a),r}return{to_workbook:function(t,r){return ts(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=Xo(e["!ref"]),a=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){r.push("\\trowd\\trautofit1");for(var o=n.s.c;o<=n.e.c;++o)r.push("\\cellx"+(o+1));for(r.push("\\pard\\intbl"),o=n.s.c;o<=n.e.c;++o){var s=$o({r:i,c:o});(t=a?(e[i]||[])[o]:e[s])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(es(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function yl(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function bl(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),o=a-i;if(0===o)return[0,0,t];var s,c=0,l=a+i;switch(s=o/(l>1?2-l:l),a){case t:c=((r-n)/o+6)%6;break;case r:c=(n-t)/o+2;break;case n:c=(t-r)/o+4}return[c/6,s,l/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),yl(function(e){var t,r=e[0],n=e[1],a=e[2],i=2*n*(a<.5?a:1-a),o=a-i/2,s=[o,o,o],c=6*r;if(0!==n)switch(0|c){case 0:case 6:t=i*c,s[0]+=i,s[1]+=t;break;case 1:t=i*(2-c),s[0]+=t,s[1]+=i;break;case 2:t=i*(c-2),s[1]+=i,s[2]+=t;break;case 3:t=i*(4-c),s[1]+=t,s[2]+=i;break;case 4:t=i*(c-4),s[2]+=i,s[0]+=t;break;case 5:t=i*(6-c),s[2]+=t,s[0]+=i}for(var l=0;3!=l;++l)s[l]=Math.round(255*s[l]);return s}(r))}var Tl=6,wl=15,_l=1,El=Tl;function Cl(e){return Math.floor((e+Math.round(128/El)/256)*El)}function kl(e){return Math.floor((e-5)/El*100+.5)/100}function Sl(e){return Math.round((e*El+5)/El*256)/256}function Al(e){return Sl(kl(Cl(e)))}function Il(e){var t=Math.abs(e-Al(e)),r=El;if(t>.005)for(El=_l;El<wl;++El)Math.abs(e-Al(e))<=t&&(t=Math.abs(e-Al(e)),r=El);El=r}function Rl(e){e.width?(e.wpx=Cl(e.width),e.wch=kl(e.wpx),e.MDW=El):e.wpx?(e.wch=kl(e.wpx),e.width=Sl(e.wch),e.MDW=El):"number"==typeof e.wch&&(e.width=Sl(e.wch),e.wpx=Cl(e.width),e.MDW=El),e.customWidth&&delete e.customWidth}var Ol=96;function Nl(e){return 96*e/Ol}function xl(e){return e*Ol/96}var Pl={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var Ml=["numFmtId","fillId","fontId","borderId","xfId"],Ll=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Dl=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,o,s){var c,l={};return i?((c=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var n=za(ra),a=0;a<n.length;++a)t.NumberFmt[n[a]]=ra[n[a]];var i=e[0].match(_i);if(i)for(a=0;a<i.length;++a){var o=ki(i[a]);switch(Si(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var s=Ri(Hi(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=s,c>0){if(c>392){for(c=392;c>60&&null!=t.NumberFmt[c];--c);t.NumberFmt[c]=s}La(s,c)}break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}(c,l,s),(c=i.match(n))&&function(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(_i)||[]).forEach((function(e){var o=ki(e);switch(Si(o[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Hi(o.val));break;case"<b":a.bold=o.val?Mi(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Mi(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Mi(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Mi(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Mi(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Mi(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Mi(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<charset":if("1"==o.val)break;o.codepage=En[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Mi(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var s=Os[a.color.index];81==a.color.index&&(s=Os[1]),s||(s=Os[1]),a.color.rgb=s[0].toString(16)+s[1].toString(16)+s[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=bl(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}}))}(c,l,o,s),(c=i.match(r))&&function(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(_i)||[]).forEach((function(e){var r=ki(e);switch(Si(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":r.patternType&&(a.patternType=r.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),r.indexed&&(a.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(a.bgColor.theme=parseInt(r.theme,10)),r.tint&&(a.bgColor.tint=parseFloat(r.tint)),r.rgb&&(a.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),r.theme&&(a.fgColor.theme=parseInt(r.theme,10)),r.tint&&(a.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(a.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+r[0]+" in fills")}}))}(c,l,0,s),(c=i.match(a))&&function(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(_i)||[]).forEach((function(e){var r=ki(e);switch(Si(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},r.diagonalUp&&(a.diagonalUp=Mi(r.diagonalUp)),r.diagonalDown&&(a.diagonalDown=Mi(r.diagonalDown)),t.Borders.push(a);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+r[0]+" in borders")}}))}(c,l,0,s),(c=i.match(t))&&function(e,t,r){var n;t.CellXf=[];var a=!1;(e[0].match(_i)||[]).forEach((function(e){var i=ki(e),o=0;switch(Si(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=i)[0],o=0;o<Ml.length;++o)n[Ml[o]]&&(n[Ml[o]]=parseInt(n[Ml[o]],10));for(o=0;o<Ll.length;++o)n[Ll[o]]&&(n[Ll[o]]=Mi(n[Ll[o]]));if(t.NumberFmt&&n.numFmtId>392)for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var s={};i.vertical&&(s.vertical=i.vertical),i.horizontal&&(s.horizontal=i.horizontal),null!=i.textRotation&&(s.textRotation=i.textRotation),i.indent&&(s.indent=i.indent),i.wrapText&&(s.wrapText=Mi(i.wrapText)),n.alignment=s;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}}))}(c,l,s),l):l}}();var Fl=Do;var Ul=Do;var Hl=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Bl(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(_i)||[]).forEach((function(e){var a=ki(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[Hl.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}}))}function jl(){}function zl(){}var ql=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Kl=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Gl=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Vl=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Wl(e,t){var r;e&&0!==e.length||(e=Yl());var n={};if(!(r=e.match(Vl)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",ql,Bl],["fontScheme",Kl,jl],["fmtScheme",Gl,zl]].forEach((function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)}))}(r[0],n,t),n.raw=e,n}function Yl(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[bi];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $l(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Do(e,t)}(e,4);break;case 2:t.xclrValue=gc(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function Ql(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=$l(e);break;case 6:n[1]=function(e,t){return Do(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Jl(e,t,r,n){var a,i=Array.isArray(e);t.forEach((function(t){var o=Yo(t.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[t.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[t.ref]=a;var s=Xo(e["!ref"]||"BDWGO1000001:A1");s.s.r>o.r&&(s.s.r=o.r),s.e.r<o.r&&(s.e.r=o.r),s.s.c>o.c&&(s.s.c=o.c),s.e.c<o.c&&(s.e.c=o.c);var c=Jo(s);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var l={a:t.author,t:t.t,r:t.r,T:r};t.h&&(l.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!r&&a.c[u].T)return;r&&!a.c[u].T&&a.c.splice(u,1)}if(r&&n)for(u=0;u<n.length;++u)if(l.a==n[u].id){l.a=n[u].name||l.a;break}a.c.push(l)}))}var Xl=as;var Zl="application/vnd.ms-office.vbaProject";var eu=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,a){var i=!1,o=!1;0==n.length?o=!0:"["==n.charAt(0)&&(o=!0,n=n.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var s=n.length>0?0|parseInt(n,10):0,c=a.length>0?0|parseInt(a,10):0;return i?c+=t.c:--c,o?s+=t.r:--s,r+(i?"":"$")+Wo(c)+(o?"":"$")+Go(s)}return function(n,a){return t=a,n.replace(e,r)}}(),tu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ru=function(){return function(e,t){return e.replace(tu,(function(e,r,n,a,i,o){var s=Vo(a)-(n?0:t.c),c=Ko(o)-(i?0:t.r);return r+"R"+(0==c?"":i?c+1:"["+c+"]")+"C"+(0==s?"":n?s+1:"["+s+"]")}))}}();function nu(e,t){return e.replace(tu,(function(e,r,n,a,i,o){return r+("$"==n?n+a:Wo(Vo(a)+t.c))+("$"==i?i+o:Go(Ko(o)+t.r))}))}function au(e,t,r){var n=Qo(t).s,a=Yo(r);return nu(e,{r:a.r-n.r,c:a.c-n.c})}function iu(e){return e.replace(/_xlfn\./g,"")}function ou(e){e.l+=1}function su(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function cu(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return lu(e);12==r.biff&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=su(e,2),s=su(e,2);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function lu(e){var t=su(e,2),r=su(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function uu(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=su(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),a=su(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function hu(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function du(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function fu(e){return[e.read_shift(1),e.read_shift(1)]}function pu(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=ic(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Ns[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=vs(e);break;case 2:r[1]=dc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function gu(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),a=[],i=0;i!=n;++i)a.push((12==r.biff?ms:Tc)(e,8));return a}function mu(e,t,r){var n=0,a=0;12==r.biff?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--a&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var s=0;s!=a;++s)o[i][s]=pu(e,r.biff);return o}function vu(e,t,r){return e.l+=2,[hu(e)]}function yu(e){return e.l+=6,[]}function bu(e){return e.l+=2,[oc(e),1&e.read_shift(2)]}var Tu=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var wu={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Do},3:{n:"PtgAdd",f:ou},4:{n:"PtgSub",f:ou},5:{n:"PtgMul",f:ou},6:{n:"PtgDiv",f:ou},7:{n:"PtgPower",f:ou},8:{n:"PtgConcat",f:ou},9:{n:"PtgLt",f:ou},10:{n:"PtgLe",f:ou},11:{n:"PtgEq",f:ou},12:{n:"PtgGe",f:ou},13:{n:"PtgGt",f:ou},14:{n:"PtgNe",f:ou},15:{n:"PtgIsect",f:ou},16:{n:"PtgUnion",f:ou},17:{n:"PtgRange",f:ou},18:{n:"PtgUplus",f:ou},19:{n:"PtgUminus",f:ou},20:{n:"PtgPercent",f:ou},21:{n:"PtgParen",f:ou},22:{n:"PtgMissArg",f:ou},23:{n:"PtgStr",f:function(e,t,r){return e.l++,cc(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Ns[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,vs(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[zu[a],ju[a],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?ju:Bu)[i[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,i]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,uu(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,cu(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Do},40:{n:"PtgMemNoMem",f:Do},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==a&&r>=128&&(r-=256),{r:t,c:r,cRel:a,rRel:n}}(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(16384&i)>>14,s=(32768&i)>>15;if(i&=16383,1==s)for(;a>524287;)a-=1048576;if(1==o)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:o,rRel:s}}(e,0,r);return[n,a]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=function(e,t,r){if(r.biff<8)return lu(e);var n=e.read_shift(12==r.biff?4:2),a=e.read_shift(12==r.biff?4:2),i=su(e,2),o=su(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}(e,0,r);return[n,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,a,uu(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12,6;break;case 12:12}return[n,a,cu(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[n,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[n,a]}},255:{}},_u={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Eu={1:{n:"PtgElfLel",f:bu},2:{n:"PtgElfRw",f:vu},3:{n:"PtgElfCol",f:vu},6:{n:"PtgElfRwV",f:vu},7:{n:"PtgElfColV",f:vu},10:{n:"PtgElfRadical",f:vu},11:{n:"PtgElfRadicalS",f:yu},13:{n:"PtgElfColS",f:yu},15:{n:"PtgElfColSV",f:yu},16:{n:"PtgElfRadicalLel",f:bu},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&r,rt:Tu[r>>2&31],idx:n,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Cu={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&2==r.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:du},33:{n:"PtgAttrBaxcel",f:du},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),fu(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),fu(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function ku(e,t,r,n){if(n.biff<8)return Do(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=mu(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=gu(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&12==n.biff&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return 0!==(t=a-e.l)&&i.push(Do(e,t)),i}function Su(e,t,r){for(var n,a,i=e.l+t,o=[];i!=e.l;)t=i-e.l,a=e[e.l],n=wu[a]||wu[_u[a]],24!==a&&25!==a||(n=(24===a?Eu:Cu)[e[e.l+1]]),n&&n.f?o.push([n.n,n.f(e,t,r)]):Do(e,t);return o}function Au(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)if(2===o[0])a.push('"'+o[1].replace(/"/g,'""')+'"');else a.push(o[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var Iu={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ru(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[n[0]][0][3]?(a=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ou(e,t,r){var n=Ru(e,t,r);return"#REF"==n?n:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function Nu(e,t,r,n,a){var i,o,s,c,l=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],d=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=h.pop(),o=h.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=ni(" ",e[0][g][1][1]);break;case 1:m=ni("\r",e[0][g][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}o+=m,g=-1}h.push(o+Iu[b[0]]+i);break;case"PtgIsect":i=h.pop(),o=h.pop(),h.push(o+" "+i);break;case"PtgUnion":i=h.pop(),o=h.pop(),h.push(o+","+i);break;case"PtgRange":i=h.pop(),o=h.pop(),h.push(o+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":s=Bo(b[1][1],u,a),h.push(zo(s,l));break;case"PtgRefN":s=r?Bo(b[1][1],r,a):b[1][1],h.push(zo(s,l));break;case"PtgRef3d":d=b[1][1],s=Bo(b[1][2],u,a);p=Ou(n,d,a);h.push(p+"!"+zo(s,l));break;case"PtgFunc":case"PtgFuncVar":var T=b[1][0],w=b[1][1];T||(T=0);var _=0==(T&=127)?[]:h.slice(-T);h.length-=T,"User"===w&&(w=_.shift()),h.push(w+"("+_.join(",")+")");break;case"PtgBool":h.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(b[1]);break;case"PtgNum":h.push(String(b[1]));break;case"PtgStr":h.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":c=jo(b[1][1],r?{s:r}:u,a),h.push(qo(c,a));break;case"PtgArea":c=jo(b[1][1],u,a),h.push(qo(c,a));break;case"PtgArea3d":d=b[1][1],c=b[1][2],p=Ou(n,d,a),h.push(p+"!"+qo(c,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":f=b[1][2];var E=(n.names||[])[f-1]||(n[0]||[])[f],C=E?E.Name:"SH33TJSNAME"+String(f);C&&"_xlfn."==C.slice(0,6)&&!a.xlfn&&(C=C.slice(6)),h.push(C);break;case"PtgNameX":var k,S=b[1][1];if(f=b[1][2],!(a.biff<=5)){var A="";if(14849==((n[S]||[])[0]||[])[0]||(1025==((n[S]||[])[0]||[])[0]?n[S][f]&&n[S][f].itab>0&&(A=n.SheetNames[n[S][f].itab-1]+"!"):A=n.SheetNames[f-1]+"!"),n[S]&&n[S][f])A+=n[S][f].Name;else if(n[0]&&n[0][f])A+=n[0][f].Name;else{var I=(Ru(n,S,a)||"").split(";;");I[f-1]?A=I[f-1]:A+="SH33TJSERRX"}h.push(A);break}S<0&&(S=-S),n[S]&&(k=n[S][f]),k||(k={Name:"SH33TJSERRY"}),h.push(k.Name);break;case"PtgParen":var R="(",O=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:R=ni(" ",e[0][g][1][1])+R;break;case 3:R=ni("\r",e[0][g][1][1])+R;break;case 4:O=ni(" ",e[0][g][1][1])+O;break;case 5:O=ni("\r",e[0][g][1][1])+O;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}h.push(R+h.pop()+O);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":s={c:b[1][1],r:b[1][0]};var N={c:r.c,r:r.r};if(n.sharedf[$o(s)]){var x=n.sharedf[$o(s)];h.push(Nu(x,u,N,n,a))}else{var P=!1;for(i=0;i!=n.arrayf.length;++i)if(o=n.arrayf[i],!(s.c<o[0].s.c||s.c>o[0].e.c)&&!(s.r<o[0].s.r||s.r>o[0].e.r)){h.push(Nu(o[1],u,N,n,a)),P=!0;break}P||h.push(b[1])}break;case"PtgArray":h.push("{"+Au(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var M=!0;switch((b=e[0][g])[1][0]){case 4:M=!1;case 0:m=ni(" ",b[1][1]);break;case 5:M=!1;case 1:m=ni("\r",b[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}h.push((M?m:"")+h.pop()+(M?"":m)),g=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return h[0]}function xu(e,t,r){var n,a=e.l+t,i=2==r.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],Do(e,t-2)];var s=Su(e,o,r);return t!==o+i&&(n=ku(e,t-o-i,s,r)),e.l=a,[s,n]}function Pu(e,t,r){var n,a=e.l+t,i=e.read_shift(2),o=Su(e,i,r);return 65535==i?[[],Do(e,t-2)]:(t!==i+2&&(n=ku(e,a-i-2,o,r)),[o,n])}function Mu(e,t,r){var n=e.l+t,a=vc(e);2==r.biff&&++e.l;var i=function(e){var t;if(65535!==Co(e,e.l+6))return[vs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),o=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var s=function(e,t,r){var n,a=e.l+t,i=2==r.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],Do(e,t-2)];var s=Su(e,o,r);return t!==o+i&&(n=ku(e,t-o-i,s,r)),e.l=a,[s,n]}(e,n-e.l,r);return{cell:a,val:i[0],formula:s,shared:o>>3&1,tt:i[1]}}function Lu(e,t,r){var n=e.read_shift(4),a=Su(e,n,r),i=e.read_shift(4);return[a,i>0?ku(e,i,a,r):null]}var Du=Lu,Fu=Lu,Uu=Lu,Hu=Lu,Bu={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ju={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},zu={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function qu(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Ku(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Gu={},Vu={};function Wu(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function Yu(e,t,r,n,a,i){try{n.cellNF&&(e.z=ra[t])}catch(s){if(n.WTF)throw s}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=ei(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==ra[t]&&La(Fa[t]||"General",t),"e"===e.t)e.w=e.w||Ns[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=da(e.v);else if("d"===e.t){var o=Ga(e.v);e.w=(0|o)===o?o.toString(10):da(o)}else{if(void 0===e.v)return"";e.w=fa(e.v,Vu)}else"d"===e.t?e.w=Ma(t,Ga(e.v),Vu):e.w=Ma(t,e.v,Vu)}catch(s){if(n.WTF)throw s}if(n.cellStyles&&null!=r)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=bl(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=bl(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(s){if(n.WTF&&i.Fills)throw s}}}var $u=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Qu=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Ju=/<(?:\w:)?hyperlink [^>]*>/gm,Xu=/"(\w*:\w*)"/,Zu=/<(?:\w:)?col\b[^>]*[\/]?>/g,eh=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,th=/<(?:\w:)?pageMargins[^>]*\/>/g,rh=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,nh=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ah=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ih(e,t,r,n,a,i,o){if(!e)return e;n||(n={"!id":{}}),null!=Pn&&null==t.dense&&(t.dense=Pn);var s=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",h=e.match(Qu);h?(l=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):l=u=e;var d=l.match(rh);d?oh(d[0],s,a,r):(d=l.match(nh))&&function(e,t,r,n,a){oh(e.slice(0,e.indexOf(">")),r,n,a)}(d[0],d[1],s,a,r);var f=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=l.slice(f,f+50).match(Xu);p&&function(e,t){var r=Xo(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Jo(r))}(s,p[1])}var g=l.match(ah);g&&g[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(sh)||[]).forEach((function(e,r){var n=ki(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),Mi(n.rightToLeft)&&(t.Views[r].RTL=!0)}))}(g[1],a);var m=[];if(t.cellStyles){var v=l.match(Zu);v&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=ki(t[n],!0);a.hidden&&(a.hidden=Mi(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Il(a.width)),Rl(a);i<=o;)e[i++]=ri(a)}}(m,v)}h&&ch(h[1],s,t,c,i,o);var y=u.match(eh);y&&(s["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],T=u.match($u);if(T)for(f=0;f!=T.length;++f)b[f]=Xo(T[f].slice(T[f].indexOf('"')+1));var w=u.match(Ju);w&&function(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=ki(Hi(t[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Ri(i.location))):(i.Target="#"+Ri(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var s=Xo(i.ref),c=s.s.r;c<=s.e.r;++c)for(var l=s.s.c;l<=s.e.c;++l){var u=$o({c:l,r:c});n?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}(s,w,n);var _=u.match(th);if(_&&(s["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(r){e[r]&&(t[r]=parseFloat(e[r]))})),t}(ki(_[0]))),!s["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(s["!ref"]=Jo(c)),t.sheetRows>0&&s["!ref"]){var E=Xo(s["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),s["!fullref"]=s["!ref"],s["!ref"]=Jo(E))}return m.length>0&&(s["!cols"]=m),b.length>0&&(s["!merges"]=b),s}function oh(e,t,r,n){var a=ki(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ri(Hi(a.codeName)))}var sh=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var ch=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=ji("v"),o=ji("f");return function(s,c,l,u,h,d){for(var f,p,g,m,v,y=0,b="",T=[],w=[],_=0,E=0,C=0,k="",S=0,A=0,I=0,R=0,O=Array.isArray(d.CellXf),N=[],x=[],P=Array.isArray(c),M=[],L={},D=!1,F=!!l.sheetStubs,U=s.split(t),H=0,B=U.length;H!=B;++H){var j=(b=U[H].trim()).length;if(0!==j){var z=0;e:for(y=0;y<j;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(l&&l.cellStyles){if(S=null!=(p=ki(b.slice(z,y),!0)).r?parseInt(p.r,10):S+1,A=-1,l.sheetRows&&l.sheetRows<S)continue;L={},D=!1,p.ht&&(D=!0,L.hpt=parseFloat(p.ht),L.hpx=xl(L.hpt)),"1"==p.hidden&&(D=!0,L.hidden=!0),null!=p.outlineLevel&&(D=!0,L.level=+p.outlineLevel),D&&(M[S-1]=L)}break;case"<":z=y}if(z>=y)break;if(S=null!=(p=ki(b.slice(z,y),!0)).r?parseInt(p.r,10):S+1,A=-1,!(l.sheetRows&&l.sheetRows<S)){u.s.r>S-1&&(u.s.r=S-1),u.e.r<S-1&&(u.e.r=S-1),l&&l.cellStyles&&(L={},D=!1,p.ht&&(D=!0,L.hpt=parseFloat(p.ht),L.hpx=xl(L.hpt)),"1"==p.hidden&&(D=!0,L.hidden=!0),null!=p.outlineLevel&&(D=!0,L.level=+p.outlineLevel),D&&(M[S-1]=L)),T=b.slice(y).split(e);for(var q=0;q!=T.length&&"<"==T[q].trim().charAt(0);++q);for(T=T.slice(q),y=0;y!=T.length;++y)if(0!==(b=T[y].trim()).length){if(w=b.match(r),_=y,E=0,C=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=w&&2===w.length){for(_=0,k=w[1],E=0;E!=k.length&&!((C=k.charCodeAt(E)-64)<1||C>26);++E)_=26*_+C;A=--_}else++A;for(E=0;E!=b.length&&62!==b.charCodeAt(E);++E);if(++E,(p=ki(b.slice(0,E),!0)).r||(p.r=$o({r:S-1,c:A})),f={t:""},null!=(w=(k=b.slice(E)).match(i))&&""!==w[1]&&(f.v=Ri(w[1])),l.cellFormula){if(null!=(w=k.match(o))&&""!==w[1]){if(f.f=Ri(Hi(w[1])).replace(/\r\n/g,"\n"),l.xlfn||(f.f=iu(f.f)),w[0].indexOf('t="array"')>-1)f.F=(k.match(a)||[])[1],f.F.indexOf(":")>-1&&N.push([Xo(f.F),f.F]);else if(w[0].indexOf('t="shared"')>-1){m=ki(w[0]);var K=Ri(Hi(w[1]));l.xlfn||(K=iu(K)),x[parseInt(m.si,10)]=[m,K,p.r]}}else(w=k.match(/<f[^>]*\/>/))&&x[(m=ki(w[0])).si]&&(f.f=au(x[m.si][1],x[m.si][2],p.r));var G=Yo(p.r);for(E=0;E<N.length;++E)G.r>=N[E][0].s.r&&G.r<=N[E][0].e.r&&G.c>=N[E][0].s.c&&G.c<=N[E][0].e.c&&(f.F=N[E][1])}if(null==p.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!F)continue;f.t="z"}else f.t=p.t||"n";switch(u.s.c>A&&(u.s.c=A),u.e.c<A&&(u.e.c=A),f.t){case"n":if(""==f.v||null==f.v){if(!F)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!F)continue;f.t="z"}else g=Gu[parseInt(f.v,10)],f.v=g.t,f.r=g.r,l.cellHTML&&(f.h=g.h);break;case"str":f.t="s",f.v=null!=f.v?Hi(f.v):"",l.cellHTML&&(f.h=xi(f.v));break;case"inlineStr":w=k.match(n),f.t="s",null!=w&&(g=el(w[1]))?(f.v=g.t,l.cellHTML&&(f.h=g.h)):f.v="";break;case"b":f.v=Mi(f.v);break;case"d":l.cellDates?f.v=ei(f.v,1):(f.v=Ga(ei(f.v,1)),f.t="n");break;case"e":l&&!1===l.cellText||(f.w=f.v),f.v=xs[f.v]}if(I=R=0,v=null,O&&void 0!==p.s&&null!=(v=d.CellXf[p.s])&&(null!=v.numFmtId&&(I=v.numFmtId),l.cellStyles&&null!=v.fillId&&(R=v.fillId)),Yu(f,I,R,l,h,d),l.cellDates&&O&&"n"==f.t&&Oa(ra[I])&&(f.t="d",f.v=$a(f.v)),p.cm&&l.xlmeta){var V=(l.xlmeta.Cell||[])[+p.cm-1];V&&"XLDAPR"==V.type&&(f.D=!0)}if(P){var W=Yo(p.r);c[W.r]||(c[W.r]=[]),c[W.r][W.c]=f}else c[p.r]=f}}}}M.length>0&&(c["!rows"]=M)}}();var lh=ms;function uh(e){return[ls(e),vs(e),"n"]}var hh=ms;var dh=["left","right","top","bottom","header","footer"];function fh(e,t,r,n,a,i){var o=i||{"!type":"chart"};if(!e)return i;var s=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])}));var a=Ri((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[r,a,t]}(e);u.s.r=u.s.c=0,u.e.c=s,l=Wo(s),t[0].forEach((function(e,r){o[l+Go(r)]={t:"n",v:e,z:t[1]},c=r})),u.e.r<c&&(u.e.r=c),++s})),s>0&&(o["!ref"]=Jo(u)),o}var ph=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],gh=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],mh=[],vh=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function yh(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(null==n[i[0]])n[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof n[i[0]]&&(n[i[0]]=Mi(n[i[0]]));break;case"int":"string"==typeof n[i[0]]&&(n[i[0]]=parseInt(n[i[0]],10))}}}function bh(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=Mi(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function Th(e){bh(e.WBProps,ph),bh(e.CalcPr,vh),yh(e.WBView,gh),yh(e.Sheets,mh),Vu.date1904=Mi(e.WBProps.date1904)}var wh="][*?/\\".split("");function _h(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return wh.forEach((function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}})),r}var Eh=/<\w+:workbook/;function Ch(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function kh(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],ed[16]={n:"BrtFRTArchID$",f:Ch},Uo(e,(function(e,s,c){switch(c){case 156:o.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=Nu(e.Ptg,0,null,o,t),delete t.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:o[0].length?o.push([c,e]):o[0]=[c,e],o[o.length-1].XTI=[];break;case 362:0===o.length&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(e),o.XTI=o.XTI.concat(e);break;case 35:case 37:n.push(c),a=!0;break;case 36:case 38:n.pop(),a=!1;break;default:if(s.T);else if(!a||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+c.toString(16))}}),t),Th(r),r.Names=i,r.supbooks=o,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(e.replace(_i,(function(s,c){var l=ki(s);switch(Si(l[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":s.match(Eh)&&(a="xmlns"+s.match(/<(\w+):/)[1]),r.xmlns=l[a];break;case"<fileVersion":delete l[0],r.AppVersion=l;break;case"<workbookPr":case"<workbookPr/>":ph.forEach((function(e){if(null!=l[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=Mi(l[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(l[e[0]],10);break;default:r.WBProps[e[0]]=l[e[0]]}})),l.codeName&&(r.WBProps.CodeName=Hi(l.codeName));break;case"<workbookView":case"<workbookView/>":delete l[0],r.WBView.push(l);break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=Ri(Hi(l.name)),delete l[0],r.Sheets.push(l);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(i={}).Name=Hi(l.name),l.comment&&(i.Comment=l.comment),l.localSheetId&&(i.Sheet=+l.localSheetId),Mi(l.hidden||"0")&&(i.Hidden=!0),o=c+s.length;break;case"</definedName>":i.Ref=Ri(Hi(e.slice(o,c))),r.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete l[0],r.CalcPr=l;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return s})),-1===Zi.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return Th(r),r}(e,r)}function Sh(e,t,r,n,a,i,o,s){return".bin"===t.slice(-4)?function(e,t,r,n,a,i,o){if(!e)return e;var s=t||{};n||(n={"!id":{}}),null!=Pn&&null==s.dense&&(s.dense=Pn);var c,l,u,h,d,f,p,g,m,v,y=s.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=[],w=!1,_=!1,E=[];s.biff=12,s["!row"]=0;var C=0,k=!1,S=[],A={},I=s.supbooks||a.supbooks||[[]];if(I.sharedf=A,I.arrayf=S,I.SheetNames=a.SheetNames||a.Sheets.map((function(e){return e.name})),!s.supbooks&&(s.supbooks=I,a.Names))for(var R=0;R<a.Names.length;++R)I[0][R+1]=a.Names[R];var O,N,x=[],P=[],M=!1;if(ed[16]={n:"BrtShortReal",f:uh},Uo(e,(function(e,t,R){if(!_)switch(R){case 148:c=e;break;case 0:l=e,s.sheetRows&&s.sheetRows<=l.r&&(_=!0),m=Go(d=l.r),s["!row"]=l.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=xl(e.hpt)),P[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":g=Gu[e[1]],u.v=g.t,u.r=g.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==s.cellText&&(u.w=Ns[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((h=o.CellXf[e[0].iStyleRef])&&Yu(u,h.numFmtId,null,s,i,o),f=-1==e[0].c?f+1:e[0].c,s.dense?(y[d]||(y[d]=[]),y[d][f]=u):y[Wo(f)+m]=u,s.cellFormula){for(k=!1,C=0;C<S.length;++C){var L=S[C];l.r>=L[0].s.r&&l.r<=L[0].e.r&&f>=L[0].s.c&&f<=L[0].e.c&&(u.F=Jo(L[0]),k=!0)}!k&&e.length>3&&(u.f=e[3])}if(b.s.r>l.r&&(b.s.r=l.r),b.s.c>f&&(b.s.c=f),b.e.r<l.r&&(b.e.r=l.r),b.e.c<f&&(b.e.c=f),s.cellDates&&h&&"n"==u.t&&Oa(ra[h.numFmtId])){var D=oa(u.v);D&&(u.t="d",u.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}O&&("XLDAPR"==O.type&&(u.D=!0),O=void 0),N&&(N=void 0);break;case 1:case 12:if(!s.sheetStubs||w)break;u={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,s.dense?(y[d]||(y[d]=[]),y[d][f]=u):y[Wo(f)+m]=u,b.s.r>l.r&&(b.s.r=l.r),b.s.c>f&&(b.s.c=f),b.e.r<l.r&&(b.e.r=l.r),b.e.c<f&&(b.e.c=f),O&&("XLDAPR"==O.type&&(u.D=!0),O=void 0),N&&(N=void 0);break;case 176:E.push(e);break;case 49:O=((s.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=n["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),d=e.rfx.s.r;d<=e.rfx.e.r;++d)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)s.dense?(y[d]||(y[d]=[]),y[d][f]||(y[d][f]={t:"z",v:void 0}),y[d][f].l=e):(p=$o({c:f,r:d}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=e);break;case 426:if(!s.cellFormula)break;S.push(e),(v=s.dense?y[d][f]:y[Wo(f)+m]).f=Nu(e[1],0,{r:l.r,c:f},I,s),v.F=Jo(e[0]);break;case 427:if(!s.cellFormula)break;A[$o(e[0].s)]=e[1],(v=s.dense?y[d][f]:y[Wo(f)+m]).f=Nu(e[1],0,{r:l.r,c:f},I,s);break;case 60:if(!s.cellStyles)break;for(;e.e>=e.s;)x[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},M||(M=!0,Il(e.w/256)),Rl(x[e.e+1]);break;case 161:y["!autofilter"]={ref:Jo(e)};break;case 476:y["!margins"]=e;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:T.push(R),w=!0;break;case 38:T.pop(),w=!1;break;default:if(t.T);else if(!w||s.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}),s),delete s.supbooks,delete s["!row"],!y["!ref"]&&(b.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(y["!ref"]=Jo(c||b)),s.sheetRows&&y["!ref"]){var L=Xo(y["!ref"]);s.sheetRows<=+L.e.r&&(L.e.r=s.sheetRows-1,L.e.r>b.e.r&&(L.e.r=b.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>b.e.c&&(L.e.c=b.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),y["!fullref"]=y["!ref"],y["!ref"]=Jo(L))}return E.length>0&&(y["!merges"]=E),x.length>0&&(y["!cols"]=x),P.length>0&&(y["!rows"]=P),y}(e,n,r,a,i,o,s):ih(e,n,r,a,i,o,s)}function Ah(e,t,r,n,a,i,o,s){return".bin"===t.slice(-4)?function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=[],s=!1;return Uo(e,(function(e,n,c){switch(c){case 550:i["!rel"]=e;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(c);break;case 38:o.pop();break;default:if(n.T>0)o.push(c);else if(n.T<0)o.pop();else if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}(e,n,r,a,i):function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i,o={"!type":"chart","!drawel":null,"!rel":""},s=e.match(rh);return s&&oh(s[0],0,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=i[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}(e,0,r,a,i)}function Ih(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var a in ra)n.NumberFmt[a]=ra[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Uo(e,(function(e,a,s){switch(s){case 44:n.NumberFmt[e[0]]=e[1],La(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=bl(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&n.CellXf.push(e);break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(s),o=!0;break;case 38:i.pop(),o=!1;break;default:if(a.T>0)i.push(s);else if(a.T<0)i.pop();else if(!o||r.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+s.toString(16))}})),n}(e,r,n):Dl(e,r,n)}function Rh(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return Uo(e,(function(e,a,i){switch(i){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}})),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var a=e.match(tl);if(a){n=a[2].replace(rl,"").split(nl);for(var i=0;i!=n.length;++i){var o=el(n[i].trim(),t);null!=o&&(r[r.length]=o)}a=ki(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}(e,r)}function Oh(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],a={},i=!1;return Uo(e,(function(e,o,s){switch(s){case 632:n.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(o.T);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}}));var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var i=ki(a[0]),o={author:i.authorId&&r[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},s=Yo(i.ref);if(!(t.sheetRows&&t.sheetRows<=s.r)){var c=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),l=!!c&&!!c[1]&&el(c[1])||{r:"",t:"",h:""};o.r=l.r,"<t></t>"==l.r&&(l.t=l.h=""),o.t=(l.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(o.h=l.h),n.push(o)}}}})),n}(e,r)}function Nh(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n=[];return Uo(e,(function(e,t,r){if(63===r)n.push(e);else if(!t.T)throw new Error("Unexpected record 0x"+r.toString(16))})),n}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(_i)||[]).forEach((function(e){var n=ki(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}})),t}(e)}function xh(e,t,r,n){if(".bin"===r.slice(-4))return function(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Uo(e,(function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||a.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}}),a)}(e,0,0,n)}function Ph(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,s=2;return Uo(e,(function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==s?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==s&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})}));break;case 337:s=e?1:0;break;case 338:s=2;break;case 35:i.push(r),o=!0;break;case 36:i.pop(),o=!1;break;default:if(t.T);else if(!o||a.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}})),n}(e,0,r):function(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a,i=!1,o=2;return e.replace(_i,(function(e){var t=ki(e);switch(Si(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var s=0;s<n.Types.length;++s)n.Types[s].name==t.name&&(a=n.Types[s]);break;case"<rc":1==o?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==o&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":o=1;break;case"</cellMetadata>":case"</valueMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),n}(e,0,r)}var Mh,Lh=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Dh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Fh(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var a,i,o,s=e.match(Lh);if(s)for(o=0;o!=s.length;++o)-1===(i=(a=s[o].match(Dh))[1].indexOf(":"))?n[a[1]]=a[2].slice(1,a[2].length-1):n["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(i+1)]=a[2].slice(1,a[2].length-1);return n}function Uh(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,a,i=e.match(Lh);if(i)for(a=0;a!=i.length;++a)-1===(n=(r=i[a].match(Dh))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function Hh(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Mi(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=ei(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ri(t)]=a}function Bh(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Ns[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=da(e.v):e.w=fa(e.v):e.w=function(e,t){var r=Mh[e]||Ri(e);return"General"===r?fa(t):Ma(r,t)}(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Mh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&"n"==e.t&&Oa(n)){var a=oa(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function jh(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Pl[n.Pattern]||n.Pattern)}e[t.ID]=t}function zh(e,t,r,n,a,i,o,s,c,l){var u="General",h=n.StyleID,d={};l=l||{};var f=[],p=0;for(void 0===h&&s&&(h=s.StyleID),void 0===h&&o&&(h=o.StyleID);void 0!==i[h]&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&f.push(i[h].Interior),i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Mi(e);break;case"String":n.t="s",n.r=Pi(Ri(e)),n.v=e.indexOf("<")>-1?Ri(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(ei(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!==n.v?n.v=Ri(e):n.v<60&&(n.v=n.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=xs[e],!1!==l.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=Pi(t||e))}if(Bh(n,u,l),!1!==l.cellFormula)if(n.Formula){var g=Ri(n.Formula);61==g.charCodeAt(0)&&(g=g.slice(1)),n.f=eu(g,a),delete n.Formula,"RC"==n.ArrayRange?n.F=eu("RC:RC",a):n.ArrayRange&&(n.F=eu(n.ArrayRange,a),c.push([Xo(n.F),n.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(n.F=c[p][1]);l.cellStyles&&(f.forEach((function(e){!d.patternType&&e.patternType&&(d.patternType=e.patternType)})),n.s=d),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function qh(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Kh(e,t){var r=t||{};Da();var n=On(Qi(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n="undefined"!==typeof Rn?Rn.utils.decode(65001,An(n)):Hi(n));var a,i=n.slice(0,1024).toLowerCase(),o=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var s=ri(r);return s.type="string",Wc.to_workbook(n,s)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){i.indexOf("<"+e)>=0&&(o=!0)})),o)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return ts(nd(r[0],t),t);var n={SheetNames:[],Sheets:{}};return r.forEach((function(e,r){tf(n,nd(e,t),"Sheet"+(r+1))})),n}(n,r);Mh={"General Number":"General","General Date":ra[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ra[15],"Short Date":ra[14],"Long Time":ra[19],"Medium Time":ra[18],"Short Time":ra[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ra[2],Standard:ra[4],Percent:ra[10],Scientific:ra[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[];null!=Pn&&null==r.dense&&(r.dense=Pn);var u,h={},d=[],f=r.dense?[]:{},p="",g={},m={},v=Fh('<Data ss:Type="String">'),y=0,b=0,T=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},E={},C="",k=0,S=[],A={},I={},R=0,O=[],N=[],x={},P=[],M=!1,L=[],D=[],F={},U=0,H=0,B={Sheets:[],WBProps:{date1904:!1}},j={};Ji.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var z="";a=Ji.exec(n);)switch(a[3]=(z=a[3]).toLowerCase()){case"data":if("data"==z){if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;"/"===a[1]?zh(n.slice(y,a.index),C,v,"comment"==l[l.length-1][0]?x:g,{c:b,r:T},_,P[b],m,L,r):(C="",v=Fh(a[0]),y=a.index+a[0].length);break;case"cell":if("/"===a[1])if(N.length>0&&(g.c=N),(!r.sheetRows||r.sheetRows>T)&&void 0!==g.v&&(r.dense?(f[T]||(f[T]=[]),f[T][b]=g):f[Wo(b)+Go(T)]=g),g.HRef&&(g.l={Target:Ri(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(U=b+(0|parseInt(g.MergeAcross,10)),H=T+(0|parseInt(g.MergeDown,10)),S.push({s:{c:b,r:T},e:{c:U,r:H}})),r.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var q=b;q<=U;++q)for(var K=T;K<=H;++K)(q>b||K>T)&&(r.dense?(f[K]||(f[K]=[]),f[K][q]={t:"z"}):f[Wo(q)+Go(K)]={t:"z"});b=U+1}else++b;else g.MergeAcross?b=U+1:++b;else(g=Uh(a[0])).Index&&(b=+g.Index-1),b<w.s.c&&(w.s.c=b),b>w.e.c&&(w.e.c=b),"/>"===a[0].slice(-2)&&++b,N=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(T<w.s.r&&(w.s.r=T),T>w.e.r&&(w.e.r=T),"/>"===a[0].slice(-2)&&(m=Fh(a[0])).Index&&(T=+m.Index-1),b=0,++T):((m=Fh(a[0])).Index&&(T=+m.Index-1),F={},("0"==m.AutoFitHeight||m.Height)&&(F.hpx=parseInt(m.Height,10),F.hpt=Nl(F.hpx),D[T]=F),"1"==m.Hidden&&(F.hidden=!0,D[T]=F));break;case"worksheet":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));d.push(p),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=Jo(w),r.sheetRows&&r.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=r.sheetRows-1,f["!ref"]=Jo(w))),S.length&&(f["!merges"]=S),P.length>0&&(f["!cols"]=P),D.length>0&&(f["!rows"]=D),h[p]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=b=0,l.push([a[3],!1]),c=Fh(a[0]),p=Ri(c.Name),f=r.dense?[]:{},S=[],L=[],D=[],j={name:p,Hidden:0},B.Sheets.push(j);break;case"table":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if("/>"==a[0].slice(-2))break;l.push([a[3],!1]),P=[],M=!1}break;case"style":"/"===a[1]?jh(_,E,r):E=Fh(a[0]);break;case"numberformat":E.nf=Ri(Fh(a[0]).Format||"General"),Mh[E.nf]&&(E.nf=Mh[E.nf]);for(var G=0;392!=G&&ra[G]!=E.nf;++G);if(392==G)for(G=57;392!=G;++G)if(null==ra[G]){La(E.nf,G);break}break;case"column":if("table"!==l[l.length-1][0])break;if((u=Fh(a[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!M&&u.wpx>10){M=!0,El=Tl;for(var V=0;V<P.length;++V)P[V]&&Rl(P[V])}M&&Rl(u),P[u.Index-1||P.length]=u;for(var W=0;W<+u.Span;++W)P[P.length]=ri(u);break;case"namedrange":if("/"===a[1])break;B.Names||(B.Names=[]);var Y=ki(a[0]),$={Name:Y.Name,Ref:eu(Y.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&($.Sheet=B.Sheets.length-1),B.Names.push($);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?C+=n.slice(k,a.index):k=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=Fh(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?Vs(A,z,n.slice(R,a.index)):R=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));qh(x),N.push(x)}else l.push([a[3],!1]),x={a:(c=Fh(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var Q=Fh(a[0]);f["!autofilter"]={ref:eu(Q.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;default:if(0==l.length&&"document"==a[3])return md(n,r);if(0==l.length&&"uof"==a[3])return md(n,r);var J=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(a[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(n.slice(R,a.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2}else R=a.index+a[0].length;break;case"header":f["!margins"]||Wu(f["!margins"]={},"xlml"),isNaN(+ki(a[0]).Margin)||(f["!margins"].header=+ki(a[0]).Margin);break;case"footer":f["!margins"]||Wu(f["!margins"]={},"xlml"),isNaN(+ki(a[0]).Margin)||(f["!margins"].footer=+ki(a[0]).Margin);break;case"pagemargins":var X=ki(a[0]);f["!margins"]||Wu(f["!margins"]={},"xlml"),isNaN(+X.Top)||(f["!margins"].top=+X.Top),isNaN(+X.Left)||(f["!margins"].left=+X.Left),isNaN(+X.Right)||(f["!margins"].right=+X.Right),isNaN(+X.Bottom)||(f["!margins"].bottom=+X.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if("customdocumentproperties"===l[l.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?Hh(I,z,O,n.slice(R,a.index)):(O=a,R=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=h),Z.SheetNames=d,Z.Workbook=B,Z.SSF=ri(ra),Z.Props=A,Z.Custprops=I,Z}function Gh(e,t){switch(Fd(t=t||{}),t.type||"base64"){case"base64":return Kh(Dn(e),t);case"binary":case"buffer":case"file":return Kh(e,t);case"array":return Kh(zn(e),t)}}function Vh(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return ys(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return ys(e,2)}(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var Wh=[60,1084,2066,2165,2175];function Yh(e,t,r,n,a){var i=n,o=[],s=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(s)}o.push(s),r.l+=i;for(var c=Co(r,r.l),l=td[c],u=0;null!=l&&Wh.indexOf(c)>-1;)i=Co(r,r.l+2),u=r.l+4,2066==c?u+=4:2165!=c&&2175!=c||(u+=12),s=r.slice(u,r.l+4+i),o.push(s),r.l+=4+i,l=td[c=Co(r,r.l)];var h=Kn(o);Lo(h,0);var d=0;h.lens=[];for(var f=0;f<o.length;++f)h.lens.push(d),d+=o[f].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function $h(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ra[n])}catch(i){if(t.WTF)throw i}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Ns[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=da(e.v):e.w=fa(e.v):e.w=Ma(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&"n"==e.t&&Oa(ra[n]||String(n))){var a=oa(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Qh(e,t,r){return{v:e,ixfe:t,t:r}}function Jh(e,t){var r={opts:{}},n={};null!=Pn&&null==t.dense&&(t.dense=Pn);var a,i,o,s,c,l,u,h,d=t.dense?[]:{},f={},p={},g=null,m=[],v="",y={},b="",T={},w=[],_=[],E=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(e){return e<8?Os[e]:e<64&&E[e-8]||Os[e]},A=function(e,t,r){if(!(F>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,a=t.XF.data;a&&a.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=a.patternType,(n=yl(S(a.icvFore)))&&(t.s.fgColor={rgb:n}),(n=yl(S(a.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,r),delete t.ixfe,delete t.XF,a=e,b=$o(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<w.length;++n)if(!(w[n][0].s.c>e.c||w[n][0].s.r>e.r)&&!(w[n][0].e.c<e.c||w[n][0].e.r<e.r)){t.F=Jo(w[n][0]),w[n][0].s.c==e.c&&w[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+Nu(w[n][1],0,e,M,I));break}r.dense?(d[e.r]||(d[e.r]=[]),d[e.r][e.c]=t):d[b]=t}},I={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var R=[],O=[],N=[],x=[],P=!1,M=[];M.SheetNames=I.snames,M.sharedf=I.sharedf,M.arrayf=I.arrayf,M.names=[],M.XTI=[];var L,D=0,F=0,U=0,H=[],B=[];I.codepage=1200,kn(1200);for(var j=!1;e.l<e.length-1;){var z=e.l,q=e.read_shift(2);if(0===q&&10===D)break;var K=e.l===e.length?0:e.read_shift(2),G=td[q];if(G&&G.f){if(t.bookSheets&&133===D&&133!==q)break;if(D=q,2===G.r||12==G.r){var V=e.read_shift(2);if(K-=2,!I.enc&&V!==q&&((255&V)<<8|V>>8)!==q)throw new Error("rt mismatch: "+V+"!="+q);12==G.r&&(e.l+=10,K-=10)}var W={};if(W=10===q?G.f(e,K,I):Yh(q,G,e,K,I),0==F&&-1===[9,521,1033,2057].indexOf(D))continue;switch(q){case 34:r.opts.Date1904=C.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=W,!t.password)throw new Error("File is password-protected");if(null==W.valid)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=W;break;case 66:var Y=Number(W);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}kn(I.codepage=Y),j=!0;break;case 317:I.rrtabid=W;break;case 25:I.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:I.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(d["!type"]="dialog"),W.fBelow||((d["!outline"]||(d["!outline"]={})).above=!0),W.fRight||((d["!outline"]||(d["!outline"]={})).left=!0);break;case 224:_.push(W);break;case 430:M.push([W]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(W);break;case 24:case 536:L={Name:W.Name,Ref:Nu(W.rgce,0,null,M,I)},W.itab>0&&(L.Sheet=W.itab-1),M.names.push(L),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(W),"_xlnm._FilterDatabase"==W.Name&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&"PtgArea3d"==W.rgce[0][0][0]&&(B[W.itab-1]={ref:Jo(W.rgce[0][0][1][2])});break;case 22:I.ExternCount=W;break;case 23:0==M.length&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(W),M.XTI=M.XTI.concat(W);break;case 2196:if(I.biff<8)break;null!=L&&(L.Comment=W[1]);break;case 18:d["!protect"]=W;break;case 19:0!==W&&I.WTF&&console.error("Password verifier: "+W);break;case 133:f[W.pos]=W,I.snames.push(W.name);break;case 10:if(--F)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,d["!ref"]=Jo(p),t.sheetRows&&t.sheetRows<=p.e.r){var $=p.e.r;p.e.r=t.sheetRows-1,d["!fullref"]=d["!ref"],d["!ref"]=Jo(p),p.e.r=$}p.e.r++,p.e.c++}R.length>0&&(d["!merges"]=R),O.length>0&&(d["!objects"]=O),N.length>0&&(d["!cols"]=N),x.length>0&&(d["!rows"]=x),C.Sheets.push(k)}""===v?y=d:n[v]=d,d=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===I.biff&&(I.biff={9:2,521:3,1033:4}[q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),I.biffguess=0==W.BIFFVer,0==W.BIFFVer&&4096==W.dt&&(I.biff=5,j=!0,kn(I.codepage=28591)),8==I.biff&&0==W.BIFFVer&&16==W.dt&&(I.biff=2),F++)break;if(d=t.dense?[]:{},I.biff<8&&!j&&(j=!0,kn(I.codepage=t.codepage||1252)),I.biff<5||0==W.BIFFVer&&4096==W.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var Q={pos:e.l-K,name:v};f[Q.pos]=Q,I.snames.push(v)}else v=(f[z]||{name:""}).name;32==W.dt&&(d["!type"]="chart"),64==W.dt&&(d["!type"]="macro"),R=[],O=[],I.arrayf=w=[],N=[],x=[],P=!1,k={Hidden:(f[z]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==d["!type"]&&(t.dense?(d[W.r]||[])[W.c]:d[$o({c:W.c,r:W.r})])&&++W.c,l={ixfe:W.ixfe,XF:_[W.ixfe]||{},v:W.val,t:"n"},U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A({c:W.c,r:W.r},l,t);break;case 5:case 517:l={ixfe:W.ixfe,XF:_[W.ixfe],v:W.val,t:W.t},U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A({c:W.c,r:W.r},l,t);break;case 638:l={ixfe:W.ixfe,XF:_[W.ixfe],v:W.rknum,t:"n"},U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A({c:W.c,r:W.r},l,t);break;case 189:for(var J=W.c;J<=W.C;++J){var X=W.rkrec[J-W.c][0];l={ixfe:X,XF:_[X],v:W.rkrec[J-W.c][1],t:"n"},U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A({c:J,r:W.r},l,t)}break;case 6:case 518:case 1030:if("String"==W.val){g=W;break}if((l=Qh(W.val,W.cell.ixfe,W.tt)).XF=_[l.ixfe],t.cellFormula){var Z=W.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],re=$o({r:ee,c:te});T[re]?l.f=""+Nu(W.formula,0,W.cell,M,I):l.F=((t.dense?(d[ee]||[])[te]:d[re])||{}).F}else l.f=""+Nu(W.formula,0,W.cell,M,I)}U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A(W.cell,l,t),g=W;break;case 7:case 519:if(!g)throw new Error("String record expects Formula");g.val=W,(l=Qh(W,g.cell.ixfe,"s")).XF=_[l.ixfe],t.cellFormula&&(l.f=""+Nu(g.formula,0,g.cell,M,I)),U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A(g.cell,l,t),g=null;break;case 33:case 545:w.push(W);var ne=$o(W[0].s);if(i=t.dense?(d[W[0].s.r]||[])[W[0].s.c]:d[ne],t.cellFormula&&i){if(!g)break;if(!ne||!i)break;i.f=""+Nu(W[1],0,W[0],M,I),i.F=Jo(W[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!g)break;T[$o(g.cell)]=W[0],((i=t.dense?(d[g.cell.r]||[])[g.cell.c]:d[$o(g.cell)])||{}).f=""+Nu(W[0],0,a,M,I)}break;case 253:l=Qh(m[W.isst].t,W.ixfe,"s"),m[W.isst].h&&(l.h=m[W.isst].h),l.XF=_[l.ixfe],U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A({c:W.c,r:W.r},l,t);break;case 513:t.sheetStubs&&(l={ixfe:W.ixfe,XF:_[W.ixfe],t:"z"},U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A({c:W.c,r:W.r},l,t));break;case 190:if(t.sheetStubs)for(var ae=W.c;ae<=W.C;++ae){var ie=W.ixfe[ae-W.c];l={ixfe:ie,XF:_[ie],t:"z"},U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A({c:ae,r:W.r},l,t)}break;case 214:case 516:case 4:(l=Qh(W.val,W.ixfe,"s")).XF=_[l.ixfe],U>0&&(l.z=H[l.ixfe>>8&63]),$h(l,t,r.opts.Date1904),A({c:W.c,r:W.r},l,t);break;case 0:case 512:1===F&&(p=W);break;case 252:m=W;break;case 1054:if(4==I.biff){H[U++]=W[1];for(var oe=0;oe<U+163&&ra[oe]!=W[1];++oe);oe>=163&&La(W[1],U+163)}else La(W[1],W[0]);break;case 30:H[U++]=W;for(var se=0;se<U+163&&ra[se]!=W;++se);se>=163&&La(W,U+163);break;case 229:R=R.concat(W);break;case 93:O[W.cmo[0]]=I.lastobj=W;break;case 438:I.lastobj.TxO=W;break;case 127:I.lastobj.ImData=W;break;case 440:for(c=W[0].s.r;c<=W[0].e.r;++c)for(s=W[0].s.c;s<=W[0].e.c;++s)(i=t.dense?(d[c]||[])[s]:d[$o({c:s,r:c})])&&(i.l=W[1]);break;case 2048:for(c=W[0].s.r;c<=W[0].e.r;++c)for(s=W[0].s.c;s<=W[0].e.c;++s)(i=t.dense?(d[c]||[])[s]:d[$o({c:s,r:c})])&&i.l&&(i.l.Tooltip=W[1]);break;case 28:if(I.biff<=5&&I.biff>=2)break;i=t.dense?(d[W[0].r]||[])[W[0].c]:d[$o(W[0])];var ce=O[W[2]];i||(t.dense?(d[W[0].r]||(d[W[0].r]=[]),i=d[W[0].r][W[0].c]={t:"z"}):i=d[$o(W[0])]={t:"z"},p.e.r=Math.max(p.e.r,W[0].r),p.s.r=Math.min(p.s.r,W[0].r),p.e.c=Math.max(p.e.c,W[0].c),p.s.c=Math.min(p.s.c,W[0].c)),i.c||(i.c=[]),o={a:W[1],t:ce.TxO.t},i.c.push(o);break;case 2173:_[W.ixfe],W.ext.forEach((function(e){e[0]}));break;case 125:if(!I.cellStyles)break;for(;W.e>=W.s;)N[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(1&W.flags)},P||(P=!0,Il(W.w/256)),Rl(N[W.e+1]);break;case 520:var le={};null!=W.level&&(x[W.r]=le,le.level=W.level),W.hidden&&(x[W.r]=le,le.hidden=!0),W.hpt&&(x[W.r]=le,le.hpt=W.hpt,le.hpx=xl(W.hpt));break;case 38:case 39:case 40:case 41:d["!margins"]||Wu(d["!margins"]={}),d["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[q]]=W;break;case 161:d["!margins"]||Wu(d["!margins"]={}),d["!margins"].header=W.header,d["!margins"].footer=W.footer;break;case 574:W.RTL&&(C.Views[0].RTL=!0);break;case 146:E=W;break;case 2198:h=W;break;case 140:u=W;break;case 442:v?k.CodeName=W||k.name:C.WBProps.CodeName=W||"ThisWorkbook"}}else G||console.error("Missing Info for XLS Record 0x"+q.toString(16)),e.l+=K}return r.SheetNames=za(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&y["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=y)):r.Preamble=y,r.Sheets&&B.forEach((function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e})),r.Strings=m,r.SSF=ri(ra),I.enc&&(r.Encryption=I.enc),h&&(r.Themes=h),r.Metadata={},void 0!==u&&(r.Metadata.Country=u),M.names.length>0&&(C.Names=M.names),r.Workbook=C,r}var Xh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Zh(e,t){var r,n,a,i;if(t||(t={}),Fd(t),Sn(),t.codepage&&Cn(t.codepage),e.FullPaths){if(Ba.find(e,"/encryption"))throw new Error("File is password-protected");r=Ba.find(e,"!CompObj"),n=Ba.find(e,"/Workbook")||Ba.find(e,"/Book")}else{switch(t.type){case"base64":e=jn(Dn(e));break;case"binary":e=jn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Lo(e,0),n={content:e}}if(r&&Vh(r),t.bookProps&&!t.bookSheets)a={};else{var o=Fn?"buffer":"array";if(n&&n.content)a=Jh(n.content,t);else if((i=Ba.find(e,"PerfectOffice_MAIN"))&&i.content)a=Yc.to_workbook(i.content,(t.type=o,t));else{if(!(i=Ba.find(e,"NativeContent_MAIN"))||!i.content)throw(i=Ba.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=Yc.to_workbook(i.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&Ba.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=Ba.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ba.utils.cfb_add(t,a,e.FileIndex[n].content)}})),Ba.write(t)}(e))}var s={};return e.FullPaths&&function(e,t,r){var n=Ba.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=nc(n,ks,Xh.DSI);for(var i in a)t[i]=a[i]}catch(l){if(r.WTF)throw l}var o=Ba.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var s=nc(o,Ss,Xh.SI);for(var c in s)null==t[c]&&(t[c]=s[c])}catch(l){if(r.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(zs(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,s,t),a.Props=a.Custprops=s,t.bookFiles&&(a.cfb=e),a}var ed={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,7&i&&(r.level=7&i),16&i&&(r.hidden=!0),32&i&&(r.hpt=a/20),r}},1:{f:function(e){return[cs(e)]}},2:{f:function(e){return[cs(e),ps(e),"n"]}},3:{f:function(e){return[cs(e),e.read_shift(1),"e"]}},4:{f:function(e){return[cs(e),e.read_shift(1),"b"]}},5:{f:function(e){return[cs(e),vs(e),"n"]}},6:{f:function(e){return[cs(e),as(e),"str"]}},7:{f:function(e){return[cs(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,a=cs(e);a.r=r["!row"];var i=[a,as(e),"str"];if(r.cellFormula){e.l+=2;var o=Fu(e,n-e.l,r);i[3]=Nu(o,0,a,r.supbooks,r)}else e.l=n;return i}},9:{f:function(e,t,r){var n=e.l+t,a=cs(e);a.r=r["!row"];var i=[a,vs(e),"n"];if(r.cellFormula){e.l+=2;var o=Fu(e,n-e.l,r);i[3]=Nu(o,0,a,r.supbooks,r)}else e.l=n;return i}},10:{f:function(e,t,r){var n=e.l+t,a=cs(e);a.r=r["!row"];var i=[a,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var o=Fu(e,n-e.l,r);i[3]=Nu(o,0,a,r.supbooks,r)}else e.l=n;return i}},11:{f:function(e,t,r){var n=e.l+t,a=cs(e);a.r=r["!row"];var i=[a,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var o=Fu(e,n-e.l,r);i[3]=Nu(o,0,a,r.supbooks,r)}else e.l=n;return i}},12:{f:function(e){return[ls(e)]}},13:{f:function(e){return[ls(e),ps(e),"n"]}},14:{f:function(e){return[ls(e),e.read_shift(1),"e"]}},15:{f:function(e){return[ls(e),e.read_shift(1),"b"]}},16:{f:uh},17:{f:function(e){return[ls(e),as(e),"str"]}},18:{f:function(e){return[ls(e),e.read_shift(4),"s"]}},19:{f:os},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=ds(e),o=Uu(e,0,r),s=hs(e);e.l=n;var c={Name:i,Ptg:o};return a<268435455&&(c.Sheet=a),s&&(c.Comment=s),c}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var s=e.read_shift(1);switch(s>0&&(n.charset=s),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var c=Os[n];c&&(t.rgb=yl(c));break;case 2:t.rgb=yl([i,o,s]);break;case 3:t.theme=n}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=as(e),n}},44:{f:function(e,t){return[e.read_shift(2),as(e)]}},45:{f:Fl},46:{f:Ul},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Uc},62:{f:function(e){return[cs(e),os(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=$o(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Do,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=us(e,t-19),r}},148:{f:lh,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?as(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=fs(e,t-8),r.name=as(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:ms},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:hh},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:as(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:fs},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Lc},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,a=gs(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var s=Du(e,n-e.l,r);o[1]=s}else e.l=n;return o}},427:{f:function(e,t,r){var n=e.l+t,a=[ms(e,16)];if(r.cellFormula){var i=Hu(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return dh.forEach((function(r){t[r]=vs(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=ms(e,16),a=hs(e),i=as(e),o=as(e),s=as(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:s};return o&&(c.Tooltip=o),c}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:fs},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Xl},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=ms(e,16);return t.rfx=r.s,t.ref=$o(r.s),e.l+=16,t}},636:{T:-1},637:{f:ss},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:as(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},td={6:{f:Mu},10:{f:ac},12:{f:oc},13:{f:oc},14:{f:ic},15:{f:ic},16:{f:vs},17:{f:ic},18:{f:ic},19:{f:oc},20:{f:Nc},21:{f:Nc},23:{f:Lc},24:{f:Mc},25:{f:ic},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),s=dc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},s,o,i]}}(e,0,r)}},29:{},34:{f:ic},35:{f:xc},38:{f:vs},39:{f:vs},40:{f:vs},41:{f:vs},42:{f:ic},43:{f:ic},47:{f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?ml(e,t-2,n):function(e,t,r,n){var a={key:oc(e),verificationBytes:oc(e)};r.password&&(a.verifier=fl(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=gl(r.password))}(e,r.biff,r,n),n}},49:{f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=cc(e,0,r),n}},51:{f:oc},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:ic},65:{f:function(){}},66:{f:oc},77:{},80:{},81:{},82:{},85:{f:oc},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=dc(e,0,r);return e.read_shift(t+n-e.l),a}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Fc[n]||Do)(e,t,r)),{cmo:[a,n,i],ft:o}}(e,t,r);var n=Ec(e),a=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(kc[a](e,r-e.l))}catch(i){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:a}}},94:{},95:{f:ic},96:{},97:{},99:{f:ic},125:{f:Uc},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:oc},131:{f:ic},132:{f:ic},133:{f:function(e,t,r){var n=e.read_shift(4),a=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var o=cc(e,0,r);return 0===o.length&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=As[t]||t,t=e.read_shift(2),r[1]=As[t]||t,r}},141:{f:oc},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(mc(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:oc},157:{},158:{},160:{f:Bc},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=vs(e),r.footer=vs(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(bc(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}},190:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}},193:{f:ac},197:{},198:{},199:{},200:{},201:{},202:{f:ic},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:oc},220:{},221:{f:ic},222:{},224:{f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,6,n.data=function(e,t,r,n){var a={},i=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(4),c=e.read_shift(2);return a.patternType=Is[s>>26],n.cellStyles?(a.alc=7&i,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=15&o,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=127&s,a.icvBottom=s>>7&127,a.icvDiag=s>>14&127,a.dgDiag=s>>21&15,a.icvFore=127&c,a.icvBack=c>>7&127,a.fsxButton=c>>14&1,a):a}(e,0,n.fStyle,r),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:ac},227:{},229:{f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Tc(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],o=0;o!=a&&e.l<r;++o)i.push(lc(e));return i.Count=n,i.Unique=a,i}},253:{f:function(e){var t=vc(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sc},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ic},353:{f:ac},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,1025==i||14849==i)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=uc(e,i),s=[];n>e.l;)s.push(hc(e));return[i,a,o,s]}},431:{f:ic},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var o=e.read_shift(2);e.read_shift(2),oc(e);var s=e.read_shift(2);e.l+=s;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var l=e[e.l];if((a+=uc(e,e.lens[c+1]-e.lens[c]-1)).length>=(l?o:2*o))break}if(a.length!==o&&a.length!==2*o)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch(u){return e.l=n+t,{t:a}}}},439:{f:ic},440:{f:function(e,t){var r=Tc(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,o,s,c,l,u,h="";16&a&&(i=pc(e,e.l)),128&a&&(o=pc(e,e.l)),257===(257&a)&&(s=pc(e,e.l)),1===(257&a)&&(c=fc(e,e.l)),8&a&&(h=pc(e,e.l)),32&a&&(l=e.read_shift(16)),64&a&&(u=Ws(e)),e.l=r;var d=o||s||c||"";d&&h&&(d+="#"+h),d||(d="#"+h),2&a&&"/"==d.charAt(0)&&"/"!=d.charAt(1)&&(d="file://"+d);var f={Target:d};return l&&(f.guid=l),u&&(f.time=u),i&&(f.Tooltip=i),f}(e,t-24);return[r,n]}},441:{},442:{f:hc},443:{},444:{f:oc},445:{},446:{},448:{f:ac},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:ac},512:{f:Rc},513:{f:Hc},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=vc(e),a=vs(e);return n.val=a,n}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=vc(e);2==r.biff&&e.l++;var a=hc(e,e.l,r);return n.val=a,n}},517:{f:Oc},519:{f:jc},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:Dc},549:{f:Ac},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=bc(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),dc(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=wc(e);e.l++;var a=e.read_shift(1);return[Pu(e,t-=8,r),a,n]}},2048:{f:function(e,t){e.read_shift(2);var r=Tc(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(Gn,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Sc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ac},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Ql(e,e.l));return{ixfe:r,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ic,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2);return[uc(e,n,r),uc(e,a,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var a,i=e.slice(e.l);e.l=n;try{a=vi(i,{type:"array"})}catch(s){return}var o=fi(a,"theme/theme/theme1.xml",!0);if(o)return Wl(o,r)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:ac},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:oc},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,16&a&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(mc(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Rc},1:{},2:{f:function(e){var t=vc(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=vc(e);++e.l;var r=vs(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=vc(e);++e.l;var a=dc(e,0,r);return n.t="str",n.val=a,n}},5:{f:Oc},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:Sc},11:{},22:{f:oc},30:{f:Ic},31:{},32:{},33:{f:Dc},36:{},37:{f:Ac},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:oc},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var n=e.l+t,a=vc(e),i=e.read_shift(2),o=uc(e,i,r);return e.l=n,a.t="str",a.val=o,a}},223:{},234:{},354:{},421:{},518:{f:Mu},521:{f:Sc},536:{f:Mc},547:{f:xc},561:{},579:{},1030:{f:Mu},1033:{f:Sc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function rd(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&wo(r)&&e.push(r)}}function nd(e,t){var r=t||{};null!=Pn&&null==r.dense&&(r.dense=Pn);var n=r.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=a.index,s=i&&i.index||e.length,c=si(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,h=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<c.length;++o){var g=c[o].trim(),m=g.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=g.split(/<\/t[dh]>/i);for(s=0;s<v.length;++s){var y=v[s].trim();if(y.match(/<t[dh]/i)){for(var b=y,T=0;"<"==b.charAt(0)&&(T=b.indexOf(">"))>-1;)b=b.slice(T+1);for(var w=0;w<p.length;++w){var _=p[w];_.s.c==u&&_.s.r<l&&l<=_.e.r&&(u=_.e.c+1,w=-1)}var E=ki(y.slice(0,y.indexOf(">")));d=E.colspan?+E.colspan:1,((h=+E.rowspan)>1||d>1)&&p.push({s:{r:l,c:u},e:{r:l+(h||1)-1,c:u+d-1}});var C=E.t||E["data-t"]||"";if(b.length)if(b=zi(b),f.s.r>l&&(f.s.r=l),f.e.r<l&&(f.e.r=l),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),b.length){var k={t:"s",v:b};r.raw||!b.trim().length||"s"==C||("TRUE"===b?k={t:"b",v:!0}:"FALSE"===b?k={t:"b",v:!1}:isNaN(ai(b))?isNaN(oi(b).getDate())||(k={t:"d",v:ei(b)},r.cellDates||(k={t:"n",v:Ga(k.v)}),k.z=r.dateNF||ra[14]):k={t:"n",v:ai(b)}),r.dense?(n[l]||(n[l]=[]),n[l][u]=k):n[$o({r:l,c:u})]=k,u+=d}else u+=d;else u+=d}}}}else{if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}u=0}}return n["!ref"]=Jo(f),p.length&&(n["!merges"]=p),n}function ad(e,t,r,n){for(var a=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,c=0,l=0;l<a.length;++l)if(!(a[l].s.r>r||a[l].s.c>o)&&!(a[l].e.r<r||a[l].e.c<o)){if(a[l].s.r<r||a[l].s.c<o){s=-1;break}s=a[l].e.r-a[l].s.r+1,c=a[l].e.c-a[l].s.c+1;break}if(!(s<0)){var u=$o({r:r,c:o}),h=n.dense?(e[r]||[])[o]:e[u],d=h&&null!=h.v&&(h.h||xi(h.w||(es(h),h.w)||""))||"",f={};s>1&&(f.rowspan=s),c>1&&(f.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",null!=h.v&&(f["data-v"]=h.v),null!=h.z&&(f["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(n.id||"sjs")+"-"+u,i.push($i("td",d,f))}}return"<tr>"+i.join("")+"</tr>"}var id='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',od="</body></html>";function sd(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function cd(e,t){var r=t||{},n=null!=r.header?r.header:id,a=null!=r.footer?r.footer:od,i=[n],o=Qo(e["!ref"]);r.dense=Array.isArray(e),i.push(sd(0,0,r));for(var s=o.s.r;s<=o.e.r;++s)i.push(ad(e,o,s,r));return i.push("</table>"+a),i.join("")}function ld(e,t,r){var n=r||{};null!=Pn&&(n.dense=Pn);var a=0,i=0;if(null!=n.origin)if("number"==typeof n.origin)a=n.origin;else{var o="string"==typeof n.origin?Yo(n.origin):n.origin;a=o.r,i=o.c}var s=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,s.length),l={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Qo(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),-1==a&&(l.e.r=a=u.e.r+1)}var h=[],d=0,f=e["!rows"]||(e["!rows"]=[]),p=0,g=0,m=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<s.length&&g<c;++p){var T=s[p];if(hd(T)){if(n.display)continue;f[g]={hidden:!0}}var w=T.children;for(m=v=0;m<w.length;++m){var _=w[m];if(!n.display||!hd(_)){var E=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):zi(_.innerHTML),C=_.getAttribute("data-z")||_.getAttribute("z");for(d=0;d<h.length;++d){var k=h[d];k.s.c==v+i&&k.s.r<g+a&&g+a<=k.e.r&&(v=k.e.c+1-i,d=-1)}b=+_.getAttribute("colspan")||1,((y=+_.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:g+a,c:v+i},e:{r:g+a+(y||1)-1,c:v+i+(b||1)-1}});var S={t:"s",v:E},A=_.getAttribute("data-t")||_.getAttribute("t")||"";null!=E&&(0==E.length?S.t=A||"z":n.raw||0==E.trim().length||"s"==A||("TRUE"===E?S={t:"b",v:!0}:"FALSE"===E?S={t:"b",v:!1}:isNaN(ai(E))?isNaN(oi(E).getDate())||(S={t:"d",v:ei(E)},n.cellDates||(S={t:"n",v:Ga(S.v)}),S.z=n.dateNF||ra[14]):S={t:"n",v:ai(E)})),void 0===S.z&&null!=C&&(S.z=C);var I="",R=_.getElementsByTagName("A");if(R&&R.length)for(var O=0;O<R.length&&(!R[O].hasAttribute("href")||"#"==(I=R[O].getAttribute("href")).charAt(0));++O);I&&"#"!=I.charAt(0)&&(S.l={Target:I}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=S):e[$o({c:v+i,r:g+a})]=S,l.e.c<v+i&&(l.e.c=v+i),v+=b}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,g-1+a),e["!ref"]=Jo(l),g>=c&&(e["!fullref"]=Jo((l.e.r=s.length-p+g-1+a,l))),e}function ud(e,t){return ld((t||{}).dense?[]:{},e,t)}function hd(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function dd(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Ri(t.replace(/<[^>]*>/g,""))]}var fd={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function pd(e,t){var r=t||{};null!=Pn&&null==r.dense&&(r.dense=Pn);var n,a,i,o,s,c,l=Qi(e),u=[],h={name:""},d="",f=0,p={},g=[],m=r.dense?[]:{},v={value:""},y="",b=0,T=[],w=-1,_=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,k={},S=[],A={},I=[],R=1,O=1,N=[],x={Names:[]},P={},M=["",""],L=[],D={},F="",U=0,H=!1,B=!1,j=0;for(Ji.lastIndex=0,l=l.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");s=Ji.exec(l);)switch(s[3]=s[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===s[1]?(E.e.c>=E.s.c&&E.e.r>=E.s.r?m["!ref"]=Jo(E):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(m["!fullref"]=m["!ref"],E.e.r=r.sheetRows-1,m["!ref"]=Jo(E)),S.length&&(m["!merges"]=S),I.length&&(m["!rows"]=I),i.name=i["\u540d\u79f0"]||i.name,"undefined"!==typeof JSON&&JSON.stringify(i),g.push(i.name),p[i.name]=m,B=!1):"/"!==s[0].charAt(s[0].length-2)&&(i=ki(s[0],!1),w=_=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,m=r.dense?[]:{},S=[],I=[],B=!0);break;case"table-row-group":"/"===s[1]?--C:++C;break;case"table-row":case"\u884c":if("/"===s[1]){w+=R,R=1;break}if((o=ki(s[0],!1))["\u884c\u53f7"]?w=o["\u884c\u53f7"]-1:-1==w&&(w=0),(R=+o["number-rows-repeated"]||1)<10)for(j=0;j<R;++j)C>0&&(I[w+j]={level:C});_=-1;break;case"covered-table-cell":"/"!==s[1]&&++_,r.sheetStubs&&(r.dense?(m[w]||(m[w]=[]),m[w][_]={t:"z"}):m[$o({r:w,c:_})]={t:"z"}),y="",T=[];break;case"table-cell":case"\u6570\u636e":if("/"===s[0].charAt(s[0].length-2))++_,v=ki(s[0],!1),O=parseInt(v["number-columns-repeated"]||"1",10),c={t:"z",v:null},v.formula&&0!=r.cellFormula&&(c.f=qu(Ri(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(c.t="s",c.v=Ri(v["string-value"]||""),r.dense?(m[w]||(m[w]=[]),m[w][_]=c):m[$o({r:w,c:_})]=c),_+=O-1;else if("/"!==s[1]){y="",b=0,T=[],O=1;var z=R?w+R-1:w;if(++_>E.e.c&&(E.e.c=_),_<E.s.c&&(E.s.c=_),w<E.s.r&&(E.s.r=w),z>E.e.r&&(E.e.r=z),L=[],D={},c={t:(v=ki(s[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ri(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(A={s:{r:w,c:_},e:{r:w+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:_+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},c.F=Jo(A),N.push([A,c.F])),v.formula)c.f=qu(v.formula);else for(j=0;j<N.length;++j)w>=N[j][0].s.r&&w<=N[j][0].e.r&&_>=N[j][0].s.c&&_<=N[j][0].e.c&&(c.F=N[j][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(A={s:{r:w,c:_},e:{r:w+(parseInt(v["number-rows-spanned"],10)||0)-1,c:_+(parseInt(v["number-columns-spanned"],10)||0)-1}},S.push(A)),v["number-columns-repeated"]&&(O=parseInt(v["number-columns-repeated"],10)),c.t){case"boolean":c.t="b",c.v=Mi(v["boolean-value"]);break;case"float":case"percentage":case"currency":c.t="n",c.v=parseFloat(v.value);break;case"date":c.t="d",c.v=ei(v["date-value"]),r.cellDates||(c.t="n",c.v=Ga(c.v)),c.z="m/d/yy";break;case"time":c.t="n",c.v=Qa(v["time-value"])/86400,r.cellDates&&(c.t="d",c.v=$a(c.v)),c.z="HH:MM:SS";break;case"number":c.t="n",c.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==c.t&&"text"!==c.t&&c.t)throw new Error("Unsupported value type "+c.t);c.t="s",null!=v["string-value"]&&(y=Ri(v["string-value"]),T=[])}}else{if(H=!1,"s"===c.t&&(c.v=y||"",T.length&&(c.R=T),H=0==b),P.Target&&(c.l=P),L.length>0&&(c.c=L,L=[]),y&&!1!==r.cellText&&(c.w=y),H&&(c.t="z",delete c.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var q=0;q<R;++q){if(O=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[w+q]||(m[w+q]=[]),m[w+q][_]=0==q?c:ri(c);--O>0;)m[w+q][_+O]=ri(c);else for(m[$o({r:w+q,c:_})]=c;--O>0;)m[$o({r:w+q,c:_+O})]=ri(c);E.e.c<=_&&(E.e.c=_)}_+=(O=parseInt(v["number-columns-repeated"]||"1",10))-1,O=0,c={},y="",T=[]}P={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!0]);break;case"annotation":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n;D.t=y,T.length&&(D.R=T),D.a=F,L.push(D)}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!1]);F="",U=0,y="",b=0,T=[];break;case"creator":"/"===s[1]?F=l.slice(U,s.index):U=s.index+s[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!1]);y="",b=0,T=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===s[1]){if(k[h.name]=d,(n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&(d="",h=ki(s[0],!1),u.push([s[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":a=ki(s[0],!1),d+=fd[s[3]]["long"===a.style?1:0]}break;case"text":if("/>"===s[0].slice(-2))break;if("/"===s[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":d+=l.slice(f,s.index)}else f=s.index+s[0].length;break;case"named-range":M=Ku((a=ki(s[0],!1))["cell-range-address"]);var K={Name:a.name,Ref:M[0]+"!"+M[1]};B&&(K.Sheet=g.length),x.Names.push(K);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==s[1]||v&&v["string-value"])ki(s[0],!1),b=s.index+s[0].length;else{var G=dd(l.slice(b,s.index));y=(y.length>0?y+"\n":"")+G[0]}break;case"database-range":if("/"===s[1])break;try{p[(M=Ku(ki(s[0])["target-range-address"]))[0]]["!autofilter"]={ref:M[1]}}catch(W){}break;case"a":if("/"!==s[1]){if(!(P=ki(s[0],!1)).href)break;P.Target=Ri(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(M=Ku(P.Target.slice(1)),P.Target="#"+M[0]+"!"+M[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(s[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(s)}}var V={Sheets:p,SheetNames:g,Workbook:x};return r.bookSheets&&delete V.Sheets,V}function gd(e,t){t=t||{},ui(e,"META-INF/manifest.xml")&&function(e,t){for(var r,n,a=Qi(e);r=Ji.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=ki(r[0],!1)).path&&n.type!==Fs)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(di(e,"META-INF/manifest.xml"),t);var r=fi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=pd(Hi(r),t);return ui(e,"meta.xml")&&(n.Props=Bs(di(e,"meta.xml"))),n}function md(e,t){return pd(e,t)}function vd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yd(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Hi(zn(e))}function bd(e){var t=e.reduce((function(e,t){return e+t.length}),0),r=new Uint8Array(t),n=0;return e.forEach((function(e){r.set(e,n),n+=e.length})),r}function Td(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function wd(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function _d(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function Ed(e){for(var t=[],r=[0];r[0]<e.length;){var n,a=r[0],i=wd(e,r),o=7&i,s=0;if(0==(i=Math.floor(i/8)))break;switch(o){case 0:for(var c=r[0];e[r[0]++]>=128;);n=e.slice(c,r[0]);break;case 5:s=4,n=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,n=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=wd(e,r),n=e.slice(r[0],r[0]+s),r[0]+=s;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(a))}var l={data:n,type:o};null==t[i]?t[i]=[l]:t[i].push(l)}return t}function Cd(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function kd(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=wd(e,n),i=Ed(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:_d(i[1][0].data),messages:[]};i[2].forEach((function(t){var r=Ed(t.data),a=_d(r[3][0].data);o.messages.push({meta:r,data:e.slice(n[0],n[0]+a)}),n[0]+=a})),(null==(t=i[3])?void 0:t[0])&&(o.merge=_d(i[3][0].data)>>>0>0),r.push(o)}return r}function Sd(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=wd(t,r),a=[];r[0]<t.length;){var i=3&t[r[0]];if(0!=i){var o=0,s=0;if(1==i?(s=4+(t[r[0]]>>2&7),o=(224&t[r[0]++])<<3,o|=t[r[0]++]):(s=1+(t[r[0]++]>>2),2==i?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[bd(a)],0==o)throw new Error("Invalid offset 0");if(o>a[0].length)throw new Error("Invalid offset beyond length");if(s>=o)for(a.push(a[0].slice(-o)),s-=o;s>=a[a.length-1].length;)a.push(a[a.length-1]),s-=a[a.length-1].length;a.push(a[0].slice(-o,-o+s))}else{var c=t[r[0]++]>>2;if(c<60)++c;else{var l=c-59;c=t[r[0]],l>1&&(c|=t[r[0]+1]<<8),l>2&&(c|=t[r[0]+2]<<16),l>3&&(c|=t[r[0]+3]<<24),c>>>=0,c++,r[0]+=l}a.push(t.slice(r[0],r[0]+c)),r[0]+=c}}var u=bd(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Ad(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Sd(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return bd(t)}function Id(e,t,r){var n,a=vd(e),i=a.getUint32(8,!0),o=12,s=-1,c=-1,l=NaN,u=NaN,h=new Date(2001,0,1);switch(1&i&&(l=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],a=t+13;a>=t;--a)n=256*n+e[a];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,o),o+=16),2&i&&(u=a.getFloat64(o,!0),o+=8),4&i&&(h.setTime(h.getTime()+1e3*a.getFloat64(o,!0)),o+=8),8&i&&(c=a.getUint32(o,!0),o+=4),16&i&&(s=a.getUint32(o,!0),o+=4),e[1]){case 0:break;case 2:case 10:n={t:"n",v:l};break;case 3:n={t:"s",v:t[c]};break;case 5:n={t:"d",v:h};break;case 6:n={t:"b",v:u>0};break;case 7:n={t:"n",v:u/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(s>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));n={t:"s",v:r[s]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return n}function Rd(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,n){var a,i=vd(e),o=i.getUint32(4,!0),s=(n>1?12:8)+4*Td(o&(n>1?3470:398)),c=-1,l=-1,u=NaN,h=new Date(2001,0,1);switch(512&o&&(c=i.getUint32(s,!0),s+=4),s+=4*Td(o&(n>1?12288:4096)),16&o&&(l=i.getUint32(s,!0),s+=4),32&o&&(u=i.getFloat64(s,!0),s+=8),64&o&&(h.setTime(h.getTime()+1e3*i.getFloat64(s,!0)),s+=8),e[2]){case 0:break;case 2:a={t:"n",v:u};break;case 3:a={t:"s",v:t[l]};break;case 5:a={t:"d",v:h};break;case 6:a={t:"b",v:u>0};break;case 7:a={t:"n",v:u/86400};break;case 8:a={t:"e",v:0};break;case 9:if(c>-1)a={t:"s",v:r[c]};else if(l>-1)a={t:"s",v:t[l]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,r,e[0]);case 5:return Id(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Od(e){return wd(Ed(e)[1][0].data)}function Nd(e,t){var r=Ed(t.data),n=_d(r[1][0].data),a=r[3],i=[];return(a||[]).forEach((function(t){var r=Ed(t.data),a=_d(r[1][0].data)>>>0;switch(n){case 1:i[a]=yd(r[3][0].data);break;case 8:var o=Ed(e[Od(r[9][0].data)][0].data),s=e[Od(o[1][0].data)][0],c=_d(s.meta[1][0].data);if(2001!=c)throw new Error("2000 unexpected reference to ".concat(c));var l=Ed(s.data);i[a]=l[3].map((function(e){return yd(e.data)})).join("")}})),i}function xd(e,t){var r,n=Ed(t.data),a=(null==(r=null==n?void 0:n[7])?void 0:r[0])?_d(n[7][0].data)>>>0>0?1:0:-1,i=Cd(n[5],(function(e){return function(e,t){var r,n,a,i,o,s,c,l,u,h,d,f,p,g,m,v,y=Ed(e),b=_d(y[1][0].data)>>>0,T=_d(y[2][0].data)>>>0,w=(null==(n=null==(r=y[8])?void 0:r[0])?void 0:n.data)&&_d(y[8][0].data)>0||!1;if((null==(i=null==(a=y[7])?void 0:a[0])?void 0:i.data)&&0!=t)m=null==(s=null==(o=y[7])?void 0:o[0])?void 0:s.data,v=null==(l=null==(c=y[6])?void 0:c[0])?void 0:l.data;else{if(!(null==(h=null==(u=y[4])?void 0:u[0])?void 0:h.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(f=null==(d=y[4])?void 0:d[0])?void 0:f.data,v=null==(g=null==(p=y[3])?void 0:p[0])?void 0:g.data}for(var _=w?4:1,E=vd(m),C=[],k=0;k<m.length/2;++k){var S=E.getUint16(2*k,!0);S<65535&&C.push([k,S])}if(C.length!=T)throw"Expected ".concat(T," cells, found ").concat(C.length);var A=[];for(k=0;k<C.length-1;++k)A[C[k][0]]=v.subarray(C[k][1]*_,C[k+1][1]*_);return C.length>=1&&(A[C[C.length-1][0]]=v.subarray(C[C.length-1][1]*_)),{R:b,cells:A}}(e,a)}));return{nrows:_d(n[4][0].data)>>>0,data:i.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r})),e}),[])}}function Pd(e,t){var r={"!ref":"A1"},n=e[Od(Ed(t.data)[2][0].data)],a=_d(n[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,r){var n,a=Ed(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(_d(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(_d(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Jo(i);var o=Ed(a[4][0].data),s=Nd(e,e[Od(o[4][0].data)][0]),c=(null==(n=o[17])?void 0:n[0])?Nd(e,e[Od(o[17][0].data)][0]):[],l=Ed(o[3][0].data),u=0;l[1].forEach((function(t){var n=Ed(t.data),a=e[Od(n[2][0].data)][0],i=_d(a.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var o=xd(0,a);o.data.forEach((function(e,t){e.forEach((function(e,n){var a=$o({r:u+t,c:n}),i=Rd(e,s,c);i&&(r[a]=i)}))})),u+=o.nrows}))}(e,n[0],r),r}function Md(e,t){var r={SheetNames:[],Sheets:{}};if(Cd(Ed(t.data)[1],Od).forEach((function(t){e[t].forEach((function(t){if(2==_d(t.meta[1][0].data)){var n=function(e,t){var r,n=Ed(t.data),a={name:(null==(r=n[1])?void 0:r[0])?yd(n[1][0].data):"",sheets:[]};return Cd(n[2],Od).forEach((function(t){e[t].forEach((function(t){6e3==_d(t.meta[1][0].data)&&a.sheets.push(Pd(e,t))}))})),a}(e,t);n.sheets.forEach((function(e,t){tf(r,e,0==t?n.name:n.name+"_"+t,!0)}))}}))})),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function Ld(e){var t,r,n,a,i={},o=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=Ad(e.content)}catch(n){return console.log("?? "+e.content.length+" "+(n.message||n))}try{r=kd(t)}catch(n){return console.log("## "+(n.message||n))}r.forEach((function(e){i[e.id]=e.messages,o.push(e.id)}))}})),!o.length)throw new Error("File has no messages");var s=(null==(a=null==(n=null==(r=null==(t=null==i?void 0:i[1])?void 0:t[0])?void 0:r.meta)?void 0:n[1])?void 0:a[0].data)&&1==_d(i[1][0].meta[1][0].data)&&i[1][0];if(s||o.forEach((function(e){i[e].forEach((function(e){if(1==_d(e.meta[1][0].data)>>>0){if(s)throw new Error("Document has multiple roots");s=e}}))})),!s)throw new Error("Cannot find Document root");return Md(i,s)}function Dd(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function Fd(e){Dd([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ud(e,t,r,n,a,i,o,s,c,l,u,h){try{i[n]=Ds(fi(e,r,!0),t);var d,f=di(e,t);switch(s){case"sheet":d=Sh(f,t,a,c,i[n],l,u,h);break;case"chart":if(!(d=Ah(f,t,a,c,i[n],l))||!d["!drawel"])break;var p=yi(d["!drawel"].Target,t),g=Ls(p),m=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(fi(e,p,!0),Ds(fi(e,g,!0),p)),v=yi(m,p),y=Ls(v);d=fh(fi(e,v,!0),0,0,Ds(fi(e,y,!0),v),0,d);break;case"macro":T=t,i[n],T.slice(-4),d={"!type":"macro"};break;case"dialog":d=function(e,t,r,n,a,i,o,s){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,i[n]);break;default:throw new Error("Unrecognized sheet type "+s)}o[n]=d;var b=[];i&&i[n]&&za(i[n]).forEach((function(r){var a="";if(i[n][r].Type==Ms.CMNT){a=yi(i[n][r].Target,t);var o=Oh(di(e,a,!0),a,c);if(!o||!o.length)return;Jl(d,o,!1)}i[n][r].Type==Ms.TCMNT&&(a=yi(i[n][r].Target,t),b=b.concat(function(e,t){var r=[],n=!1,a={},i=0;return e.replace(_i,(function(o,s){var c=ki(o);switch(Si(c[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=a.t&&r.push(a);break;case"<text>":case"<text":i=s+o.length;break;case"</text>":a.t=e.slice(i,s).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o})),r}(di(e,a,!0),c)))})),b&&b.length&&Jl(d,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}var T}function Hd(e){return"/"==e.charAt(0)?e.slice(1):e}function Bd(e,t){if(Da(),Fd(t=t||{}),ui(e,"META-INF/manifest.xml"))return gd(e,t);if(ui(e,"objectdata.xml"))return gd(e,t);if(ui(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return Ld(e);var r=Ba.utils.cfb_new();return gi(e).forEach((function(t){mi(r,t,pi(e,t))})),Ld(r)}if(!ui(e,"[Content_Types].xml")){if(ui(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(ui(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,a,i=gi(e),o=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(_i)||[]).forEach((function(e){var n=ki(e);switch(n[0].replace(Ei,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[Ps[n.ContentType]]&&t[Ps[n.ContentType]].push(n.PartName)}})),t.xmlns!==Xi.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(fi(e,"[Content_Types].xml")),s=!1;if(0===o.workbooks.length&&di(e,a="xl/workbook.xml",!0)&&o.workbooks.push(a),0===o.workbooks.length){if(!di(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");o.workbooks.push(a),s=!0}"bin"==o.workbooks[0].slice(-3)&&(s=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(Gu=[],o.sst)try{Gu=Rh(di(e,Hd(o.sst)),o.sst,t)}catch(O){if(t.WTF)throw O}t.cellStyles&&o.themes.length&&(c=function(e,t,r){return Wl(e,r)}(fi(e,o.themes[0].replace(/^\//,""),!0)||"",o.themes[0],t)),o.style&&(l=Ih(di(e,Hd(o.style)),o.style,c,t))}o.links.map((function(r){try{Ds(fi(e,Ls(Hd(r))),r);return xh(di(e,Hd(r)),0,r,t)}catch(O){}}));var u=kh(di(e,Hd(o.workbooks[0])),o.workbooks[0],t),h={},d="";o.coreprops.length&&((d=di(e,Hd(o.coreprops[0]),!0))&&(h=Bs(d)),0!==o.extprops.length&&(d=di(e,Hd(o.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=Hi(e),js.forEach((function(r){var a=(e.match(ji(r[0]))||[])[1];switch(r[2]){case"string":a&&(t[r[1]]=Ri(a));break;case"bool":t[r[1]]="true"===a;break;case"raw":var i=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));i&&i.length>0&&(n[r[1]]=i[1])}})),n.HeadingPairs&&n.TitlesOfParts&&zs(n.HeadingPairs,n.TitlesOfParts,t,r)}(d,h,t));var f={};t.bookSheets&&!t.bookProps||0!==o.custprops.length&&(d=fi(e,Hd(o.custprops[0]),!0))&&(f=function(e,t){var r={},n="",a=e.match(qs);if(a)for(var i=0;i!=a.length;++i){var o=a[i],s=ki(o);switch(s[0]){case"<?xml":case"<Properties":break;case"<property":n=Ri(s.name);break;case"</property>":n=null;break;default:if(0===o.indexOf("<vt:")){var c=o.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=Ri(u);break;case"bool":r[n]=Mi(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=ei(u);break;default:if("/"==l.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",o,l,c)}}else if("</"===o.slice(0,2));else if(t.WTF)throw new Error(o)}}return r}(d,t));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?n=u.Sheets.map((function(e){return e.name})):h.Worksheets&&h.SheetNames.length>0&&(n=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=f),t.bookSheets&&"undefined"!==typeof n&&(p.SheetNames=n),t.bookSheets?p.SheetNames:t.bookProps))return p;n={};var g={};t.bookDeps&&o.calcchain&&(g=Nh(di(e,Hd(o.calcchain)),o.calcchain));var m,v,y=0,b={},T=u.Sheets;h.Worksheets=T.length,h.SheetNames=[];for(var w=0;w!=T.length;++w)h.SheetNames[w]=T[w].name;var _=s?"bin":"xml",E=o.workbooks[0].lastIndexOf("/"),C=(o.workbooks[0].slice(0,E+1)+"_rels/"+o.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");ui(e,C)||(C="xl/_rels/workbook."+_+".rels");var k=Ds(fi(e,C,!0),C.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=Ph(di(e,Hd(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=function(e,t){var r=[],n=!1;return e.replace(_i,(function(e){var a=ki(e);switch(Si(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e})),r}(di(e,Hd(o.people[0])),t)),k&&(k=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,Ms.WS.indexOf(r)>-1?"sheet":Ms.CS&&r==Ms.CS?"chart":Ms.DS&&r==Ms.DS?"dialog":Ms.MS&&r==Ms.MS?"macro":r&&r.length?r:"sheet")];var r}))}catch(O){return null}return e&&0!==e.length?e:null}(k,u.Sheets));var S=di(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var A="sheet";if(k&&k[y]?(m="xl/"+k[y][1].replace(/[\/]?xl\//,""),ui(e,m)||(m=k[y][1]),ui(e,m)||(m=C.replace(/_rels\/.*$/,"")+k[y][1]),A=k[y][2]):m=(m="xl/worksheets/sheet"+(y+1-S)+"."+_).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,R=0;R!=t.sheets.length;++R)"number"==typeof t.sheets[R]&&t.sheets[R]==y&&(I=1),"string"==typeof t.sheets[R]&&t.sheets[R].toLowerCase()==h.SheetNames[y].toLowerCase()&&(I=1);if(!I)continue e}}Ud(e,m,v,h.SheetNames[y],y,b,n,A,t,u,c,l)}return p={Directory:o,Workbook:u,Props:h,Custprops:f,Deps:g,Sheets:n,SheetNames:h.SheetNames,Strings:Gu,Styles:l,Themes:c,SSF:ri(ra)},t&&t.bookFiles&&(e.files?(p.keys=i,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach((function(t,r){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[r]})))),t&&t.bookVBA&&(o.vba.length>0?p.vbaraw=di(e,Hd(o.vba[0]),!0):o.defaults&&o.defaults.bin===Zl&&(p.vbaraw=di(e,"xl/vbaProject.bin",!0))),p}function jd(e,t){var r=t||{},n="Workbook",a=Ba.find(e,n);try{if(n="/!DataSpaces/Version",!(a=Ba.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=il(e,4),t.U=il(e,4),t.W=il(e,4)}(a.content),n="/!DataSpaces/DataSpaceMap",!(a=Ba.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(ol(e));return t}(a.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=Ba.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=Ba.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);sl(a.content)}catch(c){}if(n="/EncryptionInfo",!(a=Ba.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function(e){var t=il(e);switch(t.Minor){case 2:return[t.Minor,ul(e)];case 3:return[t.Minor,hl()];case 4:return[t.Minor,dl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(n="/EncryptedPackage",!(a=Ba.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==s[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(s[1],a.content,r.password||"",r);if(2==s[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(s[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function zd(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Dn(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function qd(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Gh(e.slice(r),t);default:break e}return Wc.to_workbook(e,t)}function Kd(e,t,r,n){return n?(r.type="string",Wc.to_workbook(e,r)):Wc.to_workbook(t,r)}function Gd(e,t){Sn();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return Gd(new Uint8Array(e),((r=ri(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var n,a=e,i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Vu={},r.dateNF&&(Vu.dateNF=r.dateNF),r.type||(r.type=Fn&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=Fn?"buffer":"binary",a=function(e){if("undefined"!==typeof ja)return ja.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||Fn||(r.type="array")),"string"==r.type&&(i=!0,r.type="binary",r.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?Bi(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var o=new ArrayBuffer(3),s=new Uint8Array(o);if(s.foo="bar",!s.foo)return(r=ri(r)).type="array",Gd(qn(a),r)}switch((n=zd(a,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return Ba.find(e,"EncryptedPackage")?jd(e,t):Zh(e,t)}(Ba.read(a,r),r);break;case 9:if(n[1]<=8)return Zh(a,r);break;case 60:return Gh(a,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Kc.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Wc.to_workbook(e,t)}}(a,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return Gc.to_workbook(a,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var r=e,n=t||{};return n.type||(n.type=Fn&&Buffer.isBuffer(e)?"buffer":"base64"),Bd(vi(r,n),n)}(a,r):Kd(e,a,r,i);case 239:return 60===n[3]?Gh(a,r):Kd(e,a,r,i);case 255:if(254===n[1])return function(e,t){var r=e;return"base64"==t.type&&(r=Dn(r)),r=Rn.utils.decode(1200,r.slice(2),"str"),t.type="binary",qd(r,t)}(a,r);if(0===n[1]&&2===n[2]&&0===n[3])return Yc.to_workbook(a,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return Yc.to_workbook(a,r);if(0===n[2]&&(8===n[3]||9===n[3]))return Yc.to_workbook(a,r)}break;case 3:case 131:case 139:case 140:return qc.to_workbook(a,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return vl.to_workbook(a,r);break;case 10:case 13:case 32:return function(e,t){var r="",n=zd(e,t);switch(t.type){case"base64":r=Dn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ti(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=Hi(r)),t.type="binary",qd(r,t)}(a,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return zc.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?qc.to_workbook(a,r):Kd(e,a,r,i)}function Vd(e,t,r,n,a,i,o,s){var c=Go(r),l=s.defval,u=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),h=!0,d=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch(m){d.__rowNum__=r}else d.__rowNum__=r;if(!o||e[r])for(var f=t.s.c;f<=t.e.c;++f){var p=o?e[r][f]:e[n[f]+c];if(void 0!==p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[f]){if(null==g)if("e"==p.t&&null===g)d[i[f]]=null;else if(void 0!==l)d[i[f]]=l;else{if(!u||null!==g)continue;d[i[f]]=null}else d[i[f]]=u&&("n"!==p.t||"n"===p.t&&!1!==s.rawNumbers)?g:es(p,g,s);null!=g&&(h=!1)}}else{if(void 0===l)continue;null!=i[f]&&(d[i[f]]=l)}}return{row:d,isempty:h}}function Wd(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,s="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=null!=l.range?l.range:e["!ref"];switch(1===l.header?n=1:"A"===l.header?n=2:Array.isArray(l.header)?n=3:null==l.header&&(n=0),typeof u){case"string":c=Xo(u);break;case"number":(c=Xo(e["!ref"])).s.r=u;break;default:c=u}n>0&&(a=0);var h=Go(c.s.r),d=[],f=[],p=0,g=0,m=Array.isArray(e),v=c.s.r,y=0,b={};m&&!e[v]&&(e[v]=[]);var T=l.skipHidden&&e["!cols"]||[],w=l.skipHidden&&e["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(T[y]||{}).hidden)switch(d[y]=Wo(y),r=m?e[v][y]:e[d[y]+h],n){case 1:i[y]=y-c.s.c;break;case 2:i[y]=d[y];break;case 3:i[y]=l.header[y-c.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),s=o=es(r,null,l),g=b[o]||0){do{s=o+"_"+g++}while(b[s]);b[o]=g,b[s]=1}else b[o]=1;i[y]=s}for(v=c.s.r+a;v<=c.e.r;++v)if(!(w[v]||{}).hidden){var _=Vd(e,c,v,d,n,i,m,l);(!1===_.isempty||(1===n?!1!==l.blankrows:l.blankrows))&&(f[p++]=_.row)}return f.length=p,f}var Yd=/"/g;function $d(e,t,r,n,a,i,o,s){for(var c=!0,l=[],u="",h=Go(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var f=s.dense?(e[r]||[])[d]:e[n[d]+h];if(null==f)u="";else if(null!=f.v){c=!1,u=""+(s.rawNumbers&&"n"==f.t?f.v:es(f,null,s));for(var p=0,g=0;p!==u.length;++p)if((g=u.charCodeAt(p))===a||g===i||34===g||s.forceQuotes){u='"'+u.replace(Yd,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(c=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(Yd,'""')+'"'));l.push(u)}return!1===s.blankrows&&c?null:l.join(o)}function Qd(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=Xo(e["!ref"]),i=void 0!==n.FS?n.FS:",",o=i.charCodeAt(0),s=void 0!==n.RS?n.RS:"\n",c=s.charCodeAt(0),l=new RegExp(("|"==i?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(d[p]||{}).hidden||(h[p]=Wo(p));for(var g=0,m=a.s.r;m<=a.e.r;++m)(f[m]||{}).hidden||null!=(u=$d(e,a,m,h,o,c,i,n))&&(n.strip&&(u=u.replace(l,"")),(u||!1!==n.blankrows)&&r.push((g++?s:"")+u));return delete n.dense,r.join("")}function Jd(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=Qd(e,t);if("undefined"==typeof Rn||"string"==t.type)return r;var n=Rn.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function Xd(e,t,r){var n,a=r||{},i=+!a.skipHeader,o=e||{},s=0,c=0;if(o&&null!=a.origin)if("number"==typeof a.origin)s=a.origin;else{var l="string"==typeof a.origin?Yo(a.origin):a.origin;s=l.r,c=l.c}var u={s:{c:0,r:0},e:{c:c,r:s+t.length-1+i}};if(o["!ref"]){var h=Xo(o["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==s&&(s=h.e.r+1,u.e.r=s+t.length-1+i)}else-1==s&&(s=0,u.e.r=t.length-1+i);var d=a.header||[],f=0;t.forEach((function(e,t){za(e).forEach((function(r){-1==(f=d.indexOf(r))&&(d[f=d.length]=r);var l=e[r],u="z",h="",p=$o({c:c+f,r:s+t+i});n=Zd(o,p),!l||"object"!==typeof l||l instanceof Date?("number"==typeof l?u="n":"boolean"==typeof l?u="b":"string"==typeof l?u="s":l instanceof Date?(u="d",a.cellDates||(u="n",l=Ga(l)),h=a.dateNF||ra[14]):null===l&&a.nullError&&(u="e",l=0),n?(n.t=u,n.v=l,delete n.w,delete n.R,h&&(n.z=h)):o[p]=n={t:u,v:l},h&&(n.z=h)):o[p]=l}))})),u.e.c=Math.max(u.e.c,c+d.length-1);var p=Go(s);if(i)for(f=0;f<d.length;++f)o[Wo(f+c)+p]={t:"s",v:d[f]};return o["!ref"]=Jo(u),o}function Zd(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=Yo(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Zd(e,$o("number"!=typeof t?t:{r:t,c:r||0}))}function ef(){return{SheetNames:[],Sheets:{}}}function tf(e,t,r,n){var a=1;if(!r)for(;a<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+a);++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(r=o+a);++a);}if(_h(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function rf(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var nf={encode_col:Wo,encode_row:Go,encode_cell:$o,encode_range:Jo,decode_col:Vo,decode_row:Ko,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Yo,decode_range:Qo,format_cell:es,sheet_add_aoa:rs,sheet_add_json:Xd,sheet_add_dom:ld,aoa_to_sheet:ns,json_to_sheet:function(e,t){return Xd(null,e,t)},table_to_sheet:ud,table_to_book:function(e,t){return ts(ud(e,t),t)},sheet_to_csv:Qd,sheet_to_txt:Jd,sheet_to_json:Wd,sheet_to_html:cd,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var a,i=Xo(e["!ref"]),o="",s=[],c=[],l=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)s[a]=Wo(a);for(var u=i.s.r;u<=i.e.r;++u)for(o=Go(u),a=i.s.c;a<=i.e.c;++a)if(r=s[a]+o,n="",void 0!==(t=l?(e[u]||[])[a]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}c[c.length]=r+"="+n}return c},sheet_to_row_object_array:Wd,sheet_get_cell:Zd,book_new:ef,book_append_sheet:tf,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:rf,cell_set_internal_link:function(e,t,r){return rf(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var a="string"!=typeof t?t:Xo(t),i="string"==typeof t?t:Jo(t),o=a.s.r;o<=a.e.r;++o)for(var s=a.s.c;s<=a.e.c;++s){var c=Zd(e,o,s);c.t="n",c.F=i,delete c.v,o==a.s.r&&s==a.s.c&&(c.f=r,n&&(c.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};bn.version;function af(){const[e,r]=(0,t.useState)(null),[n,a]=(0,t.useState)(null),[i,o]=(0,t.useState)(null);return(0,Vr.jsxs)("div",{id:"main",className:" pt-9 pb-28 px-5 font-lato mt-7 max-h-full overflow-y-auto  w-full",children:[(0,Vr.jsx)("div",{id:"headTitle",className:"flex items-center justify-between gap-16 flex-wrap",children:(0,Vr.jsxs)("div",{id:"container left",children:[(0,Vr.jsx)("h1",{className:"text-4xl font-semibold mb-5 text-black",children:"Import"}),(0,Vr.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Vr.jsx)(rn,{to:"/",className:"hover:text-[#3C91E6]",children:"Home"}),(0,Vr.jsx)(dn,{id:"icon iconchevronRight",className:""}),(0,Vr.jsx)(rn,{to:"/Import",className:"hover:text-[#3C91E6]",children:"Import"})]})]})}),(0,Vr.jsxs)("form",{id:"form",className:"mt-10",onSubmit:t=>{if(t.preventDefault(),null!==e){const t=Gd(e,{type:"buffer"}),r=t.SheetNames[0],n=t.Sheets[r],a=nf.sheet_to_json(n);o(a.slice(0,10))}},children:[(0,Vr.jsx)("input",{type:"file",className:"form-control",required:!0,onChange:e=>{let t=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"],n=e.target.files[0];if(n)if(console.log(n.type),n&&t.includes(n.type)){a(null);let e=new FileReader;e.readAsArrayBuffer(n),e.onload=e=>{r(e.target.result)}}else a("please select only excel file types"),r(null);else console.log("please select your file")}}),(0,Vr.jsx)("button",{type:"submit",className:"btn btn-success btn-md hover:bg-black mx-10",children:"Upload"}),n&&(0,Vr.jsx)("div",{className:"alert alert-danger ",role:"alert",children:n})]}),(0,Vr.jsx)("div",{id:"view data",children:i?(0,Vr.jsx)("div",{className:"table responsive",children:(0,Vr.jsxs)("table",{className:"table",children:[(0,Vr.jsx)("thead",{children:(0,Vr.jsx)("tr",{children:Object.keys(i[0]).map((e=>(0,Vr.jsx)("th",{children:e},e)))})}),(0,Vr.jsx)("tbody",{children:i.map(((e,t)=>(0,Vr.jsx)("tr",{children:Object.keys(e).map((t=>(0,Vr.jsx)("td",{children:e[t]},t)))},t)))})]})}):(0,Vr.jsx)("div",{children:"No file is Uploaded yet!"})})]})}function of(e){let{msalinstance:r}=e;const[n,a]=(0,t.useState)(!1),[i,o]=(0,t.useState)(),[s,c]=(0,t.useState)(null);return console.log(s),(0,Vr.jsxs)("div",{className:"flex h-screen ",children:[(0,Vr.jsx)("div",{className:"".concat(n?"w-[280px] h-screen transition-transform duration-200 overflow-hidden":"w-0 hidden h-screen transition-transform duration-200"),children:i&&(0,Vr.jsx)(hn,{openMenu:n,user:i})}),(0,Vr.jsx)(Yr,{setOpenMenu:a,openMenu:n,msalinstance:r,setUser:o,userAzure:s,setUserAzure:c,user:i}),(0,Vr.jsx)("div",{className:"w-[100%] overflow-hidden",children:(0,Vr.jsx)("div",{className:"mt-12",children:(0,Vr.jsxs)(de,{children:[(0,Vr.jsx)(ue,{path:"/",element:(0,Vr.jsx)(mn,{})}),(0,Vr.jsx)(ue,{path:"/import",element:(0,Vr.jsx)(af,{})}),(0,Vr.jsx)(ue,{path:"/progress",element:(0,Vr.jsx)(vn,{})}),(0,Vr.jsx)(ue,{path:"/activity",element:(0,Vr.jsx)(yn,{})}),(0,Vr.jsx)(ue,{path:"/Login",element:(0,Vr.jsx)(Wr,{msalinstance:r})})]})})}),console.log(n)]})}var sf=r(2838),cf=r(4777);const lf={initialize:()=>Promise.reject((0,sf.Z1)(cf.hJ)),acquireTokenPopup:()=>Promise.reject((0,sf.Z1)(cf.hJ)),acquireTokenRedirect:()=>Promise.reject((0,sf.Z1)(cf.hJ)),acquireTokenSilent:()=>Promise.reject((0,sf.Z1)(cf.hJ)),acquireTokenByCode:()=>Promise.reject((0,sf.Z1)(cf.hJ)),getAllAccounts:()=>[],getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject((0,sf.Z1)(cf.hJ)),loginPopup:()=>Promise.reject((0,sf.Z1)(cf.hJ)),loginRedirect:()=>Promise.reject((0,sf.Z1)(cf.hJ)),logout:()=>Promise.reject((0,sf.Z1)(cf.hJ)),logoutRedirect:()=>Promise.reject((0,sf.Z1)(cf.hJ)),logoutPopup:()=>Promise.reject((0,sf.Z1)(cf.hJ)),ssoSilent:()=>Promise.reject((0,sf.Z1)(cf.hJ)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw(0,sf.Z1)(cf.hJ)},getLogger:()=>{throw(0,sf.Z1)(cf.hJ)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw(0,sf.Z1)(cf.hJ)},hydrateCache:()=>Promise.reject((0,sf.Z1)(cf.hJ)),clearCache:()=>Promise.reject((0,sf.Z1)(cf.hJ))};var uf=r(4190),hf=r(9684);const df={instance:lf,inProgress:uf.$H.None,accounts:[],logger:new hf.Y({})},ff=t.createContext(df);ff.Consumer;var pf=r(3057);class gf{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case pf.t.LOGIN_START:return uf.$H.Login;case pf.t.SSO_SILENT_START:return uf.$H.SsoSilent;case pf.t.ACQUIRE_TOKEN_START:if(e.interactionType===uf.s_.Redirect||e.interactionType===uf.s_.Popup)return uf.$H.AcquireToken;break;case pf.t.HANDLE_REDIRECT_START:return uf.$H.HandleRedirect;case pf.t.LOGOUT_START:return uf.$H.Logout;case pf.t.SSO_SILENT_SUCCESS:case pf.t.SSO_SILENT_FAILURE:if(t&&t!==uf.$H.SsoSilent)break;return uf.$H.None;case pf.t.LOGOUT_END:if(t&&t!==uf.$H.Logout)break;return uf.$H.None;case pf.t.HANDLE_REDIRECT_END:if(t&&t!==uf.$H.HandleRedirect)break;return uf.$H.None;case pf.t.LOGIN_SUCCESS:case pf.t.LOGIN_FAILURE:case pf.t.ACQUIRE_TOKEN_SUCCESS:case pf.t.ACQUIRE_TOKEN_FAILURE:case pf.t.RESTORE_FROM_BFCACHE:if(e.interactionType===uf.s_.Redirect||e.interactionType===uf.s_.Popup){if(t&&t!==uf.$H.Login&&t!==uf.$H.AcquireToken)break;return uf.$H.None}}return null}}function mf(e,t){if(e.length!==t.length)return!1;const r=[...t];return e.every((e=>{const t=r.shift();return!(!e||!t)&&(e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username)}))}const vf="2.0.7",yf="UNBLOCK_INPROGRESS",bf="EVENT",Tf=(e,t)=>{const{type:r,payload:n}=t;let a=e.inProgress;switch(r){case yf:e.inProgress===uf.$H.Startup&&(a=uf.$H.None,n.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case bf:const t=n.message,i=gf.getInteractionStatusFromEvent(t,e.inProgress);i&&(n.logger.info("MsalProvider - ".concat(t.eventType," results in setting inProgress from ").concat(e.inProgress," to ").concat(i)),a=i);break;default:throw new Error("Unknown action type: ".concat(r))}const i=n.instance.getAllAccounts();return a===e.inProgress||mf(i,e.accounts)?a!==e.inProgress?{...e,inProgress:a}:mf(i,e.accounts)?e:{...e,accounts:i}:{...e,inProgress:a,accounts:i}};function wf(e){let{instance:r,children:n}=e;(0,t.useEffect)((()=>{r.initializeWrapperLibrary(uf.lA.React,vf)}),[r]);const a=(0,t.useMemo)((()=>r.getLogger().clone("@azure/msal-react",vf)),[r]),[i,o]=(0,t.useReducer)(Tf,void 0,(()=>({inProgress:uf.$H.Startup,accounts:r.getAllAccounts()})));(0,t.useEffect)((()=>{const e=r.addEventCallback((e=>{o({payload:{instance:r,logger:a,message:e},type:bf})}));return a.verbose("MsalProvider - Registered event callback with id: ".concat(e)),r.initialize().then((()=>{r.handleRedirectPromise().catch((()=>{})).finally((()=>{o({payload:{instance:r,logger:a},type:yf})}))})).catch((()=>{})),()=>{e&&(a.verbose("MsalProvider - Removing event callback ".concat(e)),r.removeEventCallback(e))}}),[r,a]);const s={instance:r,inProgress:i.inProgress,accounts:i.accounts,logger:a};return t.createElement(ff.Provider,{value:s},n)}var _f=r(670),Ef=r(9037);class Cf{constructor(e){this.browserEnvironment="undefined"!==typeof window,this.config=(0,_f._7)(e,this.browserEnvironment),this.logger=new hf.Y(this.config.system.loggerOptions,Ef.u,Ef.i),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class kf extends Cf{getModuleName(){return kf.MODULE_NAME}getId(){return kf.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}kf.MODULE_NAME="",kf.ID="StandardOperatingContext";var Sf=r(828);class Af{static async createPublicClientApplication(e){const t=await async function(e){const t=new kf(e);await t.initialize();const n=await Promise.resolve().then(r.bind(r,828));return await n.StandardController.createController(t)}(e);return new Af(e,t)}constructor(e,t){if(t)this.controller=t;else{const t=new kf(e);this.controller=new Sf.StandardController(t)}}async initialize(){return this.controller.initialize()}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e){return this.controller.addEventCallback(e)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const If=new Af({auth:{clientId:"6a3fcc61-4be4-485a-b042-cf7e6885d8ae",authority:"https://login.microsoftonline.com/stamaria.sti.edu.ph"},cache:{cacheLocation:"sessionStorage"}});a.createRoot(document.getElementById("root")).render((0,Vr.jsx)(wf,{instance:If,children:(0,Vr.jsx)(t.StrictMode,{children:(0,Vr.jsx)(Zr,{children:(0,Vr.jsx)(de,{children:(0,Vr.jsx)(ue,{path:"/*",element:(0,Vr.jsx)(of,{msalinstance:If})})})})})}))})()})();
//# sourceMappingURL=main.7b25f629.js.map